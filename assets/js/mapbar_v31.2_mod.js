/*
 * Mapbar Maplet Engine (C)2005 Mapbar Inc
 * 
 * API Source V31.2 Comment by YJL
 * Just For Some Developers To Read It!
 * 
 * \u76ee\u524d\u5177\u670914\u4e2a\u7f29\u653e\u7ea7\u522b
 */
var apiType=1;if(typeof strImgsvrUrl=="undefined"){strImgsvrUrl="http://img.mapbar.com/maplite/"}if(typeof strMapsvrUrl=="undefined"){strMapsvrUrl="http://api.mapbar.com/api/"}CTLIMG_RESOURCE=[{url:strImgsvrUrl+"images/mapbar31.2.1.png",w:210,h:235}];var transparencyLevel=60;var DirectionInfo="";var strLicenseKey="8890";var strRemoteIP="www.mapbar.com";if(typeof iToolTipStyle=="undefined"){var iToolTipStyle=1}var mapwidth=600;var mapheight=400;var MapBackgroundColor="#EBEAE8";var arrayCity=new Array();arrayCity["\u5168\u56fd"]="GGFVJRWUUEARAF";arrayCity["\u5317\u4eac\u5e02"]="HEUIDVWVVHUEEU";arrayCity["\u5929\u6d25\u5e02"]="HHDVGAWVVJDBGD";arrayCity["\u5858\u6cbd"]="HICCRIXVWBRBGC";arrayCity["\u5927\u6e2f\u533a"]="HIAVWDXVVHCUFA";arrayCity["\u4e0a\u6d77\u5e02"]="IJUAFCXVIWCHCU";arrayCity["\u91cd\u5e86\u5e02"]="HFRASSXTWJRFBR";arrayCity["\u5e7f\u4e1c\u7701"]="IJRCEHVUABJGJR";arrayCity["\u5e7f\u5dde\u5e02"]="IJRCEHVUABJGJR";arrayCity["\u6e05\u8fdc\u5e02"]="IIGFGJVUARHGUG";arrayCity["\u4f5b\u5c71\u5e02"]="IJJCRUXTWSGVBJ";arrayCity["\u6df1\u5733\u5e02"]="ISUGRJVUAIIDFU";arrayCity["\u6e5b\u6c5f\u5e02"]="IIEBEDVTITUFUE";arrayCity["\u8087\u5e86\u5e02"]="IIIIHHWTVUETJI";arrayCity["\u4e2d\u5c71\u5e02"]="IRTCBCXTWFUSGT";arrayCity["\u4e1c\u839e\u5e02"]="IRIJBUVUASTDUI";arrayCity["\u97f6\u5173\u5e02"]="IHJVJIWUDDDSTJ";arrayCity["\u6c55\u5934\u5e02"]="IVIHBWXUFSBTWI";arrayCity["\u987a\u5fb7\u5e02"]="IRCGSHXTWRHISC";arrayCity["\u73e0\u6d77\u5e02"]="ISHEIFXTWDEUFH";arrayCity["\u63ed\u9633\u5e02"]="IUSVUWXUFHRSUS";arrayCity["\u4ece\u5316\u5e02"]="IJIIIDVUBEBAJI";arrayCity["\u6f6e\u5dde\u5e02"]="IUWTBHXUGBCDUW";arrayCity["\u60e0\u5dde\u5e02"]="ISHTBAVUBTSBEH";arrayCity["\u6c5f\u95e8\u5e02"]="IREBCSXTWBEAWE";arrayCity["\u8302\u540d\u5e02"]="IIEEBSXTRDWRDE";arrayCity["\u6885\u5dde\u5e02"]="ITDHSFVUGDGISD";arrayCity["\u6cb3\u6e90\u5e02"]="IRVJACXUDDIWRV";arrayCity["\u6c55\u5c3e\u5e02"]="IUGGGAXUCTDWCG";arrayCity["\u9633\u6c5f\u5e02"]="IJJVUVWTTDFTVJ";arrayCity["\u4e91\u6d6e\u5e02"]="IIBSIBWTUVVGBB";arrayCity["\u6c88\u9633\u5e02"]="HTSCARXWTBGETS";arrayCity["\u961c\u65b0\u5e02"]="HJRHTCXWJSHWVR";arrayCity["\u76d8\u9526\u5e02"]="HSFTUDXWJBBHUF";arrayCity["\u629a\u987a\u5e02"]="HUCSRCXWTSTTTC";arrayCity["\u8425\u53e3\u5e02"]="HTJFIWXWIIVJHJ";arrayCity["\u5927\u8fde\u5e02"]="HVESCTXWEVHRRE";arrayCity["\u846b\u82a6\u5c9b\u5e02"]="HRFWSJXWGITHJF";arrayCity["\u978d\u5c71\u5e02"]="HUASWDXWRHBRUA";arrayCity["\u4e39\u4e1c\u5e02"]="IARWBGXWRWGTRR";arrayCity["\u5357\u4eac\u5e02"]="IEHIJFWVGDBVSH";arrayCity["\u5f90\u5dde\u5e02"]="HVRIUEWVHBRHCR";arrayCity["\u8fde\u4e91\u6e2f\u5e02"]="IBCJDAWVRJVHEC";arrayCity["\u6dee\u9634\u5e02"]="ICHUDGWVIURHGH";arrayCity["\u76d0\u57ce\u5e02"]="IEIBCFXVRDWJBI";arrayCity["\u626c\u5dde\u5e02"]="IEWESGXVHRSJGW";arrayCity["\u6cf0\u5dde\u5e02"]="IFIFEVWVIIUDVI";arrayCity["\u9547\u6c5f\u5e02"]="IFDWSVXVHGGAID";arrayCity["\u5357\u901a\u5e02"]="IHSDGJWVJEAFHS";arrayCity["\u5e38\u5dde\u5e02"]="IGRSWHXVHIHHBR";arrayCity["\u65e0\u9521\u5e02"]="IHIEEWXVHSTJBI";arrayCity["\u82cf\u5dde\u5e02"]="IIFVFGWVHTJBEF";arrayCity["\u6dee\u5b89\u5e02"]="ICHVTTWVIVFJAH";arrayCity["\u5bbf\u8fc1\u5e02"]="IAUEAGWVIFASVU";arrayCity["\u6c5f\u9634\u5e02"]="IGWERFXVIDIHWW";arrayCity["\u5b9c\u5174\u5e02"]="Data Out Of Range";arrayCity["\u6b66\u6c49\u5e02"]="HWUGBAXUUAIWIU";arrayCity["\u8346\u95e8\u5e02"]="HSWWASXURJETSW";arrayCity["\u8346\u5dde\u5e02"]="HUBWHHXUJIHSUB";arrayCity["\u5341\u5830\u5e02"]="HHFTBSXURTGGWF";arrayCity["\u968f\u5dde\u5e02"]="HTSFJSXUUGCVWS";arrayCity["\u8944\u6a0a\u5e02"]="HRFEDWXUTBDJSF";arrayCity["\u5b9c\u660c\u5e02"]="HSCBIAVUISGJIC";arrayCity["\u5b5d\u611f\u5e02"]="HVSVTSWUUAHRHS";arrayCity["\u6210\u90fd\u5e02"]="HACUWTXTUJEGAC";arrayCity["\u6cf8\u5dde\u5e02"]="HEWASJXTTWJSSW";arrayCity["\u8fbe\u5dde\u5e02"]="HEICTRXUDJWFEI";arrayCity["\u5e7f\u5b89\u5e02"]="HEFTDCVUBDGJRF";arrayCity["\u5e7f\u5143\u5e02"]="HABUIBXUCWGSSB";arrayCity["\u4e50\u5c71\u5e02"]="HBFGTIXTSGWFCF";arrayCity["\u5185\u6c5f\u5e02"]="HDEJBBXTUGWRSE";arrayCity["\u6500\u679d\u82b1\u5e02"]="HCRHCWXTDSASTR";arrayCity["\u9042\u5b81\u5e02"]="HCJJUFXTWRIGCJ";arrayCity["\u5b9c\u5bbe\u5e02"]="HDTRTSXTSIWBVT";arrayCity["\u81ea\u8d21\u5e02"]="HDCDSUVTTRIJAC";arrayCity["\u897f\u5b89\u5e02"]="HBWSJFXURIEREW";arrayCity["\u54b8\u9633\u5e02"]="HBIIBFWUREFVCI";arrayCity["\u77f3\u5bb6\u5e84\u5e02"]="HESUBVWVITTHSS";arrayCity["\u5510\u5c71\u5e02"]="HHWAWWXWATUCTW";arrayCity["\u79e6\u7687\u5c9b\u5e02"]="HJJVGFXWDGIEGJ";arrayCity["\u627f\u5fb7\u5e02"]="HFHJHWXWCHACRH";arrayCity["\u5eca\u574a\u5e02"]="HFTVWAXVVFSCHT";arrayCity["\u5f20\u5bb6\u53e3\u5e02"]="HBBTDBWVUISAGB";arrayCity["\u4fdd\u5b9a\u5e02"]="HEWGEJXVSICHVW";arrayCity["\u90a2\u53f0\u5e02"]="HGDDSHWVHDJBVD";arrayCity["\u90af\u90f8\u5e02"]="HGVCGVWVGIBRDV";arrayCity["\u6ca7\u5dde\u5e02"]="HHVAAFWVTTRDTV";arrayCity["\u592a\u539f\u5e02"]="HCAFICWVFITUBA";arrayCity["\u957f\u6cbb\u5e02"]="HFGISAWVDTTJHG";arrayCity["\u5927\u540c\u5e02"]="GWSVEUXVRAJVRS";arrayCity["\u664b\u57ce\u5e02"]="HGBDAUWVCFJIAB";arrayCity["\u664b\u4e2d\u5e02"]="HCIWDTXVFIGDHI";arrayCity["\u4e34\u6c7e\u5e02"]="HDCJHGWVBDIBBC";arrayCity["\u5415\u6881\u5730\u533a"]="HAGDSSXVCUGWAG";arrayCity["\u6714\u5dde\u5e02"]="GWJHIEXVHJBJFJ";arrayCity["\u5ffb\u5dde\u5e02"]="HBHFJSWVGJVDTH";arrayCity["\u9633\u6cc9\u5e02"]="HDIVBIXVHAUWWI";arrayCity["\u8fd0\u57ce\u5e02"]="HDWEIIXUVUARJW";arrayCity["\u90d1\u5dde\u5e02"]="HIGSCCWVCHAHFG";arrayCity["\u6d1b\u9633\u5e02"]="HGRDWVXVAFWVUR";arrayCity["\u5e73\u9876\u5c71\u5e02"]="HJHARHWVAFTSRH";arrayCity["\u8bb8\u660c\u5e02"]="HJTUEIWVBJITUT";arrayCity["\u5357\u9633\u5e02"]="HJGEVGXUVAWHWG";arrayCity["\u9a7b\u9a6c\u5e97\u5e02"]="HSSISAWVAEVVBS";arrayCity["\u5468\u53e3\u5e02"]="HSRTHWXVCDTSRR";arrayCity["\u5546\u4e18\u5e02"]="HSWBAEXVEWSCSW";arrayCity["\u5f00\u5c01\u5e02"]="HJGVEGXVDIWGWG";arrayCity["\u65b0\u4e61\u5e02"]="HHWEWDXVDJSICW";arrayCity["\u4e09\u95e8\u5ce1\u5e02"]="HERHERWUVSTUFR";arrayCity["\u6fee\u9633\u5e02"]="HJADAVWVGATIHA";arrayCity["\u4fe1\u9633\u5e02"]="HUBFDBXUWBFVVB";arrayCity["\u9e64\u58c1\u5e02"]="HHGUUJWVFADAEG";arrayCity["\u5b89\u9633\u5e02"]="HHHDVVXVFIVEWH";arrayCity["\u7126\u4f5c\u5e02"]="HHBCJJXVCIHWIB";arrayCity["\u6f2f\u6cb3\u5e02"]="HRUCUFWVBDVRAU";arrayCity["\u957f\u6625\u5e02"]="HTESJCVBACCRUUE";arrayCity["\u5409\u6797\u5e02"]="HVCVBJWBAEBVVRC";arrayCity["\u54c8\u5c14\u6ee8\u5e02"]="HSHWUDXBAHARIGH";arrayCity["\u9f50\u9f50\u54c8\u5c14\u5e02"]="HEWGJRXBAFGFFHW";arrayCity["\u5927\u5e86\u5e02"]="HHSSFDVBAFUUUGS";arrayCity["\u4e94\u5927\u8fde\u6c60\u5e02"]="HGERCVWBARSCISE";arrayCity["\u7261\u4e39\u6c5f\u5e02"]="IBTVJCXBAJTWCBT";arrayCity["\u547c\u548c\u6d69\u7279\u5e02"]="GTCIEDWVIRJSIC";arrayCity["\u9521\u6797\u90ed\u52d2"]="GVBWHFXWECWVCB";arrayCity["\u6d4e\u5357\u5e02"]="HRRRBTWVRIHDUR";arrayCity["\u804a\u57ce\u5e02"]="HJFDFSWVIJVDIF";arrayCity["\u70df\u53f0\u5e02"]="HWWUHDXWCHRJCW";arrayCity["\u5a01\u6d77\u5e02"]="IBCGUJXWDIRTIC";arrayCity["\u9752\u5c9b\u5e02"]="IARACCWVVUDCUR";arrayCity["\u6cf0\u5b89\u5e02"]="HSIVBAXVJWASDI";arrayCity["\u83b1\u829c\u5e02"]="HTFICSXVRTHWCF";arrayCity["\u6d4e\u5b81\u5e02"]="HSVHFHWVHVRAGV";arrayCity["\u83cf\u6cfd\u5e02"]="HRHRJJXVFWWUGH";arrayCity["\u4e34\u6c82\u5e02"]="HWCAADXVRBECVC";arrayCity["\u5fb7\u5dde\u5e02"]="HIEVBTWVRSSVFE";arrayCity["\u6dc4\u535a\u5e02"]="HTAVDJWVTEHVCA";arrayCity["\u6f4d\u574a\u5e02"]="HUTJUUWVUSVICT";arrayCity["\u65e5\u7167\u5e02"]="IAFTHRWVTFJJSF";arrayCity["\u4e1c\u8425\u5e02"]="HSUERIWVVBGCUU";arrayCity["\u6ee8\u5dde\u5e02"]="HSAWCDXVUBRBVA";arrayCity["\u67a3\u5e84\u5e02"]="HVDUUEWVIIUTHD";arrayCity["\u5408\u80a5\u5e02"]="ICGAACWVDIGSDG";arrayCity["\u829c\u6e56\u5e02"]="IEUISRWVEGSBFU";arrayCity["\u9ec4\u5c71\u5e02"]="IHDTICWVBUURUD";arrayCity["\u5b89\u5e86\u5e02"]="IEBDSUWVBDBHEB";arrayCity["\u868c\u57e0\u5e02"]="IAUUAAWVFFCHBU";arrayCity["\u4eb3\u5dde\u5e02"]="HUAIWVXVEFIFUA";arrayCity["\u5de2\u6e56\u5e02"]="IDRTRDWVEBHRVR";arrayCity["\u6c60\u5dde\u5e02"]="IEIGTWXVCAUICI";arrayCity["\u6ec1\u5dde\u5e02"]="IDEJCAWVFUDAJE";arrayCity["\u961c\u9633\u5e02"]="HVJGCUXVCWCGGJ";arrayCity["\u6dee\u5317\u5e02"]="HVHEGJXVFWWCIH";arrayCity["\u516d\u5b89\u5e02"]="IBFVUSXVCDSWTF";arrayCity["\u9a6c\u978d\u5c71\u5e02"]="IEHRWSXVFDABTH";arrayCity["\u5bbf\u5dde\u5e02"]="HWDSDFXVFUGHAD";arrayCity["\u94dc\u9675\u5e02"]="IEJTFVWVCVFJFJ";arrayCity["\u5ba3\u57ce\u5e02"]="IGAAECWVEHBGDA";arrayCity["\u6dee\u5357\u5e02"]="IASFHWXVEDVTES";arrayCity["\u676d\u5dde\u5e02"]="IJDAJAWVFJGCBD";arrayCity["\u7ecd\u5174\u5e02"]="IREBUTXVFTERWE";arrayCity["\u5b81\u6ce2\u5e02"]="ISWIFCXVHBBASW";arrayCity["\u6e56\u5dde\u5e02"]="IIDGEDWVGFJRID";arrayCity["\u5609\u5174\u5e02"]="IJFTGAWVHDDBJF";arrayCity["\u91d1\u534e\u5e02"]="IRDGFTXVCWSAHD";arrayCity["\u4e3d\u6c34\u5e02"]="ISRHIDWVCGJFIR";arrayCity["\u6e29\u5dde\u5e02"]="IUGWBGXVCUHFDG";arrayCity["\u4e50\u6e05\u5e02"]="IUSDHJWVDHSSVS";arrayCity["\u53f0\u5dde\u5e02"]="IUJGDSWVFAFUEJ";arrayCity["\u8862\u5dde\u5e02"]="IJEDARWVBJCGDE";arrayCity["\u798f\u5dde\u5e02"]="IVGDHIXUUTREWG";arrayCity["\u8386\u7530\u5e02"]="IVUGHUWUTGHGGU";arrayCity["\u5357\u5e73\u5e02"]="ISRAGEWUTVCRBR";arrayCity["\u53a6\u95e8\u5e02"]="IVVSDUWUJJTJRV";arrayCity["\u6cc9\u5dde\u5e02"]="IVWVHJXURWGTTW";arrayCity["\u6f33\u5dde\u5e02"]="IVCTCHWUIVUGCC";arrayCity["\u4e09\u660e\u5e02"]="ISHCWSXUSIFFTH";arrayCity["\u9f99\u5ca9\u5e02"]="ITFFFUWUIUVGCF";arrayCity["\u957f\u6c99\u5e02"]="IBGRTCVUHGRSFG";arrayCity["\u5f20\u5bb6\u754c\u5e02"]="HTDSDJVUFATFGT";arrayCity["\u5cb3\u9633\u5e02"]="HWURCEXUJHAEHU";arrayCity["\u682a\u6d32\u5e02"]="ICDADVXUHCBWHD";arrayCity["\u90f4\u5dde\u5e02"]="IFCBUEVUDUGGUC";arrayCity["\u5e38\u5fb7\u5e02"]="HVDAVWXUGSCRID";arrayCity["\u8861\u9633\u5e02"]="ICUVVBXUEUWGEU";arrayCity["\u90b5\u9633\u5e02"]="IAJDWAXUDRJDWJ";arrayCity["\u6e58\u6f6d\u5e02"]="IBUTBWXUGTIBIU";arrayCity["\u76ca\u9633\u5e02"]="HWVBGTXUHAUABV";arrayCity["\u6e58\u897f"]="HTESRDVUCRFHCE";arrayCity["\u5357\u5b81\u5e02"]="ICIFVTWTIBCAUI";arrayCity["\u6842\u6797\u5e02"]="IBTCGEWTVUSVHT";arrayCity["\u767d\u8272\u5e02"]="HVEHATXTHCIWJE";arrayCity["\u5357\u660c\u5e02"]="IFCEUTVUTJJDUC";arrayCity["\u8d35\u9633\u5e02"]="HRFBHUVTSGBFIF";arrayCity["\u6606\u660e\u5e02"]="HGIVRBXTCWBDGI";arrayCity["\u7389\u6eaa\u5e02"]="HHFUSFXTBJWHGF";arrayCity["\u695a\u96c4\u5e02"]="HEGDTDUTBSTCCG";arrayCity["\u5fb7\u5b8f"]="HAECBGXSSEAWDE";arrayCity["\u8fea\u5e86"]="GTWSURXTCJAJSW";arrayCity["\u4e2a\u65e7\u5e02"]="HJECWRXTBDUCFE";arrayCity["\u4e34\u6ca7\u5e02"]="HDFFEHUSTSDDIF";arrayCity["\u6012\u6c5f\u5e02"]="GUTHDTWTAATVUT";arrayCity["\u66f2\u9756\u5e02"]="HHGUGEVTFUBJHG";arrayCity["\u601d\u8305\u5e02"]="HGAEUCVSUHFHUA";arrayCity["\u62c9\u8428\u5e02"]="FUUVCJWSIEVARU";arrayCity["\u6d77\u53e3\u5e02"]="IJTRTWXTGUUSRT";arrayCity["\u4e09\u4e9a\u5e02"]="ISECARWTCVVADE";arrayCity["\u743c\u6d77\u5e02"]="ISDJDGWTFVIASD";arrayCity["\u5170\u5dde\u5e02"]="GHFHGUWUFFUUVF";arrayCity["\u94f6\u5ddd\u5e02"]="GHIEETXUTURWFI";arrayCity["\u897f\u5b81\u5e02"]="GDIATWXUDCTBAI";arrayCity["\u4e4c\u9c81\u6728\u9f50\u5e02"]="ECTRRTUTIIAJHT";arrayCity["\u9999\u6e2f"]="ITDUDHWUADIVID";arrayCity["\u6fb3\u95e8"]="ISGWHUXTWBWWTG";arrayCity["\u53f0\u6e7e"]="JESFTTXUTRWJWS";arrayCity["\u9e64\u5c97\u5e02"]="HVREATXBAVVGWHR";arrayCity["\u5305\u5934\u5e02"]="GJJSCSZVFRAIAJ";arrayCity["\u8861\u6c34\u5e02"]="HGWVHSZVRBHDVW";arrayCity["\u6986\u6797\u5e02"]="GUBBADZVBUWWAB";arrayCity["\u901a\u8fbd\u5e02"]="HIAJGGXWUBWRCA";arrayCity["\u8d64\u5cf0\u5e02"]="HFAGBIXWGAFHIA";arrayCity["\u547c\u4f26\u8d1d\u5c14"]="GSRDHWXBABUCHHR";arrayCity["\u5174\u5b89\u76df"]="HDWGITXBAAIVARW";arrayCity["\u5b81\u5fb7\u5e02"]="IUSTGRXUWBCGAS";function getPid(b){if(typeof arrayCity[b]=="undefined"){return b}return arrayCity[b]}var topColor="#FFFFFF";var subColor="#FFFFFF";var xoffset=0;var yoffset=0;var sN=function(){this.clear=function(){};this.paint=function(){};this.lB=function(){};this.lE=function(){};this.setColor=function(){}};var jsGraphics=function(a){};var $=function(a){if(document.getElementById(a)!=null){return document.getElementById(a)}return null};var q2=function(a){if(document.getElementById(a)!=null){return document.getElementById(a).style}return null};var qZ=function(b,g,f,d,a,i,c,e){document.writeln('<div unselectable="on" id="'+b+'" style="position:absolute; overflow:none; left:'+g+"px; top:"+f+"px; width:"+d+"px; height:"+a+"px; visibility:"+(i?"visible;":"hidden;")+"z-Index:"+c+';">');document.writeln(e);document.writeln("</div>")};var buildDivObj=function(b,e,g,c,i,d,j,f){var a=document.createElement("div");a.unselectable="on";a.id=b;a.style.position="absolute";a.style.top=parseInt(g)+"px";a.style.left=parseInt(e)+"px";a.style.zIndex=j;a.style.width=c+(c=="auto"?"":"px");a.style.height=i+(i=="auto"?"":"px");a.style.visibility=(d)?"visible":"hidden";a.innerHTML=f;return a};var buildImgObj=function(f,e,d,c,a){var b=new Image();b.unselectable="on";b.style.position="absolute";b.style.top=parseInt(d)+"px";b.style.left=parseInt(e)+"px";b.style.width=parseInt(c)+"px";b.style.height=parseInt(a)+"px";if(f!="undefined"){b.src=f}b.onerror=function(){this.onerror=null;if(this.parentNode){this.parentNode.removeChild(this)}};return b};var gu=function(b,a){var d=document.createElement("div");d.style.position="absolute";d.unselectable="on";var c='<div unselectable="on" id="mbglabel" style="border:1px solid '+a+";left:2px;top:2px;background-color:"+a+";color:"+this.color+';"><table border="1" cellspacing="0" cellpadding="0" bordercolor="'+a+'"><tr><td width="100%"><font class="ptlabel" color="'+a+'">'+b+"</font></td></tr></table></div>";c+='<div unselectable="on" id="mfglabel" style="border:1px solid '+a+";left:0px;top:0px;background-color:#FFFFCC;color:"+this.color+';"><table border="1" cellspacing="0" cellpadding="0" bordercolor=#FFFFCC><tr><td width="100%"><font class="ptlabel" color="'+a+'" title="'+b+'">'+b+"</font></td></tr></table></div>";d.innerHTML=c;return d};var PerformControl=function(b,d,c){var a=d.parentNode.q9;switch(c){case 1:a.panTo(parseInt(a.width)/2,0);break;case 2:a.panTo(0,parseInt(a.height)/2);break;case 3:a.panTo(-parseInt(a.width)/2,0);break;case 4:a.panTo(0,-parseInt(a.height)/2);break;case 5:a.zoomIn();break;case 6:a.zoomOut();break;case 7:a.setMode(mapMode.measure);break;case 8:var f=parseInt(d.style.top)-96+parseInt(a.controlCanvas.top);var e=parseInt((isIE)?event.clientY:b.clientY)-parseInt(a.offsetY)-parseInt(a.top);e-=f;if(!isIE&&a.panel.style.position!="absolute"){}zoomLevel=maxZoomLevel-Math.max(0,Math.min(maxZoomLevel,parseInt((parseInt(e)-100)/MControl.rulerGap)));d.parentNode.update(zoomLevel);a.ed58();a.setZoomLevel(zoomLevel,true,false);break;default:break}};var mouseTipBox=null;var showMouseTipBox=function(f,e,d,c){try{if(mouseTipBox==null||mouseTipBox=="undefined"){if(maplet.mapMode!=mapMode.bookmark){var b='<table style="border:1px solid #0E347F;"><tr><td><font class="ptlabel" color="#D50F1E">'+d+"</font></td></tr></table>";mouseTipBox=buildDivObj("mousetipbox",parseInt(f)+10,parseInt(e)+18,"auto","auto",1,100,b);mouseTipBox.style.backgroundColor="#FFFFFF";mouseTipBox.style.padding="1px"}else{mouseTipBox=buildDivObj("mousetipbox",parseInt(f)+10,parseInt(e)+18,"auto","auto",1,100,d)}mouseTipBox.unselectable="on";mouseTipBox.style.MozUserSelect="none"}else{mouseTipBox.style.left=(parseInt(f)+10)+"px";mouseTipBox.style.top=(parseInt(e)+18)+"px";mouseTipBox.visibility="visible"}if(mouseTipBox!=null&&(mouseTipBox.parentNode==null||mouseTipBox.parentNode!=c)){c.appendChild(mouseTipBox)}}catch(a){}};var removeMouseTipBox=function(){if(mouseTipBox!=null){if(mouseTipBox.parentNode!=null){removeNode(mouseTipBox)}mouseTipBox=null}};var getTargetId=function(a){return(isIE)?event.srcElement.id:a.target.id};var imageTileError=function(a){if(a.width==300&&a.ntry=="0"){a.ntry="1";a.src=a.src+"?"}else{if(a.width==300&&a.ntry=="1"){a.ntry="2";a.src=a.src+"?"}else{a.ntry="3";a.onerror=null;a.src=strImgsvrUrl+"images/mask.gif";a.style.width="300px";a.style.height="300px"}}};var imageTileOk=function(a){a.onerror=null;a.onload=null;a.style.width="300px";a.style.height="300px"};var isTarget=function(c,b){var a=false;while(c!=null){if((typeof b=="string"&&c.id==b)||(c==b)){a=true;break}c=c.parentNode}return a};var pE=function(f,e,d,c,a,b){this.pP=buildImgObj(f,e,d,c,a);this.gd=0;this.ge=0;this.name=name;b.appendChild(this.pP);this.hide=function(){this.pP.style.visibility="hidden"};this.show=function(){this.pP.style.visibility="visible"};this.moveTo=function(g,i){this.pP.style.left=parseInt(g)+"px";this.pP.style.top=parseInt(i)+"px"};this.resize=function(g,i){this.pP.style.width=parseInt(g)+"px";this.pP.style.height=parseInt(i)+"px"};this.getName=function(){return this.name};this.aW=function(g){g.appendChild(this.pP)}};var yq=function(a,b,c){if(b!="undefined"&&b!=""){a.src=b}a.style.zIndex=c};var vB=function(b,c){try{if(document.getElementById(c)!=null&&b!=null){document.getElementById(c).innerHTML=vo(b.responseText)}}catch(a){}};var vo=function(a){return a};var uP=function(c,e,d){var b=document["mapbar-maplet"];var a=((isIE)?event.clientX:c.clientX)-b.offsetX-b.left;var f=((isIE)?event.clientY:c.clientY)-b.offsetY-b.top;b.wN(a,f,e,d)};var lbp2=function(b,a){if(typeof b=="string"&&b!=null&&document.getElementById(b)!=null&&typeof a=="string"&&a!=null){document.getElementById(b).innerHTML+=a}};var lbp=function(i,b,g,c,f,a,d,e){fry4K[i]={x:b,y:g,w:c,wO:f,y6:a,yU:d,b$54s:e};EO5lx(i,b,g,c,f,a,d,e)};var EO5lx=function(i,b,g,c,f,a,d,e){if(typeof i=="string"&&i!=null&&document.getElementById(i)!=null&&typeof f=="string"&&f!=null){if(!e){document.getElementById(i).innerHTML+='<div unselectable="on" class="hotspotlabel" onmouseout="javascript:waitHideTip();" onmouseover="javascript:{var e = arguments[0];setToolTipMenu(e,e,\''+a+"','"+(d)+'\',e)};" style="position:absolute;left:'+b+"px;top:"+g+"px;width:"+c+'px;height:0px">'+f+"</div>"}else{document.getElementById(i).innerHTML+='<div unselectable="on"  style="position:absolute;left:'+b+"px;top:"+g+"px;width:"+c+'px;height:0px">'+f+"</div>"}}};var fry4K={};var _2q=function(b,c,d){var a=c.parentNode.q9;switch(d){case 1:hideBubble(a);a.panTo(parseInt(a.width)/2,0);break;case 2:hideBubble(a);a.panTo(0,parseInt(a.height)/2);break;case 3:hideBubble(a);a.panTo(-parseInt(a.width)/2,0);break;case 4:hideBubble(a);a.panTo(0,-parseInt(a.height)/2);break;case 5:hideBubble(a);a.zoomIn();break;case 6:hideBubble(a);a.zoomOut();break;case 7:hideBubble(a);a.setMode(mapMode.measure);break;case 8:hideBubble(a);var f=parseInt(c.style.top)-96+parseInt(a.controlCanvas.top);var e=parseInt((isIE)?event.clientY:b.clientY)-parseInt(a.offsetY)-parseInt(a.top);e-=f;if(!isIE&&a.panel.style.position!="absolute"){}zoomLevel=maxZoomLevel-Math.max(0,Math.min(maxZoomLevel,parseInt((parseInt(e)-100)/(132/(maxZoomLevel-1)))));c.parentNode.update(zoomLevel);a.setZoomLevel(zoomLevel);break;default:break}};var hideTipTimer=null;var waitHideTip=function(){if(hideTipTimer){clearTimeout(hideTipTimer)}hideTipTimer=null;hideTipTimer=setTimeout("hideToolTipMenu()",2000)};function CreateToolTip(a,e,c){var b='<table id="mytooltip_container" border="0" width="150" cellspacing="0" cellpadding="0"><tr><td width="100%" bgcolor="#FF0000"><table border="0" width="150" cellspacing="1" cellpadding="0"><tr><td width="100%" bgcolor="#FF0000"><table border="0" width="100%" cellspacing="0" cellpadding="0"><tr><td width="100%" bgcolor='+topColor+'><table border="0" width="100%" cellspacing="0" cellpadding="0" align="center"><tr><td id="mytooltiptitle"width="100%" class="tooltiptitle">'+e+'</td><td style="cursor:hand;cursor:pointer;" valign="top" align="right"><img src="'+strImgsvrUrl+'images/xclose.gif" onclick="javascript:hideToolTipMenu();"></td></tr></table></td></tr><tr><td width="100%" bgcolor='+subColor+'><table border="0" width="100%" cellpadding="0" cellspacing="0" align="center"><tr><td id="mytooltipcontent" width="100%" class="tooltipcontent">'+c+"</td></tr></table></td></tr></table></td></tr></table></td></tr></table>";document.getElementById(a).innerHTML=b;var d=document.getElementById(a).childNodes[0];document.getElementById(a).style.width=d.clientWidth;document.getElementById(a).style.height=d.clientHeight}var setToolTipMenu=function(a,i,g,f,d){var c=document["mapbar-maplet"];if(c!=null&&c.width&&c.height){mapwidth=c.width;mapheight=c.height;if(typeof a=="undefined"||typeof d=="object"){a=((isIE)?event.clientX:d.clientX)-c.offsetX-c.left;i=((isIE)?event.clientY:d.clientY)-c.offsetY-c.top}}UpdateContent("ToolTip",g,f);var b=document.getElementById("ToolTip").clientWidth;var e=document.getElementById("ToolTip").clientHeight;if(a>mapwidth-b){a=a-b}if(i>mapheight-e){i=i-e}MoveToolTip("ToolTip",i+yoffset,a+xoffset);document.getElementById("ToolTip").style.visibility="visible"};var hideToolTipMenu=function(){document.getElementById("ToolTip").style.visibility="hidden";var a=document["mapbar-maplet"];if(a.getContextMenu()!=null){a.getContextMenu().hide()}MoveToolTip("ToolTip",0,0)};var MoveToolTip=function(name,top,left){if(isIE){document.getElementById(name).style.top=parseInt(eval(top))+"px"}else{document.getElementById(name).style.top=parseInt(eval(top))+"px"}document.getElementById(name).style.left=parseInt(eval(left))+"px"};var UpdateContent=function(b,e,c){if(initialize==0){CreateToolTip(b,e,c);initialize=1}if(document.getElementById("mytooltiptitle")){document.getElementById("mytooltiptitle").innerHTML=e}if(document.getElementById("mytooltipcontent")){document.getElementById("mytooltipcontent").innerHTML=c}var a=document.getElementById("ToolTip");var d=document.getElementById("mytooltip_container");if(d){a.style.width=d.clientWidth+"px";a.style.height=d.clientHeight+"px"}};var mapMode={zoomin:1,zoomout:2,pan:3,lookup:5,bookmark:6,tx:7,tt:8,lz:9,ly:10,measure:11,np:12,l3:13,tM:14,edit:23,ta:15,snapshot:24};var showLoading=function(){sb++;if(document.getElementById("loading")){document.getElementById("loading").style.display="block";document.getElementById("loading").style.visibility="visible"}};var hideLoading=function(){sb--;if(sb<=0){if(document.getElementById("loading")){document.getElementById("loading").style.display="none";document.getElementById("loading").style.visibility="hidden";if(a&&new Date().getTime()-ac.getTime()>9){document.getElementById("sendmapload").src="http://211.157.24.143:8001/log.jsp?type=map-mapbar&time="+(new Date().getTime()-ac.getTime())+"&"+Math.random();if(typeof a=="undefined"){var a=false}else{a=false}}}}};var setMapLoading2Center=function(a){if(document.getElementById("loading")){document.getElementById("loading").style.left=((a.width-parseInt(document.getElementById("loading").clientWidth))/2)+"px";document.getElementById("loading").style.top=((a.height-parseInt(document.getElementById("loading").clientHeight))/2)+"px"}};var pc=new Array();pc.icon1=strImgsvrUrl+"images/number1.gif";pc.icon2=strImgsvrUrl+"images/number2.gif";pc.icon3=strImgsvrUrl+"images/number3.gif";pc.icon4=strImgsvrUrl+"images/number4.gif";pc.icon5=strImgsvrUrl+"images/number5.gif";pc.icon6=strImgsvrUrl+"images/number6.gif";pc.icon7=strImgsvrUrl+"images/number7.gif";pc.icon8=strImgsvrUrl+"images/number8.gif";pc.icon9=strImgsvrUrl+"images/number9.gif";pc.icon10=strImgsvrUrl+"images/number10.gif";var pb=new Array();pb.icon1=strImgsvrUrl+"images/number1-2.gif";pb.icon2=strImgsvrUrl+"images/number2-2.gif";pb.icon3=strImgsvrUrl+"images/number3-2.gif";pb.icon4=strImgsvrUrl+"images/number4-2.gif";pb.icon5=strImgsvrUrl+"images/number5-2.gif";pb.icon6=strImgsvrUrl+"images/number6-2.gif";pb.icon7=strImgsvrUrl+"images/number7-2.gif";pb.icon8=strImgsvrUrl+"images/number8-2.gif";pb.icon9=strImgsvrUrl+"images/number9-2.gif";pb.icon10=strImgsvrUrl+"images/number10-2.gif";function isArray(a){if(typeof a=="undefined"||!a){return false}return a.constructor.toString().indexOf("Array")!=-1}function getMapLeftTop(c){var b=0,a=0;if(typeof c=="string"&&c){c=document.getElementById(c)}if(typeof c=="object"&&c){do{b+=c.offsetTop||0;a+=c.offsetLeft||0;if(c.offsetParent==document.body){if(c.style.position=="absolute"){break}}c=c.offsetParent}while(c)}return[a,b]}function K_ER(b,a){var c=null;if(typeof b=="string"&&b){b=getElementById(b)}if(typeof b=="object"&&b){do{c=b.getAttribute(a);if(c||b.parentNode==maplet.map){break}b=b.parentNode}while(b)}return c}var setDomAttrVal=function(g,a,f,c){var e=function(k,i,j){if(typeof k.setAttribute!="undefined"){k.setAttribute(i,j)}};var d=function(n,k,l,p){if(typeof n=="object"&&n&&typeof n.childNodes!="undefined"){var j=n.childNodes;for(var m=0;m<j.length;m++){var o=j[m];if(o.childNodes.length>0){d(o,k,l,p)}else{if(typeof o.tagName=="string"&&!p[o.tagName.toLowerCase()]){e(o,k,l)}}}e(n,k,l)}};if(isArray(c)){for(var b=0;b<c.length;b++){c[c[b].toLowerCase()]=1}}else{c=[]}d(g,a,f,c)};var removeDomAttr=function(d,a){var c=function(f,e){if(typeof f.removeAttribute!="undefined"){f.removeAttribute(e)}};var b=function(j,f){if(typeof j=="object"&&j&&typeof j.childNodes!="undefined"){var e=j.childNodes;for(var g=0;g<e.length;g++){var k=e[g];if(k.childNodes.length>0){b(k,f)}else{if(typeof k.tagName=="string"){c(k,f)}}}c(j,f)}};b(d,a)};function _getStyle(b,c,f){var e=null;if(typeof b=="string"&&b){e=document.getElementById(b)}else{e=b}if(typeof e!="object"||!e){return""}if(!c&&!f){return""}if(c&&!f){f=c}if(!c&&f){c=f}var d="";if(e.currentStyle){d=e.currentStyle[c]}else{if(document.defaultView&&document.defaultView.getComputedStyle){var a=document.defaultView.getComputedStyle(e,null);if(isChrome||isSafari){d=a?a.getPropertyValue(c):""}else{d=a?a.getPropertyValue(f):""}}}return d}function filter2Num(a,b){if(isNaN(parseInt(a))){return(typeof b!="number"?0:b)}else{return parseInt(a)}}function _isInsidePolygon(f,e){for(var g=false,d=-1,a=e.length,b=a-1;++d<a;b=d){if(((e[d].y<=f.y&&f.y<e[b].y)||(e[b].y<=f.y&&f.y<e[d].y))&&(f.x<(e[b].x-e[d].x)*(f.y-e[d].y)/(e[b].y-e[d].y)+e[d].x)){g=!g}}return g}function _isInsideRect(b,a){if(a.max.x>b.x&&a.min.x<=b.x&&a.max.y>b.y&&a.min.y<=b.y){return true}return false}function _isRectint(b,a){return Math.abs((b.min.x+b.max.x)/2-(a.min.x+a.max.x)/2)<((b.max.x+a.max.x-b.min.x-a.min.x)/2)&&Math.abs((b.min.y+b.max.y)/2-(a.min.y+a.max.y)/2)<((b.max.y+a.max.y-b.min.y-a.min.y)/2)}function _IsIntersect(e,c){var f=(e.end.y-e.start.y)*(c.end.x-c.start.x)-(c.end.y-c.start.y)*(e.end.x-e.start.x);if(f==0){return false}else{var b=((e.end.x-e.start.x)*(c.end.x-c.start.x)*(c.start.y-e.start.y)+(e.end.y-e.start.y)*(c.end.x-c.start.x)*e.start.x-(c.end.y-c.start.y)*(e.end.x-e.start.x)*c.start.x)/f;var a=((e.end.y-e.start.y)*(c.end.y-c.start.y)*(c.start.x-e.start.x)+(e.end.x-e.start.x)*(c.end.y-c.start.y)*e.start.y-(c.end.x-c.start.x)*(e.end.y-e.start.y)*c.start.y)/(-f);if((b-e.start.x)*(b-e.end.x)<=0&&(b-c.start.x)*(b-c.end.x)<=0&&(a-e.start.y)*(a-e.end.y)<=0&&(a-c.start.y)*(a-c.end.y)<=0){return true}}return false}var I6O1=function(a){if(window.event){return window.event}else{while(a.caller){a=a.caller}if(typeof a.arguments!="undefined"&&a.arguments&&a.arguments.length>0){if(a.arguments[0].constructor.toString().indexOf("Event")){return a.arguments[0]}}}return null};function stopEventBubble(a){if(typeof a=="undefined"){return}if(window.event){window.event.returnValue=false;window.event.cancelBubble=true}else{a.preventDefault();a.stopPropagation()}}function getElementById(a){if(typeof a=="string"){return document.getElementById(a)}else{return null}}function removeNode(f){var e=function(){var a;return function(b){if(b&&b.tagName!="BODY"){a=a||document.createElement("div");a.appendChild(b);a.innerHTML=""}}};var d=function(a){if(a&&a.parentNode&&a.tagName!="BODY"){a.parentNode.removeChild(a)}};var g=e();if(document.all){g(f)}else{d(f)}}filterMLabel=function(a){var b=new RegExp("<.*?>|\r|\n","gi");return function(c){return c.replace(b,"")}}();var foy21=function(a,d,c,b,f,g,e){this.URL=a;this.WS16q=d;this.D6f9E=f;this.uj7u=g;this.aB=e;this.$54Wt=c;this.AKe87=b};foy21.prototype.f7c0=function(){var f=document.getElementById("scriptTemp");if(f){removeNode(f)}var c=document.createElement("script");c.language="javascript";c.type="text/javascript";c.id=(this.AKe87&&this.AKe87==true)?"Temp"+Math.random():"scriptTemp";c.src=(this.$54Wt&&this.$54Wt==true)?this.URL+"?"+Math.random():this.URL;var e=this.WS16q?(this.WS16q):parseInt;var a=this.D6f9E;var b=this.uj7u;var d=typeof this.aB=="undefined"||!this.aB?[]:this.aB;c.onload=c.onreadystatechange=function(){if(typeof ActiveXObject!="undefined"){if(c.readyState=="loaded"||c.readyState=="complete"){if(typeof e=="function"){d.push(c.id);e.apply(a,d)}c.onerror=null;c.onload=null;c.onreadystatechange=null}}else{if(typeof e=="function"){d.push(c.id);e.apply(a,d)}c.onerror=null;c.onload=null;c.onreadystatechange=null}};c.onerror=function(){if(c&&c.parentNode){c.parentNode.removeChild(c)}if(typeof b=="function"){d.push(c.id);b.apply(a,d)}c.onerror=null;c.onload=null;c.onreadystatechange=null};document.body.insertBefore(c,document.body.firstChild)};var getScrollTop=function(){if(document.body){return document.documentElement.scrollTop}else{return document.body.scrollTop}};var getScrollLeft=function(){if(document.body){return document.documentElement.scrollLeft}else{return document.body.scrollLeft}};var setMyAlert=function(a,d,c){document.getElementById("myalert").style.top=(parseInt(d)-60+getScrollTop())+"px";document.getElementById("myalert").style.left=(parseInt(a)-100+getScrollLeft())+"px";var b=(en==1)?"Close":getAscii("%u5175%uE760");document.getElementById("myalert").innerHTML='<table width="196px" border="0" cellpadding="0" cellspacing="0" style="border:2px solid #0E347F;"><tr><td height="100px" align="center" valign="middle" bgcolor="#FFFFFF"><table width="167px" height="79px" border="0" cellpadding="0" cellspacing="0"><tr><td height="55px" align="center" valign="middle" style="font-size: 12px;color: #0065AD;">'+c+'</td></tr><tr><td height="24px" align="center" valign="middle"><input type="button" value="'+b+"\" onClick=\"document.getElementById('myalert').style.visibility = 'hidden'\"onMouseOver=\"style.background='#DEE7EF';style.cursor='hand';style.cursor='pointer'\"onMouseOut=\"this.style.background='FDFAF3'\" style=\"font-size: 9pt; border: 1px solid #4A799C;background-color: #FDFAF3\"></td></tr></table></td></tr></table>";document.getElementById("myalert").style.visibility="visible"};var gP=function(a){if(gQ){setMyAlert(300,100,a)}};var filterHtml=function(a,d){var c=new RegExp("<(?:!(?:--[\\s\\S]*?--\\s*)?(>)\\s*|(?:script|style|SCRIPT|STYLE)[\\s\\S]*?<\\/(?:script|style|SCRIPT|STYLE)>)","gi");var e=new RegExp("[\\r\\n]","gi");if(typeof d!="boolean"){d=false}if(typeof a=="string"&&a){var b=a.replace(c,"");if(d){b=b.replace(e,"")}return b}else{return a}};var f$N=null;var D69D=function(s){var size={w309r:0,Uu_4:0,Vcbeh:0,ch:0};if(typeof s=="string"&&s&&maplet&&maplet.panel){if(!f$N){f$N=document.createElement("DIV");with(f$N.style){position="absolute";left=-Number.MAX_VALUE+"px";top=-Number.MAX_VALUE+"px"}maplet.mapContainer.div.appendChild(f$N)}f$N.innerHTML=s;size.w309r=f$N.offsetWidth;size.Uu_4=f$N.offsetHeight;size.Vcbeh=f$N.clientWidth;size.ch=f$N.clientHeight;f$N.innerHTML=""}return size};var cq={pu:{},Decrypt:function(a){return this.pu[a]||function(n,l){var k;if(l.indexOf(",")==-1){var f=-1;var j=0;var b="";var e="";if(l!=null&&parseInt(l.charAt(0),36)>=33){e=l.charAt(0);l=l.substring(1)}for(var g=0;g<(l.length-(c75?1:0));g++){var d=parseInt(l.charAt(g),36)-10;if(d>=17){d=d-7}b+=(d).toString(36);if(d>j){f=g;j=d}}var c=parseInt(b.substring(0,f),16);var m=parseInt(b.substring(f+1),16);if("X"==e){c=-c}if("Y"==e){m=-m}k=new Array();k[0]=(c+m-parseInt(strLicenseKey))/2;k[1]=(m-k[0])/100000;k[0]/=100000;if(k[0]>180){k[0]-=360}n[l]=k;return k}else{k=f21(l);n[l]=k;return k}}(this.pu,a)},zn:function(o,p,a){if(typeof a!="boolean"){a=false}if(typeof o!="undefined"&&typeof p!="undefined"){this.lf=parseFloat(p);this.li=parseFloat(o)}if(apiType==1&&!a){return q1l(this.li+","+this.lf).join(",")}else{var k="";var n=parseInt(parseFloat(Math.max(-90,Math.min(90,this.lf)))*100000);var l=parseInt(parseFloat((this.li<0)?(this.li+360):this.li)*100000);var c=l-n+parseInt(strLicenseKey);var b=l+n;if(c<0){k="X";c=-c}if(b<0){k="Y";b=-b}var f=(c).toString(16);var e=(b).toString(16);for(var d=0;d<f.length;d++){var g=parseInt(f.charAt(d),16);k+=(((g>=10)?(g+7):g)+10).toString(36)}k+="z";for(var m=0;m<e.length;m++){var j=parseInt(e.charAt(m),16);k+=(((j>=10)?(j+7):j)+10).toString(36)}if(c75){k+=k.charAt(c75)}return k.toUpperCase()}}};var xE=function(a){var e="";for(var b=0;b<a.length;b++){var d=a.charCodeAt(b).toString(36).toUpperCase();if(d.length<=1){d="0"+d}e+=d}return e};var sdc=function(d){var e="";for(var a=0;a<d.length;a+=2){var b=d.substring(a,a+2);e+=String.fromCharCode(parseInt(b,36))}return e};var getAscii=function(b){b=unescape(b);var d=String.fromCharCode(b.charCodeAt(0)-b.length);for(var a=1;a<b.length;a++){d+=String.fromCharCode(b.charCodeAt(a)-d.charCodeAt(a-1))}return d};function q1l(d){var b=d.split(",");var a=parseFloat(b[0])*100000%36000000;var f=parseFloat(b[1])*100000%36000000;var c=parseInt(k6A5f(a,f)+a);var e=parseInt(gid(a,f)+f);return[c/100000,e/100000]}function f21(d){var b=d.split(",");var a=parseFloat(b[0])*100000%36000000;var f=parseFloat(b[1])*100000%36000000;var e=parseInt(-_a7(a,f)+a);var c=parseInt(-WqDmW(a,f)+f);e=parseInt(-_a7(e,c)+a+((a>0)?1:-1));c=parseInt(-WqDmW(e,c)+f+((f>0)?1:-1));return[e/100000,c/100000]}function k6A5f(a,b){return Pwo45(a,b)}function gid(a,b){return pCs9(a,b)}function _a7(a,b){return Pwo45(a,b)}function WqDmW(a,b){return pCs9(a,b)}function Pwo45(a,b){return num2Add(num2Mult(getCosX100000(b,a),getX18000(a,b)),num2Mult(getSinX100000(a,b),getX9000(b,a)))}function pCs9(a,b){return num2Add(num2Mult(getSinX100000(b,a),getX18000(a,b)),num2Mult(getCosX100000(a,b),getX9000(b,a)))}function num2Mult(a,b){return a*b}function num2Add(a,b){return a+b}function getCosX100000(a,b){return Math.cos(a/100000)}function getSinX100000(a,b){return Math.sin(a/100000)}function getX9000(a,b){return a/9000}function getX18000(a,b){return a/18000}var MDiv=function(name,left,top,width,height,visible,zindex,content,container){this.content=content;this.container=container;this.name=name;this.qe=1;this.hide=function(){this.style.visibility="hidden"};this.show=function(){this.style.visibility="visible"};this.setVisible=function(visible){if(this.style.display!=(visible?"":"none")){this.style.display=visible?"":"none"}};this.moveTo=function(x,y){eval(document.body.scrollTop);this.style.left=parseInt(x)+"px";this.style.top=parseInt(y)+"px"};this.resize=function(w,h){if(parseInt(w)>=0&&parseInt(h)>=0){this.style.width=parseInt(w)+"px";this.style.height=parseInt(h)+"px"}};this.getHeight=function(){return parseInt(this.style.height)};this.getWidth=function(){return parseInt(this.style.width)};this.isInside=function(x,y){return(x>parseInt(this.style.left)&&x<(parseInt(this.style.left)+parseInt(this.style.width))&&y>parseInt(this.style.top)&&y<(parseInt(this.style.top)+parseInt(this.style.height)))};this.appendChild=function(fK){try{this.div.appendChild(fK)}catch(_event){}};this.removeChild=function(fK){try{removeNode(fK)}catch(_event){}};this.clear=function(){this.div.innerHTML=""};this.clean=this.clear;this.getName=function(){return this.name};try{this.div=buildDivObj(this.name,left,top,width,height,visible,zindex,content);this.div.unselectable="on";if(this.container){this.container.appendChild(this.div)}this.style=this.div.style;this.graphics=(isIE)?new sN():new jsGraphics(this.name)}catch(_event){}};var MBound=function(a,e,d,c,b,f){this.top=d;this.bottom=a;this.right=c;this.left=e;this.maxZoomLevel=(typeof f=="undefined")?maxZoomLevel:parseInt(f);this.minZoomLevel=(typeof b=="undefined")?minZoomLevel:parseInt(b);this.isInside=function(i,j){if(this.top<i||this.bottom>i){return false}var g=(j-this.left)%360;if(g<0){g+=360}return((this.right-this.left)>=g)}};var MBrush=function(c,i,d,g,b,a,f,e){this.color=(typeof c=="undefined")?"#FF0000":c;this.stroke=(typeof i=="undefined")?5:parseInt(i);this.style=(typeof d=="undefined")?0:parseInt(d);this.fill=(typeof g=="undefined")?false:g;this.bgcolor=(typeof b=="undefined")?this.color:b;this.transparency=(typeof a=="undefined")?transparencyLevel:parseInt(a);this.bgtransparency=(typeof f=="undefined")?transparencyLevel/2:parseInt(f);this.arrow=(typeof e=="undefined")?bArrow:e;this.overlap={enable:false,stroke:null,color:"white",transparency:transparencyLevel};this.toString=function(){return"com.mapbar.maplet.MBrush"}};var MPoint=function(f,c,e,a){this.maplet=null;this.pid=null;this.lat=null;this.lon=null;var d=null;var i=null;this.mapX=null;this.mapY=null;this.lastStamp=null;this.encrypt=(typeof e=="boolean"?e:true);this.levelGroup=(typeof a=="number"&&a>=0&&a<=3?a:3);if(typeof f!="undefined"||typeof c!="undefined"){if(isArray(f)){f=f.join(",")}if(typeof f=="string"&&f.indexOf(",")!=-1){if(this.encrypt){this.pid=f;this.lon=parseFloat(f.split(",")[0]);this.lat=parseFloat(f.split(",")[1])}else{i=parseFloat(f.split(",")[0]);d=parseFloat(f.split(",")[1])}}else{if(!isNaN(parseFloat(f))&&!isNaN(parseFloat(c))){if(this.encrypt){this.pid=f+","+c;this.lon=parseFloat(f);this.lat=parseFloat(c)}else{i=f;d=c}}else{this.pid=(typeof getPid=="undefined")?f:getPid(f);if(apiType==1){var g=cq.Decrypt(this.pid);i=g[0];d=g[1];this.lon=parseFloat(this.pid.split(",")[0]);this.lat=parseFloat(this.pid.split(",")[1])}}}if(this.encrypt&&i==null&&d==null){var b=cq.Decrypt(this.pid);i=b[0];d=b[1]}}this.inLevelRange=function(j){if(j>=0&&j<=3&&this.levelGroup==3){return true}else{if(j>=4&&j<=7&&this.levelGroup>=2){return true}else{if(j>=8&&j<=11&&this.levelGroup>=1){return true}else{if(j>=12&&j<=18&&this.levelGroup>=0){return true}else{return false}}}}};this.getPid=function(){if(!this.encrypt&&!this.pid){this.setMapCoords(this.mapX,this.mapY)}return this.pid};this.setMapCoords=function(j,l){this.mapX=j;this.mapY=l;i=this.maplet.toMapLonCoordinate(j,l);d=this.maplet.toMapLatCoordinate(j,l);this.pid=cq.zn(i,d);if(apiType==1){this.lon=this.pid.split(",")[0];this.lat=this.pid.split(",")[1]}else{if(this.lon!=null){var k=q1l(i+","+d);this.lon=k[0];this.lat=k[1]}}};this.setMapXY=function(){this.mapX=this.maplet.toMapXCoordinate(i,d);this.mapY=this.maplet.toMapYCoordinate(d,i)};this.initialize=function(j){this.maplet=j;this.setMapXY()};this.toString=function(){return"com.mapbar.maplet.MPoint"}};var lQ={nh:function(i,a,d,c,g){a=parseInt(a);d=parseInt(d);c=parseInt(c);if(a==d){lQ.fF(a,i,d,g);return}this.fF(a,i);var f=Math.max(100,Math.round(c/Math.abs(d-a)));var e=Math.max(1,Math.abs((d-a)/(c/f)));var b=a+e;if(a>d){b=a-e}setTimeout("lQ.nh('"+i+"',"+b+","+d+","+(c-f)+",'"+g+"')",(f))},ni:function(b,a){if(typeof a=="undefined"){a=1000}this.nh(b,0,100,a)},nj:function(b,a){if(typeof a=="undefined"){a=1000}this.nh(b,100,0,a)},fF:function(opacity,id,l2,callback){var ai=document.getElementById(id).style;ai.opacity=(opacity/100);ai.MozOpacity=(opacity/100);ai.qK=(opacity/100);ai.filter="alpha(opacity="+opacity+")";if(opacity==l2&&callback!=null){eval(callback)}},qH:function(c,b,a){document.getElementById(c).style.left=parseInt(b)+"px";document.getElementById(c).style.top=parseInt(a)+"px"},move:function(g,f,d,c,b,a,e){this.qH(g,f,d);this.panTo(g,c,b,a,e)},panTo:function(id,nJ,nK,lG,callback){nJ=parseInt(nJ);nK=parseInt(nK);var xa=parseInt(document.getElementById(id).style.left);var xb=parseInt(document.getElementById(id).style.top);lG=parseInt(lG);var g4=nJ-xa;var g5=nK-xb;if(g4==0&&g5==0){if(callback!=null){eval(callback)}return}var g3=Math.abs(g4)+Math.abs(g5);var xd=Math.max(5,g3/(lG/100));var yN=Math.max(100,Math.round(lG/(g3/xd)));var xh=g4*xd/g3;var xi=g5*xd/g3;var uf=xa+xh;var ug=xb+xi;if(g3<xd){uf=nJ;ug=nK}this.qH(id,uf,ug);setTimeout("lQ.panTo('"+id+"',"+nJ+","+nK+","+(lG-yN)+",'"+callback+"')",(yN))}};var f1={fx:[],uo:100,nk:function(b,e,a,d){if(typeof b!="object"||!b){return}this.fx[this.fx.length]=new Image();var c=this.fx.length-1;this.fx[c].q9=b;b.style.filter="alpha(opacity="+this.uo+");";b.style.MozOpacity=(this.uo/100);b.style.opacity=(this.uo/100);b.style.qK=(this.uo/100);if(typeof a!="undefined"){b.width=parseInt(a)+"px";this.fx[c].width=parseInt(a)+"px"}if(typeof d!="undefined"){b.height=parseInt(d)+"px";this.fx[c].height=parseInt(d)+"px"}this.fx[c].container=this;this.fx[c].pn=c;this.fx[c].ln="0";this.fx[c].onload=function(){if(typeof a!="undefined"){this.width=parseInt(a)+"px"}if(typeof d!="undefined"){this.height=parseInt(d)+"px"}this.q9.src=this.src;this.q9.style.filter=null;this.q9.style.MozOpacity=1;this.q9.style.opacity=1;this.q9.style.qK=1;if(typeof a!="undefined"&&!rs){this.q9.width=parseInt(a)+"px";this.q9.style.width=parseInt(a)+"px"}if(typeof d!="undefined"&&!rs){this.q9.height=parseInt(d)+"px";this.q9.style.height=parseInt(d)+"px"}this.q9.setAttribute("done","1");this.ln="1";this.container[this.pn]=null;this.container.clearCache();this.container=null;this.q9=null;this.onload=null;this.onerror=null};this.fx[c].onerror=function(){if(rs){return false}if(typeof a!="undefined"){this.width=parseInt(a)+"px"}if(typeof d!="undefined"){this.height=parseInt(d)+"px"}this.q9.style.filter=null;if(typeof a!="undefined"&&!rs){this.q9.width=parseInt(a)+"px"}if(typeof d!="undefined"&&!rs){this.q9.height=parseInt(d)+"px"}this.ln="1";this.q9.width="300";this.q9.height="300";this.q9.style.width="300";this.q9.style.height="300";this.q9.src=imgMaskUrl;this.q9.style.backgroundColor="#ebeae8";this.q9.setAttribute("done","1");this.container[this.pn]=null;this.container.clearCache();this.container=null;this.q9=null;this.onload=null;this.onerror=null};showLoading();this.fx[c].src=e},clearCache:function(){hideLoading();var c=1;for(var b=0;b<this.fx.length;b++){if(this.fx[b]!=null&&this.fx[b].ln=="0"){c=0}else{if(this.fx[b]!=null){this.fx[b].q9=null;this.fx[b].container=null;this.fx[b].onload=null;this.fx[b].onerror=null;delete (this.fx[b])}}}if(c){for(var a=0;b<this.fx.length;a++){if(this.fx[a]!=null){this.fx[a].q9=null;this.fx[a].container=null;this.fx[a].onload=null;this.fx[a].onerror=null;delete (this.fx[a])}}this.fx.length=0;MEvent.trigger(this,"clean")}}};var MControl=function(options){this.initialize=function(maplet){this.maplet=maplet;var content=[];pushCtrl2Content(content,"ctrlPan",0,0,50,49,-25,0,"_pan_map");pushCtrl2Content(content,"ctrlZoomOut",14,54,24,24,0,0,"_zo_map");var ctrlRulerHeight=getCtrlRulerHeight();pushCtrl2Content(content,"ctrlRuler",14,78,24,ctrlRulerHeight,0,-24);pushCtrl2Content(content,"ctrlZoomIn",14,77+ctrlRulerHeight,24,27,0,-181,"_zi_map");pushCtrl2Content(content,"ctrlSlider",0,0,17,7,-25,-51);content.push('<map name="_pan_map" id="_pan_map">');content.push('<area id="_fb_n_ctrl_imap" shape="poly" title="'+xN[1]+'" coords="35,6,39,3,42,2,47,1,51,1,56,2,61,4,63,6,63,7,55,15,50,13,48,13,43,15,35,7" onFocus="this.blur()" onclick="PerformControl(event, this,2);"/>');content.push('<area id="_fb_s_ctrl_imap" shape="poly" title="'+xN[3]+'" coords="64,38,55,29,50,31,48,31,43,29,34,38,34,39,37,42,42,44,47,45,51,45,56,44,61,42,64,39" onFocus="this.blur()" onclick="PerformControl(event, this,4);"/>');content.push('<area id="_fb_w_ctrl_imap" shape="poly" title="'+xN[0]+'" coords="34,8,42,16,40,21,40,23,42,28,33,37,32,37,30,35,28,30,27,25,27,21,28,16,30,11,33,8" onFocus="this.blur()" onclick="PerformControl(event, this,1);"/>');content.push('<area id="_fb_e_ctrl_imap" shape="poly" title="'+xN[2]+'" coords="64,8,56,16,58,21,58,23,56,28,65,37,66,37,68,35,70,30,71,25,71,21,70,16,68,11,65,8" onFocus="this.blur()" onclick="PerformControl(event, this,3);" />');content.push('<area id="_fb_m_ctrl_imap" shape="circle" title="'+xN[4]+'" coords="48,22,8" onclick="PerformControl(event, this,7);" onFocus="this.blur()" />');content.push("</map>");content.push('<map name="_zo_map" id="_zo_map">');content.push('<area id="_fb_zo_ctrl_imap" shape="poly" title="'+xN[6]+'" coords="8,0,5,1,1,5,0,8,0,21,20,21,20,8,19,5,15,1,12,0" onFocus="this.blur()" onclick="PerformControl(event, this,5);" />');content.push("</map>");content.push('<map name="_zi_map" id="_zi_map">');content.push('<area id="_fb_zi_ctrl_imap" shape="poly" title="'+xN[7]+'" coords="0,183,0,196,1,199,5,203,8,204,12,204,15,203,19,199,20,196,20,183" onFocus="this.blur()" onclick="PerformControl(event, this,6);" />');content.push("</map>");content.push('<div id="_fb_ctrl_leveltip" style="position:absolute;left:0px;top:0px;width:'+MControl.P669H+'px;height:121px;display:none;">');pushLevelTip2Content(content,"_fb_ctrl_lt_s",MControl.levelTipName[0],0,0,MControl.P669H,MControl.eP34,-26,-65,13);pushLevelTip2Content(content,"_fb_ctrl_lt_c",MControl.levelTipName[1],0,40,MControl.P669H,MControl.eP34,-26,-65,8);pushLevelTip2Content(content,"_fb_ctrl_lt_p",MControl.levelTipName[2],0,72,MControl.P669H,MControl.eP34,-26,-65,4);pushLevelTip2Content(content,"_fb_ctrl_lt_cr",MControl.levelTipName[3],0,104,MControl.P669H,MControl.eP34,-26,-65,0);content.push("</div>");this.dom=new MDiv("LayerControl",ctrlLeft,ctrlTop,0,0,true,3,content.join(""),this.maplet.panel);ctrlPan=getElementById("ctrlPan");ctrlZoomOut=getElementById("ctrlZoomOut");ctrlZoomIn=getElementById("ctrlZoomIn");ctrlRuler=getElementById("ctrlRuler");ctrlSlider=getElementById("ctrlSlider");ctrlLevelTip=getElementById("_fb_ctrl_leveltip");ctrlLevelTipStreet=getElementById("_fb_ctrl_lt_s");ctrlLevelTipCity=getElementById("_fb_ctrl_lt_c");ctrlLevelTipProvince=getElementById("_fb_ctrl_lt_p");ctrlLevelTipCountry=getElementById("_fb_ctrl_lt_cr");ctrlSlider.firstChild.id="ctrlSliderImg";getElementById("_pan_map").q9=this.maplet;getElementById("_zo_map").q9=this.maplet;getElementById("_zi_map").q9=this.maplet;ctrlEventNames.mousedown=MEvent.bindDom(ctrlSlider,"mousedown",this,ctrlSliderOnMouseDown);ctrlEventNames.mousemove=MEvent.bindDom(document,"mousemove",this,mouseMove);ctrlEventNames.mouseup=MEvent.bindDom(document,"mouseup",this,mouseUp);ctrlEventNames.click=MEvent.bindDom(ctrlRuler,"click",this,ctrlRulerOnClick);ctrlEventNames.mouseover=MEvent.bindDom(ctrlRuler,"mouseover",this,ctrlRulerOnMouseOver);ctrlEventNames.mouseout=MEvent.bindDom(ctrlRuler,"mouseout",this,ctrlRulerOnMouseOut);ctrlEventNames.mouseout=MEvent.bindDom(ctrlRuler,"mousedown",this,_stopEventBubble);ctrlEventNames.mouseout=MEvent.bindDom(ctrlRuler,"mouseup",this,ctrlRulerOnMouseUp);ctrlEventNames.mouseover=MEvent.bindDom(getElementById("_zo_map"),"mouseover",this,ctrlRulerOnMouseOver);ctrlEventNames.mouseout=MEvent.bindDom(getElementById("_zo_map"),"mouseout",this,ctrlRulerOnMouseOut);ctrlEventNames.mouseover=MEvent.bindDom(getElementById("_zi_map"),"mouseover",this,ctrlRulerOnMouseOver);ctrlEventNames.mouseout=MEvent.bindDom(getElementById("_zi_map"),"mouseout",this,ctrlRulerOnMouseOut);ctrlEventNames.mouseover=MEvent.bindDom(ctrlSlider,"mouseover",this,ctrlRulerOnMouseOver);ctrlEventNames.mouseout=MEvent.bindDom(ctrlSlider,"mouseout",this,ctrlRulerOnMouseOut);ctrlEventNames.click=MEvent.bindDom(ctrlLevelTipStreet,"click",this,ctrlLevelTipOnClick);ctrlEventNames.click=MEvent.bindDom(ctrlLevelTipCity,"click",this,ctrlLevelTipOnClick);ctrlEventNames.click=MEvent.bindDom(ctrlLevelTipProvince,"click",this,ctrlLevelTipOnClick);ctrlEventNames.click=MEvent.bindDom(ctrlLevelTipCountry,"click",this,ctrlLevelTipOnClick);ctrlEventNames.mouseup=MEvent.bindDom(ctrlLevelTipStreet,"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(ctrlLevelTipCity,"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(ctrlLevelTipProvince,"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(ctrlLevelTipCountry,"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mousedown=MEvent.bindDom(ctrlLevelTipStreet,"mousedown",this,ctrlLevelTipOnMouseDown);ctrlEventNames.mousedown=MEvent.bindDom(ctrlLevelTipCity,"mousedown",this,ctrlLevelTipOnMouseDown);ctrlEventNames.mousedown=MEvent.bindDom(ctrlLevelTipProvince,"mousedown",this,ctrlLevelTipOnMouseDown);ctrlEventNames.mousedown=MEvent.bindDom(ctrlLevelTipCountry,"mousedown",this,ctrlLevelTipOnMouseDown);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_zo_map"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_zi_map"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_fb_n_ctrl_imap"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_fb_s_ctrl_imap"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_fb_w_ctrl_imap"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_fb_e_ctrl_imap"),"mouseup",this,ctrlLevelTipOnMouseUp);ctrlEventNames.mouseup=MEvent.bindDom(getElementById("_fb_m_ctrl_imap"),"mouseup",this,ctrlLevelTipOnMouseUp);applyOptionsView.apply(this)};var pushCtrl2Content=function(content,name,left,top,width,height,imgLeft,imgTop,usemap){content.push('<div id="'+name+'" style="position:absolute;left:'+left+"px;top:"+top+"px;width:"+width+"px;height:"+height+'px;overflow:hidden;" onmousedown="return false;">');if(isIE6){content.push('<img id="'+name+'_img" src="'+imgMaskUrl+'" style="position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:"+imgLeft+"px;top:"+imgTop+'px;border:0px;cursor:pointer;"  onmousedown="return false;" unselectable="on" '+(typeof usemap=="string"&&usemap?'usemap="#'+usemap+'"':"")+' galleryimg="no" />')}else{content.push('<img id="'+name+'_img" src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:'+imgLeft+"px;top:"+imgTop+"px;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;border:0px;cursor:pointer;" onmousedown="return false;" unselectable="on" '+(typeof usemap=="string"&&usemap?'usemap="#'+usemap+'"':"")+' galleryimg="no"/>')}content.push("</div>")};var pushLevelTip2Content=function(content,name,text,left,top,width,height,imgLeft,imgTop,_ml){content.push('<div id="'+name+'" style="position:absolute;left:'+left+"px;top:"+top+"px;width:"+width+"px;height:"+height+'px;overflow:hidden;" onmousedown="return false;">');content.push('<div id="'+name+'_text" style="position:absolute;padding-left:16px;padding-top:1px;color:white;z-index:1;width:35px;text-align:center;font-size:12px;cursor:pointer;background-image:url(\''+imgMaskUrl+'\');" _ml="'+_ml+'">'+text+"</div>");if(isIE6){content.push('<img src="'+imgMaskUrl+'" style="position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:"+imgLeft+"px;top:"+imgTop+'px;border:0px;cursor:pointer;"  onmousedown="return false;" unselectable="on" galleryimg="no" />')}else{content.push('<img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:'+imgLeft+"px;top:"+imgTop+"px;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;border:0px;cursor:pointer;" onmousedown="return false;" unselectable="on" galleryimg="no" />')}content.push("</div>")};var getCtrlRulerHeight=function(){var zmRange=maxZoomLevel-minZoomLevel+1;return zmRange*MControl.rulerGap+zmRange*MControl.H2Pk+MControl.rulerGap-1};var getCtrlSliderTop=function(zoomLevel){zoomLevel=maxZoomLevel-zoomLevel;return zoomLevel*MControl.rulerGap+zoomLevel*MControl.H2Pk+getCtrlZoomOutRect().max.y+3};var getCtrlPanRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(ctrlPan){r.width=filter2Num(ctrlPan.style.width,0);r.height=filter2Num(ctrlPan.style.height,0);r.min.x=filter2Num(ctrlPan.style.left,0);r.min.y=filter2Num(ctrlPan.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var getCtrlZoomOutRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(ctrlZoomOut){r.width=filter2Num(ctrlZoomOut.style.width,0);r.height=filter2Num(ctrlZoomOut.style.height,0);r.min.x=filter2Num(ctrlZoomOut.style.left,0);r.min.y=filter2Num(ctrlZoomOut.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var getCtrlRulerRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(ctrlRuler){r.width=filter2Num(ctrlRuler.style.width,0);r.height=filter2Num(ctrlRuler.style.height,0);r.min.x=filter2Num(ctrlRuler.style.left,0);r.min.y=filter2Num(ctrlRuler.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var getCtrlZoomInRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(ctrlZoomIn){r.width=filter2Num(ctrlZoomIn.style.width,0);r.height=filter2Num(ctrlZoomIn.style.height,0);r.min.x=filter2Num(ctrlZoomIn.style.left,0);r.min.y=filter2Num(ctrlZoomIn.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var getCtrlLevelTipRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(ctrlLevelTip){r.width=filter2Num(ctrlLevelTip.style.width,0);r.height=filter2Num(ctrlLevelTip.style.height,0);r.min.x=filter2Num(ctrlLevelTip.style.left,0)+ctrlLeft;r.min.y=filter2Num(ctrlLevelTip.style.top,0)+ctrlTop;r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var setSliderRange=function(){var ctrlRulerRect=getCtrlRulerRect();sliderRange.min=ctrlRulerRect.min.y+MControl.rulerGap;sliderRange.max=ctrlRulerRect.max.y-1-MControl.rulerGap;Lk1cK.min=ctrlRulerRect.min.x;Lk1cK.max=ctrlRulerRect.max.x-3};var setCtrlLocation=function(){with(this.options.location){var rect=this.getRect();var ctrlRulerRect=getCtrlRulerRect();if(type==Maplet.LEFT_TOP){ctrlLeft=marginx;ctrlTop=marginy;ctrlLevelTipLeft=ctrlRulerRect.max.x+5}else{if(type==Maplet.LEFT_BOTTOM){ctrlLeft=marginx;ctrlTop=this.maplet.height-marginy-rect.height;ctrlLevelTipLeft=ctrlRulerRect.max.x+5}else{if(type==Maplet.RIGHT_TOP){ctrlLeft=this.maplet.width-marginx-rect.width;ctrlTop=marginy;ctrlLevelTipLeft=ctrlRulerRect.min.x-MControl.P669H-5}else{if(type==Maplet.RIGHT_BOTTOM){ctrlLeft=this.maplet.width-marginx-rect.width;ctrlTop=this.maplet.height-marginy-rect.height;ctrlLevelTipLeft=ctrlRulerRect.min.x-MControl.P669H-5}}}}}ctrlLevelTipTop=getCtrlRulerRect().min.y-2};this.setLocation=function(location,isHideCtrl){location=location||{};if(typeof location.type!="number"&&!(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM||location.type==Maplet.RIGHT_TOP||location.type==Maplet.LEFT_BOTTOM)){location.type=Maplet.LEFT_TOP}if(typeof location.marginX!="number"){location.marginx=10}if(typeof location.marginY!="number"){location.marginy=10}this.options.location=location;if(typeof isHideCtrl!="boolean"){isHideCtrl=true}if(isHideCtrl){setPosition.apply(this)}};this.setView=function(view,isHideCtrl){view=view||{};if(typeof view.pan!="boolean"){view.pan=true}if(typeof view.zoomout!="boolean"){view.zoomout=true}if(typeof view.ruler!="boolean"){view.ruler=true}if(typeof view.zoomin!="boolean"){view.zoomin=true}this.options.view=view;if(typeof isHideCtrl!="boolean"){isHideCtrl=true}if(isHideCtrl){applyOptionsView.apply(this,[isHideCtrl])}};var ctrlSliderOnMouseDown=function(_event){stopEventBubble(_event);if(!SLD&&(_event.target==ctrlSlider||_event.target==ctrlSlider.firstChild)){setSliderRange.apply(this);SLD=true;this.maplet.setDomCursorStyle("move",ctrlSlider)}else{SLD=false}return SLD};var mouseMove=function(_event){if(SLD){var currTop=_event.clientY-this.maplet.offsetY-this.maplet.top-ctrlTop;if(currTop>=sliderRange.min&&currTop<=sliderRange.max){ctrlSlider.style.top=(currTop-3)+"px";if(ZOOM_TRANSITION&&(!ContentInfo||!ContentInfo.isVisible())){var h=(this.isVisible(ctrlPan)?0:49+10)+(this.isVisible(ctrlZoomOut)?0:24);var zoomLevel=maxZoomLevel-((currTop+h)/(MControl.rulerGap+MControl.H2Pk)-10);this.maplet.AN(zoomLevel)}this.maplet.setDomCursorStyle("move",document.body)}}return SLD};var mouseUp=function(_event){stopEventBubble(_event);if(SLD){var y=_event.clientY-this.maplet.offsetY-this.maplet.top-ctrlTop;y=y<sliderRange.min?sliderRange.min:y;y=y>sliderRange.max?sliderRange.max:y;var h=(this.isVisible(ctrlPan)?0:49+10)+(this.isVisible(ctrlZoomOut)?0:24);var zoomLevel=Math.ceil(maxZoomLevel-((y+h-(isIE?3:1))/(MControl.rulerGap+MControl.H2Pk)-10));if(this.maplet.zoomLevel==zoomLevel){this.maplet.G94$(true);this.maplet.layerDrawMap.setVisible(true);if(this.maplet.layerContainer){this.maplet.layerContainer.setVisible(true)}this.update(zoomLevel)}else{this.maplet.setZoomLevel(parseInt(zoomLevel))}SLD=false;return true}this.maplet.setDomCursorStyle("default",document.body);this.maplet.setDomCursorStyle("default",ctrlSlider);return false};var ctrlRulerOnClick=function(_event){stopEventBubble(_event);setSliderRange.apply(this);var _event=_event||window.event;var y=_event.clientY-ctrlTop-this.maplet.offsetY-this.maplet.top;y=y<sliderRange.min?sliderRange.min:y;y=y>sliderRange.max?sliderRange.max:y;var h=(this.isVisible(ctrlPan)?0:49+10)+(this.isVisible(ctrlZoomOut)?0:24);var zoomLevel=Math.ceil(maxZoomLevel-((y+h-(isIE?3:1))/(MControl.rulerGap+MControl.H2Pk)-10));if(this.maplet.zoomLevel!=zoomLevel){this.maplet.setZoomLevel(parseInt(zoomLevel))}};var _stopEventBubble=function(_event){stopEventBubble(_event)};var ctrlRulerOnMouseUp=function(_event){this.maplet.onMouseup(_event);mouseUp.apply(this,[_event]);if(this.maplet.mapMode!=mapMode.snapshot&&this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.lookup){stopEventBubble(_event)}};var ctrlRulerOnMouseOver=function(_event){stopEventBubble(_event);if(!this.isVisible(ctrlRuler)){return}ctrlLevelTipVisible=false;if(!this.isVisible(ctrlLevelTip)){this.showCtrlLevelTip(true)}};var ctrlRulerOnMouseOut=function(_event){stopEventBubble(_event);ctrlLevelTipVisible=true;getTimeout(this,delayHideCtrlLevelTip,700)};var ctrlLevelTipOnClick=function(_event){stopEventBubble(_event);var _ml=_event.target.getAttribute("_ml");if(_ml){this.maplet.setZoomLevel(filter2Num(_ml))}};var ctrlLevelTipOnMouseUp=function(_event){this.maplet.onMouseup(_event);this.maplet.overview.mouseblur(_event);mouseUp.apply(this,[_event]);stopEventBubble(_event)};var ctrlLevelTipOnMouseDown=function(_event){stopEventBubble(_event)};var delayHideCtrlLevelTip=function(){if(!ctrlLevelTipVisible){return}var loop=false;if(this.isVisible(ctrlLevelTip)){var r=getCtrlLevelTipRect();var pt={x:this.maplet.curX,y:this.maplet.curY};var h6I9={min:{x:r.min.x,y:r.min.y},max:{x:r.max.x,y:r.max.y}};if(_isInsideRect(pt,h6I9)){loop=true}}if(SLD){loop=true}if(loop){getTimeout(this,delayHideCtrlLevelTip,700);return}this.showCtrlLevelTip(false)};this.update=function(zoomLevel){if(this.options&&this.options.location){setCtrlLocation.apply(this);this.dom.style.left=ctrlLeft+"px";this.dom.style.top=ctrlTop+"px"}if(ctrlSlider&&ctrlRuler&&this.isVisible(ctrlSlider)&&this.isVisible(ctrlRuler)){with(ctrlSlider.style){left=filter2Num(ctrlRuler.style.left,0)+2+"px";top=getCtrlSliderTop(zoomLevel)+"px"}}};this.showCtlPan=function(visible,isResetCtrlPosition,isSetVisible2Options){if(!ctrlPan){return}if(typeof visible!="boolean"){visible=true}if(this.isVisible(ctrlPan)!=visible){if(visible){ctrlPan.style.height="49px";ctrlZoomOut.style.left="14px";ctrlRuler.style.left="14px";ctrlZoomIn.style.left="14px"}else{ctrlPan.style.height="0px";ctrlZoomOut.style.left="0px";ctrlRuler.style.left="0px";ctrlZoomIn.style.left="0px"}setVisible.apply(this,[ctrlPan,visible]);if(typeof isSetVisible2Options!="boolean"){isSetVisible2Options=true}if(isSetVisible2Options){this.options.view.pan=visible}if(typeof isResetCtrlPosition!="boolean"){isResetCtrlPosition=true}if(isResetCtrlPosition){setPosition.apply(this)}}};this.showZOButton=function(visible,isResetCtrlPosition,isSetVisible2Options){if(!ctrlZoomOut){return}if(typeof visible!="boolean"){visible=true}if(this.isVisible(ctrlZoomOut)!=visible){if(visible){if(!this.isVisible(ctrlRuler)){ctrlZoomOut.style.height="23px"}else{ctrlZoomOut.style.height="24px"}}else{ctrlZoomOut.style.height="0px"}setVisible.apply(this,[ctrlZoomOut,visible]);if(typeof isSetVisible2Options!="boolean"){isSetVisible2Options=true}if(isSetVisible2Options){this.options.view.zoomout=visible}if(typeof isResetCtrlPosition!="boolean"){isResetCtrlPosition=true}if(isResetCtrlPosition){setPosition.apply(this)}}};this.showCtlRuler=function(visible,isResetCtrlPosition,isSetVisible2Options){if(!ctrlRuler){return}if(typeof visible!="boolean"){visible=true}if(this.isVisible(ctrlRuler)!=visible){if(visible){ctrlRuler.style.height=getCtrlRulerHeight()+"px";ctrlZoomOut.style.height=(filter2Num(ctrlZoomOut.style.height,0)+1)+"px";ctrlZoomIn.style.height=(filter2Num(ctrlZoomIn.style.height,0)+1)+"px";ctrlZoomIn.firstChild.style.top=(filter2Num(ctrlZoomIn.firstChild.style.top,0)+2)+"px"}else{ctrlRuler.style.height="0px";ctrlZoomOut.style.height=Math.max((filter2Num(ctrlZoomOut.style.height,0)-1),0)+"px";ctrlZoomIn.style.height=Math.max((filter2Num(ctrlZoomIn.style.height,0)-1),0)+"px";ctrlZoomIn.firstChild.style.top=(filter2Num(ctrlZoomIn.firstChild.style.top,0)-2)+"px"}setVisible.apply(this,[ctrlSlider,visible]);setVisible.apply(this,[ctrlRuler,visible]);if(typeof isSetVisible2Options!="boolean"){isSetVisible2Options=true}if(isSetVisible2Options){this.options.view.ruler=visible}if(typeof isResetCtrlPosition!="boolean"){isResetCtrlPosition=true}if(isResetCtrlPosition){setPosition.apply(this)}}};this.showZIButton=function(visible,isResetCtrlPosition,isSetVisible2Options){if(!ctrlZoomIn){return}if(typeof visible!="boolean"){visible=true}if(this.isVisible(ctrlZoomIn)!=visible){if(visible){ctrlZoomIn.style.height="24px"}else{ctrlZoomIn.style.height="0px"}setVisible.apply(this,[ctrlZoomIn,visible]);if(typeof isSetVisible2Options!="boolean"){isSetVisible2Options=true}if(isSetVisible2Options){this.options.view.zoomin=visible}if(typeof isResetCtrlPosition!="boolean"){isResetCtrlPosition=true}if(isResetCtrlPosition){setPosition.apply(this)}}};this.showCtrlLevelTip=function(visible){if(!ctrlLevelTip){return}if(typeof visible!="boolean"){visible=true}if(this.isVisible(ctrlLevelTip)!=visible){if(visible){ctrlLevelTip.style.left=ctrlLevelTipLeft+"px";ctrlLevelTip.style.top=ctrlLevelTipTop+"px";if(this.options.location.type==Maplet.LEFT_TOP||this.options.location.type==Maplet.LEFT_BOTTOM){ctrlLevelTipStreet.childNodes[1].style.top=ctrlLevelTipCity.childNodes[1].style.top=ctrlLevelTipProvince.childNodes[1].style.top=ctrlLevelTipCountry.childNodes[1].style.top="-65px";ctrlLevelTipStreet.childNodes[0].style.paddingLeft=ctrlLevelTipCity.childNodes[0].style.paddingLeft=ctrlLevelTipProvince.childNodes[0].style.paddingLeft=ctrlLevelTipCountry.childNodes[0].style.paddingLeft="16px";ctrlLevelTipStreet.childNodes[0].style.paddingRight=ctrlLevelTipCity.childNodes[0].style.paddingRight=ctrlLevelTipProvince.childNodes[0].style.paddingRight=ctrlLevelTipCountry.childNodes[0].style.paddingRight="0px"}else{ctrlLevelTipStreet.childNodes[1].style.top=ctrlLevelTipCity.childNodes[1].style.top=ctrlLevelTipProvince.childNodes[1].style.top=ctrlLevelTipCountry.childNodes[1].style.top="-84px";ctrlLevelTipStreet.childNodes[0].style.paddingLeft=ctrlLevelTipCity.childNodes[0].style.paddingLeft=ctrlLevelTipProvince.childNodes[0].style.paddingLeft=ctrlLevelTipCountry.childNodes[0].style.paddingLeft="0px";ctrlLevelTipStreet.childNodes[0].style.paddingRight=ctrlLevelTipCity.childNodes[0].style.paddingRight=ctrlLevelTipProvince.childNodes[0].style.paddingRight=ctrlLevelTipCountry.childNodes[0].style.paddingRight="16px"}setVisible.apply(this,[ctrlLevelTipCountry,minZoomLevel<=0]);setVisible.apply(this,[ctrlLevelTipProvince,(4>=minZoomLevel&&4<=maxZoomLevel)]);setVisible.apply(this,[ctrlLevelTipCity,(8>=minZoomLevel&&8<=maxZoomLevel)]);setVisible.apply(this,[ctrlLevelTipStreet,maxZoomLevel>=13]);if(!this.isVisible(ctrlLevelTipStreet)){var c=13-maxZoomLevel;ctrlLevelTip.style.top=ctrlLevelTipTop-(c*MControl.rulerGap+c*MControl.H2Pk)+"px"}else{if(maxZoomLevel>13){var c=maxZoomLevel-13;ctrlLevelTip.style.top=ctrlLevelTipTop+(c*MControl.rulerGap+c*MControl.H2Pk)+"px"}}}setVisible.apply(this,[ctrlLevelTip,visible])}};var applyOptionsView=function(isResetCtrlPosition){if(typeof isResetCtrlPosition!="boolean"){isResetCtrlPosition=true}with(this.options.view){this.showCtlPan(pan,false);this.showZOButton(zoomout,false);this.showCtlRuler(ruler,false);this.showZIButton(zoomin,false)}if(isResetCtrlPosition){setPosition.apply(this)}};var setPosition=function(){this.showCtrlLevelTip(false);ctrlZoomOut.style.top=(getCtrlPanRect().max.y+(this.isVisible(ctrlPan)?5:-5))+"px";ctrlRuler.style.top=getCtrlZoomOutRect().max.y+"px";ctrlZoomIn.style.top=getCtrlRulerRect().max.y+"px";this.maplet.setRightBottom();this.maplet.VgxX4();this.update(this.maplet.zoomLevel)};this.hide=function(){setVisible.apply(this,[this.dom,false])};this.show=function(){setVisible.apply(this,[this.dom,true])};var setVisible=function(ctrlObj,visible){if(!this.dom||typeof ctrlObj!="object"||!ctrlObj){return}if(ctrlObj.style.display!=(visible?"":"none")){ctrlObj.style.display=visible?"":"none"}};this.isVisible=function(ctrlObj){if(typeof ctrlObj!="object"||!ctrlObj){ctrlObj=this.dom}if(!ctrlObj){return false}return ctrlObj.style.display==""};this.g1=function(){if(this.dom){removeNode(this.dom)}if(getElementById("_pan_map")){getElementById("_pan_map").q9=null}if(getElementById("_zo_map")){getElementById("_zo_map").q9=this.maplet}if(getElementById("_zi_map")){getElementById("_zi_map").q9=this.maplet}};this.getRect=function(){var r={min:{x:null,y:null},max:{x:null,y:null},_min:{x:null,y:null},_max:{x:null,y:null},width:null,height:null};if(this.isVisible(this.dom)){if(this.isVisible(ctrlPan)){r=getCtrlPanRect();r._min={x:null,y:null};r._max={x:null,y:null}}if(this.isVisible(ctrlZoomOut)){var v=getCtrlZoomOutRect();if(r.min.x==null){r.min.x=v.min.x}if(r.min.y==null){r.min.y=v.min.y}if(r.max.x==null){r.max.x=v.max.x}r.max.y=v.max.y}if(this.isVisible(ctrlRuler)){var v=getCtrlRulerRect();if(r.min.x==null){r.min.x=v.min.x}if(r.min.y==null){r.min.y=v.min.y}if(r.max.x==null){r.max.x=v.max.x}r.max.y=v.max.y}if(this.isVisible(ctrlZoomIn)){var v=getCtrlZoomInRect();if(r.min.x==null){r.min.x=v.min.x}if(r.min.y==null){r.min.y=v.min.y}if(r.max.x==null){r.max.x=v.max.x}r.max.y=v.max.y}r._min.x=r.min.x+ctrlLeft;r._min.y=r.min.x+ctrlTop;r._max.x=r.max.x+ctrlLeft;r._max.y=r.max.y+ctrlTop;r.width=r.max.x-r.min.x;r.height=r.max.y-r.min.y}return r};var ctrlPan=null;var ctrlZoomOut=null;var ctrlZoomIn=null;var ctrlRuler=null;var ctrlSlider=null;var ctrlLevelTip=null;var ctrlLevelTipStreet=null;var ctrlLevelTipCity=null;var ctrlLevelTipProvince=null;var ctrlLevelTipCountry=null;var ctrlEventNames=[];var SLD=false;var sliderRange={min:0,max:0};var Lk1cK={min:0,max:0};var ctrlLeft=-Number.MAX_VALUE;var ctrlTop=-Number.MAX_VALUE;var ctrlLevelTipLeft=-Number.MAX_VALUE;var ctrlLevelTipTop=-Number.MAX_VALUE;var ctrlLevelTipVisible=true;this.maplet=null;this.dom=null;this.options=options||{};with(this.options){this.setLocation(typeof location!="object"?undefined:location,false);this.setView(typeof view!="object"?undefined:view,false)}this.controlCanvas={};this.controlCanvas.div={};this.controlCanvas.div.update=function(){};this.onmousedown=ctrlSliderOnMouseDown;this.onmousemove=mouseMove;this.onmouseup=mouseUp;this.onmouseout=function(){}};MControl.rulerGap=6;MControl.H2Pk=2;MControl.P669H=52;MControl.eP34=18;MControl.levelTipName=["\u8857\u9053","\u57ce\u5e02","\u7701","\u56fd\u5bb6"];function fixEvent(a){if(!a){a=window.event}if(a&&!a.target){a.target=a.srcElement}if(a&&typeof a.button=="undefined"){a.button=a.which}return a}function getTimeout(b,c,a){return window.setTimeout(function(){c.apply(b)},a)}function getInterval(b,c,a){return window.setInterval(function(){c.apply(b)},a)}var MEvent={filterEN:function(a){return"_e__"+a},addListener:function(e,a,d){var a=this.filterEN(a);if(e[a]){var f=true;var g=e[a].length;for(var b=0;b<g;b++){var c=e[a][b];if(c==d){f=false;break}}if(f){e[a].push(d)}}else{e[a]=[d]}return{sc:e,en:a,hl:d}},removeListener:function(d){var a=d.sc[d.en];var b=a.length;for(var e=0;e<b;e++){if(a[e]==d.hl){a.splice(e,1);return}}},contains:function(c,a){var b=this.filterEN(a);if(typeof c[b]!="undefined"){return c[b].length}else{return 0}},clearListeners:function(c,a){var b=this.filterEN(a);c[b]=null},trigger:function(j,c){var d=this.filterEN(c);var a=j[d];if(a&&a.length>0){var f=[];for(var e=2;e<arguments.length;e++){f.push(arguments[e])}for(var e=0;e<a.length;e++){var g=a[e];if(g){try{g.apply(j,f)}catch(b){}}}}},addBuiltInListener:function(c,a,b){if(c.addEventListener){c.addEventListener(a,b,false)}else{if(c.attachEvent){c.attachEvent("on"+a,b)}else{c["on"+a]=b}}return b},removeBuiltInListener:function(c,a,b){if(c.removeEventListener){c.removeEventListener(a,b,false)}else{if(c.detachEvent){c.detachEvent("on"+a,b)}else{c["on"+a]=null}}},bind:function(c,a,b,d){return this.addListener(c,a,function(){d.apply(b,arguments)})},bindDom:function(d,a,b,e){var c=this.bindMethod2Object(b,e);return this.addBuiltInListener(d,a,c)},bindMethod2Object:function(a,b){return function(c){c=fixEvent(c);b.call(a,c)}},callback:function(a,b){return function(){return b.apply(a,arguments)}}};var MIcon=function(f,d,b,a,e,c){this.events=new Array();this.zIndex=1;this.div=document.createElement("div");this.div.unselectable="on";this.div.style.zIndex=this.zIndex;this.div.style.position="absolute";d=(typeof d=="undefined")?16:d;b=(typeof b=="undefined")?16:b;this.img=document.createElement("div");this.img.unselectable="on";this.img.style.MozUserSelect="none";this.img.style.zIndex=this.zIndex;this.img.style.position="absolute";this.img.style.top="0px";this.img.style.left="0px";this.imgUrl=f;this.left=0;this.top=0;this._left=this.left;this._top=this.top;this.setOverlayId=function(g){this.div.id="OverlayBg"+g;this.img.id=g};this.initialize=function(g){if(isIE){this.img.ondragstart=function(){return false}}this.relyMarker=g;setDomAttrVal(this.img.firstChild,"oid",this.relyMarker.id);this.events.mouseover=MEvent.bindDom(this.img.firstChild,"mouseover",this.relyMarker,this.relyMarker.hiliteIcon);this.events.mouseout=MEvent.bindDom(this.img.firstChild,"mouseout",this.relyMarker,this.relyMarker.iconMouseout)};this.setContextMenu=function(g){};this.getImgUrl=function(){var k="";var i=this.img;if(i.innerHTML.indexOf(Maplet.MICON_IMGSRC_FLAG)!=-1){var j=new RegExp(Maplet.MICON_IMGSRC_FLAG+'="?([^"\t ]*)',"gi");var g=j.exec(i.innerHTML);if(g!=null){k=g[1]}}else{if(i.firstChild&&i.firstChild.tagName.toUpperCase()=="IMG"){k=i.firstChild.src}else{k=this.imgUrl}}return k};this.enableDragMap=function(g){if(!this.img||!this.img.firstChild){return}if(g){setDomAttrVal(this.img.firstChild,_dragmap,"true")}else{removeDomAttr(this.img.firstChild,_dragmap)}};this.updateImage=function(j,i,g){if(this.img.firstChild&&this.imgUrl==j){return}this.imgUrl=j;if(this.imgUrl!=null&&this.imgUrl.indexOf("<")>=0){this.img.innerHTML=this.imgUrl}else{this.img.innerHTML="<img src="+this.imgUrl+" width="+(typeof i=="undefined"?d:i)+" height="+(typeof i=="undefined"?b:nV)+">";if(this.relyMarker){if(this.relyMarker.label&&typeof i!="undefined"){this.relyMarker.label.xoffset+=i-d;d=i}if(this.relyMarker.maplet){this.relyMarker.initialize(this.relyMarker.maplet)}}}this.img.firstChild.onmousedown=function(k){return false};setDomAttrVal(this.img.firstChild,_overlay,"marker");this.enableDragMap(this.relyMarker?!this.relyMarker.bEditable:true)};this.updateImage(f);this.width=(typeof d=="undefined")?parseInt(this.img.width):parseInt(d);this.height=(typeof b=="undefined")?parseInt(this.img.height):parseInt(b);this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.extraParam=(typeof c=="undefined")?f:c;this.anchorX=(typeof a=="undefined")?this.width/2:parseInt(a);this.anchorY=(typeof e=="undefined")?this.height/2:parseInt(e);this.div.appendChild(this.img);this.update=function(i,l,k){var g=parseInt(l)-parseInt(this.anchorX);var j=parseInt(k)-parseInt(this.anchorY);if(this.relyMarker.autoHide&&!this.relyMarker.isMousemove&&(g>i.width||g<-this.width||j>i.height||j<-this.height)){if(this.div.parentNode){this.div.style.top=j+"px";this.div.style.left=g+"px";this.div.parentNode.removeChild(this.div);if(this.relyMarker.label){this.relyMarker.label.remove()}this.visible=false}}else{if(this.div.parentNode!=i.layerDrawMap.div&&!this.relyMarker.isMousemove){i.layerDrawMap.appendChild(this.div);this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.img.width=this.width+"px";this.img.height=this.height+"px";this.visible=true}this.div.style.top=j+"px";this.div.style.left=g+"px";this._left=this.left;this._top=this.top;this.left=g;this.top=j;l=g;k=j;if(this.relyMarker.label){this.relyMarker.label.update(this.relyMarker.maplet,l,k)}}};this.isVisible=function(){return(this.visible)};this.getOverlaySomeAttr=function(){return(this.img.firstChild.src)+","+this.width+","+this.height};this.hilite=function(){if(this.relyMarker){this.relyMarker.hiliteIcon({target:this.img})}};this.finalize=function(){this.remove(true)};this.remove=function(i){if(typeof i!="boolean"){i=false}if(this.img.firstChild){if(isIE){this.img.ondragstart=null}this.img.firstChild.onmousedown=null;for(var g in this.events){MEvent.removeBuiltInListener(this.img.firstChild,g,this.events[g]);this.events[g]=null;if(i){delete this.events[g]}}}if(i){this.events=null}if(this.div){if(!i){if(this.div.parentNode){this.div.parentNode.removeChild(this.div)}}else{removeNode(this.div);this.div=null}}if(i){this.relyMarker=null}};this.setZIndex=function(g){if(this.div&&this.div.parentNode&&g!=this.div.style.zIndex){this.zIndex=this.div.style.zIndex;this.div.style.zIndex=g}};this.resetZIndex=function(){if(!this.div){return}if(this.zIndex!=this.div.style.zIndex){this.setZIndex(this.zIndex)}};this.getRect=function(){var g={min:{x:this.div.offsetLeft,y:this.div.offsetTop},max:{x:0,y:0}};g.max.x=g.min.x+this.div.offsetWidth;g.max.y=g.min.y+this.div.offsetHeight;return g};this.toString=function(){return"com.mapbar.maplet.MIcon"}};var MMarker=function(pt,icon,info,label,shadow){this.id=new Date().getTime()+""+parseInt(Math.random()*10000);this.pt=pt;this.icon=(typeof icon=="undefined")?null:icon;if(this.icon&&this.icon.setOverlayId){this.icon.setOverlayId(this.id)}this.shadow=typeof shadow=="undefined"?null:shadow;if(this.shadow&&this.shadow.setOverlayId){this.shadow.setOverlayId(this.id)}this.label=(typeof label=="undefined")?null:label;if(this.label&&this.label.setOverlayId){this.label.setOverlayId(this.id)}this.info=null;if(typeof info!="undefined"&&info){this.info=info;this.info.setOverlay(this)}this._time=0;this.isMousemove=false;this.bEditable=false;this.rotation=0;this.events=new Array();this.contextmenu=null;this.autoHide=true;this.dragAnimation=true;this.setContextMenu=function(menu){this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}else{if(!menu){this.removeContextMenu()}}};this.getContextMenu=function(dom){return this.contextmenu};this.setOverlayId=function(id){this.id=id;if(this.icon&&this.icon.setOverlayId){this.icon.setOverlayId(id)}if(this.shadow&&this.shadow.setOverlayId){this.shadow.setOverlayId(id)}};this.setEditable=function(editable){this.bEditable=(typeof editable=="undefined")?false:editable;if(REFRESH_MK_INDEX){this.refreshZIndex()}if(this.icon){this.icon.enableDragMap(!this.bEditable)}};this.refreshZIndex=function(AK5){if(!this.icon){return}if(typeof AK5!="boolean"){AK5=true}if(this.maplet){var markerPolygons=this.maplet.getMarkerPolygons(this);if(markerPolygons.length>0){var b=false;for(var i=0;i<markerPolygons.length;i++){if(markerPolygons[i].bEditable){b=true;break}}if(this.bEditable||!b){if(this.icon.div.style.zIndex<0){this.resetZIndex()}}else{if(this.icon.div.style.zIndex>=0){this.setZIndex(-1)}}if(AK5){for(var i=0;i<markerPolygons.length;i++){markerPolygons[i].$C50(this)}}}}};this.initialize=function(maplet){this.maplet=maplet;this.dragAnimation=this.maplet.markerDragAnimation&&this.dragAnimation;if(typeof this.contextmenu=="object"&&this.contextmenu){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}this.events.mousedown=MEvent.bindDom(this.maplet.map,"mousedown",this,this.mousedownOnMap);if(this.icon!=null){this.icon.initialize(this)}if(this.label!=null){this.label.initialize(this)}if(this.shadow!=null){this.shadow.initialize(this)}if(this.info!=null){this.events["info_"+this.info.eventType]=MEvent.bindDom(this.maplet.map,this.info.eventType,this,this.openInfoWindow)}else{this.events.click=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}if(typeof this.maplet.layerDrawMap!="undefined"){this.paint()}if(REFRESH_MK_INDEX){this.refreshZIndex()}};this.toString=function(){return"com.mapbar.maplet.MMarker"};this.paint=function(){if(!this.maplet){return}if(!this.pt.maplet){this.pt.initialize(this.maplet)}if(this.maplet.Or5V$){if(this.maplet.lastStamp!=this.pt.lastStamp){this.pt.mapX+=this.maplet.deltaX;this.pt.mapY+=this.maplet.deltaY;this.pt.lastStamp=this.maplet.lastStamp}}else{this.pt.setMapXY()}if(this.icon){if(!this.icon.relyMarker){this.icon.initialize(this)}this.icon.update(this.maplet,this.pt.mapX,this.pt.mapY)}if(this.shadow){if(!this.shadow.relyMarker){this.shadow.initialize(this)}this.shadow.update(this.maplet,this.pt.mapX,this.pt.mapY)}};this.getOverlaySomeAttr=function(){return(this.icon.isVisible())?"1,"+this.pt.getPid()+","+this.icon.getOverlaySomeAttr():""};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}if(this.maplet&&this.maplet.markerDragAnimation){this.maplet.setDragCross(false)}if(finalize){this.removeContextMenu()}if(this.icon){this.icon.remove(finalize)}if(this.label){this.label.remove(finalize)}if(this.shadow){this.shadow.remove(finalize)}if(this.maplet){for(var l8 in this.events){var l9=l8.substring(0,5)=="info_"?l8.substring(5):l8;MEvent.removeBuiltInListener(this.maplet.map,l9,this.events[l8]);this.events[l8]=null;if(finalize){delete this.events[l8]}}if(this.maplet.overLay[this.id]){this.maplet.overLay[this.id]=null;delete this.maplet.overLay[this.id]}}if(finalize){this.events=null}this.maplet=null};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.openInfoWindow=function(_event){if(this.openInfoWindow.caller==null){}if(this.maplet!=null){if((new Date().getTime()-this._time)<200){return}if(this.maplet.y$pP_&&typeof _event=="object"&&((this.icon&&isTarget(_event.target,this.icon.img))||(this.label&&isTarget(_event.target,this.label.div)))){this.maplet.y$pP_=false;if(this.maplet.isMoved||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this)){return}}var x=this.pt.mapX;var y=this.pt.mapY;if(typeof _event=="undefined"||(typeof _event=="object"&&this.icon&&isTarget(_event.target,this.icon.img))||(typeof _event=="object"&&this.label&&isTarget(_event.target,this.label.div))){if(typeof _event=="object"&&this.maplet.mapMode!=mapMode.pan&&this.maplet.mapMode!=mapMode.edit){return}if(!this.icon.isVisible()){if(x>=this.maplet.width*1.5||x<=-(this.maplet.width/2)||y<=-(this.maplet.height/2)||y>=this.maplet.height*1.5){this.maplet.setCenter(this.pt.getPid());x=this.maplet.width/2;y=this.maplet.height/2}}this.x=x;this.y=y;if(this.openInfoWindow.caller&&this.openInfoWindow.caller.toString().indexOf(".call(")!=-1){avBubble.$X$8=false;MEvent.trigger(this,"click",this)}if(!this.maplet){return}if(!this.info){return}else{if(!this.info.getOverlay()){this.info.setOverlay(this)}}if(iToolTipStyle!=2){this.hiliteIcon({target:{id:this.id}});this.maplet.wN(x,y,this.info,"","",true)}}else{if(typeof _event=="boolean"&&_event||_event=="true"){if(!this.info){return}else{if(!this.info.getOverlay()){this.info.setOverlay(this)}}if(x>this.maplet.width*2||x<-this.maplet.width||y<-this.maplet.height||y>this.maplet.height*2){this.maplet.setCenter(this.pt.getPid());x=this.maplet.width/2;y=this.maplet.height/2}this.maplet.wN(x,y,this.info,true)}}}};this.mousedownOnMap=function(_event){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&isTarget(_event.target,this.icon.img)&&_event.button!=2){this.isMousedown=true;this.fd=false;this.targetId=this.id;this.iconInnerX=parseInt(_event.clientX-this.maplet.offsetX-this.maplet.left)-parseInt(this.icon.div.style.left);this.iconInnerY=parseInt(_event.clientY-this.maplet.offsetY-this.maplet.top)-parseInt(this.icon.div.style.top);if(this.rotation==1){var lb=this.iconInnerX-this.icon.width/2;var lc=this.iconInnerY-this.icon.height/2;var la=Math.sqrt(lb*lb+lc*lc);if(la>(this.icon.width/4-5)){this.fd=true;this.downX=_event.clientX;this.downY=_event.clientY}}this.events.mousemove=MEvent.bindDom(document,"mousemove",this,this.mousemove);this.events.mouseup=MEvent.bindDom(document,"mouseup",this,this.mouseblur);if(isIE){this.events.losecapture=MEvent.bindDom(document.body,"losecapture",this,this.mouseblur)}else{this.events.blur=MEvent.bindDom(window,"blur",this,this.mouseblur)}}};this.mousemove=function(_event){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&(isTarget(_event.target,this.icon.img)||this.targetId==this.id)){if(this.isMousedown){if(avBubble.overlay&&avBubble.overlay.id==this.id){this.maplet.hideBubble()}if(!this.fd){var x=_event.clientX-this.maplet.offsetX-this.maplet.left-this.iconInnerX;var y=_event.clientY-this.maplet.offsetY-this.maplet.top-this.iconInnerY;var mDragCross=this.maplet.dragCross;var dragCrossX=0,dragCrossY=0;if(this.icon.div.parentNode==this.maplet.layerDrawMap.div){this.maplet.panel.appendChild(this.icon.div);if(this.label){this.maplet.panel.appendChild(this.label.div)}if(this.shadow){this.maplet.panel.appendChild(this.shadow.div)}this.setZIndex(_zIndex);if(isIE){document.body.setCapture()}if(this.maplet.markerDragAnimation){dragCrossX=mDragCross.X;dragCrossY=mDragCross.Y}}if(!autoPanToMapTimer){autoPanToMapTimer=getInterval(this,x46B,100)}if(this.dragAnimation){y=y+this.icon.anchorY-mDragCross.height/2;this.maplet.setDragCross(true,x+this.icon.anchorX-mDragCross.width/2,y);y=y-mDragCross.offsetY-this.icon.height}this.x=x;this.y=y;this._time=new Date().getTime();this.isMousemove=true;this.icon.update(this.maplet,x+this.icon.anchorX,y+this.icon.anchorY);if(this.shadow){var g4=this.icon.left-this.icon._left;var g5=this.icon.top-this.icon._top;this.shadow.update(this.maplet,this.shadow.left+g4+this.shadow.anchorX+dragCrossX,this.shadow.top+g5+this.shadow.anchorY+dragCrossY)}if(MEvent.contains(this,"draging")){var pt=null;if(this.dragAnimation){pt=new MPoint(this.maplet.toMapCoordinate(filter2Num(mDragCross.container.div.style.left)+mDragCross.width/2,filter2Num(mDragCross.container.div.style.top)+mDragCross.height/2))}else{pt=new MPoint(this.maplet.toMapCoordinate(this.x+this.icon.anchorX,this.y+this.icon.anchorY))}pt.initialize(this.maplet);MEvent.trigger(this,"draging",this,pt)}}else{var wc=parseInt(_event.clientX-this.maplet.offsetX-this.maplet.left)-parseInt(this.icon.div.style.left);var wd=parseInt(_event.clientY-this.maplet.offsetY-this.maplet.top)-parseInt(this.icon.div.style.top);var wa=Math.atan2((wd-this.icon.height/2),wc-this.icon.width/2);var wb=((90+wa*180/Math.PI)+360)%360;MEvent.trigger(this,"rotate",wb)}}}};this.mouseblur=function(_event){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&this.isMousedown&&this.isMousemove){if(this.maplet.doPaning){this.maplet.finishupPan()}MEvent.removeBuiltInListener(document,"mousemove",this.events.mousemove);this.events.mousemove=null;MEvent.removeBuiltInListener(document,"mouseup",this.events.mouseup);this.events.mouseup=null;if(isIE){MEvent.removeBuiltInListener(document.body,"losecapture",this.events.losecapture);this.events.losecapture=null}else{MEvent.removeBuiltInListener(window,"blur",this.events.blur);this.events.blur=null}if(!this.fd){var x=_event.clientX-this.maplet.offsetX-this.maplet.left-this.iconInnerX;var y=_event.clientY-this.maplet.offsetY-this.maplet.top-this.iconInnerY;if(isNaN(x)){x=this.x}if(isNaN(y)){y=this.y}if(this.icon.div.parentNode!=this.maplet.layerDrawMap.div){this.maplet.layerDrawMap.appendChild(this.icon.div);if(this.label){this.maplet.layerDrawMap.appendChild(this.label.div)}if(this.shadow){this.maplet.layerDrawMap.appendChild(this.shadow.div);this.shadow.resetZIndex()}with(this.maplet.dragCross.container){if(div.parentNode!=this.maplet.layerDrawMap.div){this.maplet.layerDrawMap.div.appendChild(div);div.style.zIndex=this.icon.div.style.zIndex-1}}if(isIE){document.body.releaseCapture()}}if(this.dragAnimation){y=parseInt(this.maplet.dragCross.container.style.top)+this.maplet.dragCross.height/2-this.icon.anchorY}this.pt.setMapCoords(x+this.icon.anchorX,y+this.icon.anchorY);this.x=x;this.y=y;if(this.dragAnimation){iconUpAndDown.apply(this)}}else{}MEvent.trigger(this,"drag",this);MEvent.trigger(this.maplet,"edit",this);if(this.isMousemove){this._time=new Date().getTime();this.isMousemove=false}if(this.maplet.mapMode==mapMode.measure||this.maplet.mapMode==mapMode.ta||this.maplet.mapMode==mapMode.lz||this.maplet.mapMode==mapMode.ly){this.maplet.XHl=false}}if(this.targetId==this.id){this.targetId=null}this.isMousedown=false};this.hiliteIcon=function(_event){if(this.icon!=null&&isTarget(_event.target,this.id)){if(this.maplet.mapMode==mapMode.zoomin||this.maplet.mapMode==mapMode.zoomout||this.maplet.mapMode==mapMode.snapshot){this.maplet.setDomCursorStyle("no-drop",this.icon.img)}else{if(this.info||MEvent.contains(this,"click")>0){this.maplet.setDomCursorStyle("pointer",this.icon.img)}}if(this.icon.div.style.zIndex<_zIndex){_zIndex++}this.icon.setZIndex(_zIndex);if(this.label){this.label.setZIndex(_zIndex)}var zh=cq.Decrypt(this.pt.getPid());var x=this.maplet.toMapXCoordinate(zh[0],zh[1]);var y=this.maplet.toMapYCoordinate(zh[1],zh[0]);this.x=x;this.y=y;if(typeof _event.button!="undefined"){MEvent.trigger(this,"mouseover",this)}}};this.iconMouseout=function(_event){this.maplet.setDomCursorStyle("default",this.icon.img);if(this.icon!=null&&isTarget(_event.target,this.id)){var zh=cq.Decrypt(this.pt.pid);var x=this.maplet.toMapXCoordinate(zh[0],zh[1]);var y=this.maplet.toMapYCoordinate(zh[1],zh[0]);this.x=x;this.y=y;MEvent.trigger(this,"mouseout",this)}};this.setZIndex=function(zIndex){if(this.icon){this.icon.setZIndex(zIndex)}if(this.label){this.label.setZIndex(zIndex)}if(this.shadow){this.shadow.setZIndex(zIndex)}};this.resetZIndex=function(){if(this.icon){this.icon.resetZIndex()}if(this.label){this.label.resetZIndex()}if(this.shadow){this.shadow.resetZIndex()}};this.setIcon=function(new_icon,redraw){if(typeof redraw!="boolean"){redraw=true}if(this.icon){this.icon.remove();this.icon=null}if(new_icon){this.icon=new_icon;this.icon.setOverlayId(this.id);this.icon.initialize(this);this.icon.enableDragMap(!this.bEditable);if(redraw){this.paint()}}};this.setLabel=function(new_label,redraw){if(typeof redraw!="boolean"){redraw=true}if(this.label){this.label.remove();this.label=null}if(new_label){this.label=new_label;this.label.setOverlayId(this.id);this.label.initialize(this);if(redraw){this.paint()}}};this.setShadow=function(new_shadow,redraw){if(typeof redraw!="boolean"){redraw=true}if(this.shadow){this.shadow.remove();this.shadow=null}if(new_shadow){this.shadow=new_shadow;this.shadow.setOverlayId(this.id);this.shadow.initialize(this);if(redraw){this.paint()}}};this.setInfoWindow=function(infowindow){if(this.info){if(avBubble.overlay&&avBubble.overlay.id==this.id&&ContentInfo&&ContentInfo.isVisible()){this.maplet.hideBubble()}this.info=null}if(infowindow){this.info=infowindow;this.info.setOverlay(this)}};this.setPoint=function(new_pt,redraw){if(typeof redraw!="boolean"){redraw=true}this.pt=new_pt;if(redraw){this.paint()}};var autoPanToMapTimer=null;var x46B=function(){if(this.isMousemove){var mTHo=this.maplet.Lp0m1;var iconRect=this.icon.getRect();var vj=0,vk=0;if(iconRect.min.x<mTHo){vj=50}if(iconRect.min.y<mTHo){vk=50}if(iconRect.max.x>this.maplet.width-mTHo){vj=-50}if(iconRect.max.y+(this.dragAnimation?(this.maplet.dragCross.height+this.maplet.dragCross.offsetY):0)+2>this.maplet.height-mTHo){vk=-50}if((vj!=0||vk!=0)){this.maplet.panTo(vj,vk);if(MEvent.contains(this,"draging")){var pt=null;if(this.dragAnimation){var mDragCross=this.maplet.dragCross;pt=new MPoint(this.maplet.toMapCoordinate(filter2Num(mDragCross.container.div.style.left)+mDragCross.width/2,filter2Num(mDragCross.container.div.style.top)+mDragCross.height/2))}else{pt=new MPoint(this.maplet.toMapCoordinate(this.x+this.icon.anchorX,this.y+this.icon.anchorY))}pt.initialize(this.maplet);MEvent.trigger(this,"draging",this,pt)}return}}window.clearInterval(autoPanToMapTimer);autoPanToMapTimer=null};iconUpAndDownTimer=null;var iconUpAndDown=function(){window.clearTimeout(iconUpAndDownTimer);this.maplet.dragCross.overlay=this;var yw=0,d=50;var E1hG={b:parseInt(this.icon.div.style.top),c:0};E1hG.c=this.pt.mapY-this.icon.anchorY-E1hG.b;var J599=null,_U49=null;if(this.shadow){var J599={b:parseInt(this.shadow.div.style.left),c:0};J599.c=this.pt.mapX-this.shadow.anchorX-J599.b;var _U49={b:parseInt(this.shadow.div.style.top),c:0};_U49.c=this.pt.mapY-this.shadow.anchorY-_U49.b}function h8425(){if(yw<d){yw++;this.icon.update(this.maplet,this.pt.mapX,Math.ceil(WaA23(yw,E1hG.b,E1hG.c,d))+this.icon.anchorY);if(this.shadow){this.shadow.update(this.maplet,Math.ceil(WaA23(yw,J599.b,J599.c,d))+this.shadow.anchorX,Math.ceil(WaA23(yw,_U49.b,_U49.c,d))+this.shadow.anchorY)}iconUpAndDownTimer=getTimeout(this,h8425,10)}else{this.maplet.setDragCross(false)}}h8425.apply(this)};this.fL5n=function(){if(iconUpAndDownTimer){window.clearTimeout(iconUpAndDownTimer);iconUpAndDownTimer=null}this.paint()};var WaA23=function(yw,b,c,d){if((yw/=d)<(1/2.75)){return c*(7.5625*yw*yw)+b}else{if(yw<(2/2.75)){return c*(7.5625*(yw-=(1.5/2.75))*yw+0.75)+b}else{if(yw<(2.5/2.75)){return c*(7.5625*(yw-=(2.25/2.75))*yw+0.9375)+b}else{return c*(7.5625*(yw-=(2.625/2.75))*yw+0.984375)+b}}}}};var MPolyline=function(pts,brush,info,label,options){this.options=options||{};if(typeof this.options.editHilite!="boolean"){this.options.editHilite=true}this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"MPolyline";this.pts=pts;this.brush=(typeof brush=="undefined")?new MBrush():brush;this.info=null;if(typeof info!="undefined"&&info){this.info=info;this.info.setOverlay(this)}this.label=(typeof label=="undefined")?null:label;this.qo=false;this.vpolyline=null;this.nodelayer=null;this.mcontextmenu=new MContextMenu();this.mcontextmenuitem=new MContextMenuItem("\u5220\u9664\u8282\u70b9");this.mcontextmenu.addItem(this.mcontextmenuitem);this.contextmenu=null;this.pathNodeMenu=null;this.events=new Array();this.markers=new Object();this.isRefreshMkIndex=REFRESH_MK_INDEX;this.numMaxValue_1=Number.MAX_VALUE;this.numMaxValue_2=this.numMaxValue_1;this.numMinValue_1=-Number.MAX_VALUE;this.numMinValue_2=this.numMinValue_1;this.maplet=null;this.bEditable=false;this.isMouseDown=false;this.isMouseDownMove=false;this.u$2V=true;this._vshape=null;var O7RaE={yN:null,L898:{x:null,y:null},g0705:{x:null,y:null},p7318:{x:null,y:null}};this.setEditable=function(editable){this.bEditable=(typeof editable!="boolean")?false:editable;if(!this.bEditable&&this.nodelayer){this.removeNodelayer()}if(this.maplet!=null){this.update()}};this.setEditMode=function(mode,editable){if(typeof editable!="boolean"){editable=true}var Q83S2=false;if(mode=="path"){Q83S2=!this.traffic;this.traffic=true}else{if(mode=="default"){Q83S2=this.traffic;this.traffic=false}}if(Q83S2&&this.maplet){this.Wk8()}if(editable&&!this.bEditable){this.setEditable(true)}};this.Wk8=function(){if(!this.maplet){return}if(this.contextmenu){this.contextmenu.hide()}if(this.pathNodeMenu){this.pathNodeMenu.hide()}if(this.mcontextmenu){this.mcontextmenu.hide()}MEvent.removeBuiltInListener(this.maplet.map,"mousedown",this.events.mousedown);this.events.mousedown=null;MEvent.removeBuiltInListener(this.maplet.map,"mouseup",this.events.mouseup);this.events.mouseup=null;this.update();if(!this.traffic){MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.events.mousemove[0]);MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.events.mousemove[1]);this.events.mousemove=null;this.events.mousemove=MEvent.bindDom(this.maplet.map,"mousemove",this,this.mousemoveOnMap);this.events.mousedown=MEvent.bindDom(this.maplet.map,"mousedown",this,this.mousedownOnMap);this.events.mouseup=MEvent.bindDom(this.maplet.map,"mouseup",this,this.mouseupOnMap);if(this.nodelayer){this.nodelayer.style.overflow="";this.nodelayer.style.width="";this.nodelayer.style.height="";this.nodelayer.style.left="";this.nodelayer.style.top=""}}else{MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.events.mousemove);this.events.mousemove=null;this.events.mousedown=MEvent.bindDom(this.maplet.map,"mousedown",this,this.trafficMousedownOnMap);this.events.mouseup=MEvent.bindDom(this.maplet.map,"mouseup",this,this.trafficMouseupOnMap);this.events.mousemove=[];this.events.mousemove[0]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.mouseoverOnMap);this.events.mousemove[1]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.trafficMousemoveOnMap);if(this.nodelayer){this.nodelayer.style.overflow="hidden"}}};this.initialize=function(maplet){this.maplet=maplet;if(typeof this.contextmenu=="object"&&this.contextmenu){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}if(this.pathNodeMenu){if(!this.pathNodeMenu.maplet){this.pathNodeMenu.initialize(this.maplet)}if(!this.pathNodeMenu.containsOverlay(this)){this.pathNodeMenu.addOverlay(this)}}this.mcontextmenu.initialize(this.maplet);this.events.click=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow);if(this.traffic){this.events.mouseover=MEvent.bindDom(this.maplet.map,"mouseover",this,this.mouseoverOnMap);this.events.mousedown=MEvent.bindDom(this.maplet.map,"mousedown",this,this.trafficMousedownOnMap);this.events.mouseup=MEvent.bindDom(this.maplet.map,"mouseup",this,this.trafficMouseupOnMap);this.events.mousemove=[];this.events.mousemove[0]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.mouseoverOnMap);this.events.mousemove[1]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.trafficMousemoveOnMap)}else{this.events.mouseover=MEvent.bindDom(this.maplet.map,"mouseover",this,this.mouseoverOnMap);this.events.mousemove=MEvent.bindDom(this.maplet.map,"mousemove",this,this.mousemoveOnMap);this.events.mousedown=MEvent.bindDom(this.maplet.map,"mousedown",this,this.mousedownOnMap);this.events.mouseup=MEvent.bindDom(this.maplet.map,"mouseup",this,this.mouseupOnMap)}if(this.brush.fill&&this.pts[0].getPid()!=this.pts[this.pts.length-1].getPid()){this.pts.push(this.pts[0])}if(typeof this.maplet.layerDrawMap!="undefined"){this.paint()}};this.toString=function(){return"com.mapbar.maplet.MPolyline"};this.getOverlaySomeAttr=function(){return""};this.zn=function(){if(apiType==1){return{brush:this.brush,points:this.pts}}else{var xU=this.brush.filled?"2":"0";var xT=this.brush.stroke+","+xU+","+this.brush.color+":";for(var i=0;i<this.pts.length;i++){xT+=this.pts[i].getPid()+","}return xT}};this.paint=function(){this.vcanvas=this.maplet.buildVCanvasDiv();if(isIE){if(!this.vshape){this.vshape=document.createElement("v:shape");this.vshape.style.width="1px";this.vshape.style.height="1px";this.vshape.coordsize="1,1";this.vshape.unselectable="on";this.vshape.id=this.id;this.vshape.setAttribute("MStrName",this.toString());this.vshape.strokecolor=this.brush.color;this.vshape.strokeweight=this.brush.stroke+"px";this.vshape.fill=this.brush.fill;this.vshape.filled=this.brush.fill;this.vshape.style.position="absolute";this.vshape.contextmenu=this.contextmenu;setDomAttrVal(this.vshape,_dragmap,"true");setDomAttrVal(this.vshape,_overlay,"polyline");setDomAttrVal(this.vshape,"oid",this.id);this.vstroke=document.createElement("v:stroke");this.vstroke.opacity=parseInt(this.brush.stroke)==0?0:this.brush.transparency/100;this.vstroke.joinstyle="round";this.vstroke.endcap="round";this.vstroke.fill=this.brush.fill;this.vstroke.endarrow=this.brush.arrow?"classic":"";this.vstroke.dashstyle=parseInt(this.brush.style)?"dash":"";this.vfill=document.createElement("v:fill");this.vfill.opacity=((this.brush.bgtransparency)/100);this.vfill.color=this.brush.bgcolor;this.vshape.appendChild(this.vfill);this.vshape.appendChild(this.vstroke);this.vcanvas.appendChild(this.vshape);if(!this.brush.fill&&this.brush.overlap.enable){var brushOverlap=this.brush.overlap;this._vshape=document.createElement("v:shape");this._vshape.style.width="1px";this._vshape.style.height="1px";this._vshape.coordsize="1,1";this._vshape.unselectable="on";this._vshape.strokecolor=brushOverlap.color;this._vshape.strokeweight=(brushOverlap.stroke&&!isNaN(brushOverlap.stroke)?brushOverlap.stroke:this.brush.stroke-2)+"px";this._vshape.fill=false;this._vshape.filled=false;this._vshape.style.position="absolute";setDomAttrVal(this._vshape,_dragmap,"true");setDomAttrVal(this._vshape,_overlay,"polyline");setDomAttrVal(this._vshape,"oid",this.id);var s=document.createElement("v:stroke");s.opacity=brushOverlap.transparency/100;s.joinstyle="round";s.endcap="round";s.fill=false;s.endarrow=this.brush.arrow?"classic":"";s.dashstyle=parseInt(this.brush.style)?"dash":"";this._vshape.appendChild(s);this.vcanvas.appendChild(this._vshape)}this.vshape.onmouseover=MEvent.bindMethod2Object(this,mouseover);this.vshape.onmouseout=MEvent.bindMethod2Object(this,mouseout);this.vshape.onmousedown=MEvent.bindMethod2Object(this,mousedown);this.vshape.onmouseup=MEvent.bindMethod2Object(this,mouseup);if(this._vshape){this._vshape.onmouseover=MEvent.bindMethod2Object(this,mouseover);this._vshape.onmouseout=MEvent.bindMethod2Object(this,mouseout);this._vshape.onmousedown=MEvent.bindMethod2Object(this,mousedown);this._vshape.onmouseup=MEvent.bindMethod2Object(this,mouseup)}}}else{this.vshape=this.vcanvas.firstChild;if(!this.vstroke){this.vstroke=document.createElementNS("http://www.w3.org/2000/svg","path");this.vstroke.setAttribute("id",this.id);this.vstroke.setAttribute("MStrName",this.toString());this.vstroke.setAttribute("stroke-linejoin","round");this.vstroke.setAttribute("stroke-linecap","round");this.vstroke.setAttribute("marker-end",this.brush.arrow?"url(#svgArrow)":"");this.vstroke.setAttribute("stroke",this.brush.color);this.vstroke.setAttribute("stroke-width",this.brush.stroke+"px");this.vstroke.setAttribute("stroke-opacity",this.brush.transparency/100);this.vstroke.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:3,15":"");this.vstroke.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.vstroke.setAttribute("fill",(this.brush.fill)?this.brush.bgcolor:"none");setDomAttrVal(this.vstroke,_dragmap,"true");setDomAttrVal(this.vstroke,_overlay,"polyline");setDomAttrVal(this.vstroke,"oid",this.id);if(!this.brush.fill&&this.brush.overlap.enable){var brushOverlap=this.brush.overlap;this._vshape=document.createElementNS("http://www.w3.org/2000/svg","path");this._vshape.setAttribute("stroke-linejoin","round");this._vshape.setAttribute("stroke-linecap","round");this._vshape.setAttribute("marker-end",this.brush.arrow?"url(#svgArrow)":"");this._vshape.setAttribute("stroke",brushOverlap.color);this._vshape.setAttribute("stroke-width",(brushOverlap.stroke&&!isNaN(brushOverlap.stroke)?brushOverlap.stroke:this.brush.stroke-2)+"px");this._vshape.setAttribute("stroke-opacity",brushOverlap.transparency/100);this._vshape.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:3,15":"");this._vshape.setAttribute("fill","none");setDomAttrVal(this._vshape,_dragmap,"true");setDomAttrVal(this._vshape,_overlay,"polyline");setDomAttrVal(this._vshape,"oid",this.id)}this.events.vstroke_mouseover=MEvent.bindDom(this.vstroke,"mouseover",this,mouseover);this.events.vstroke_mouseout=MEvent.bindDom(this.vstroke,"mouseout",this,mouseout);this.events.vstroke_mousedown=MEvent.bindDom(this.vstroke,"mousedown",this,mousedown);this.events.vstroke_mouseup=MEvent.bindDom(this.vstroke,"mouseup",this,mouseup);this.events.vstroke_mousemove=MEvent.bindDom(this.vstroke,"mousemove",this,mousemove);if(this._vshape){this.events.overlapLine_mouseover=MEvent.bindDom(this._vshape,"mouseover",this,mouseover);this.events.overlapLine_mouseout=MEvent.bindDom(this._vshape,"mouseout",this,mouseout);this.events.overlapLine_mousedown=MEvent.bindDom(this._vshape,"mousedown",this,mousedown);this.events.overlapLine_mouseup=MEvent.bindDom(this._vshape,"mouseup",this,mouseup);this.events.overlapLine_mousemove=MEvent.bindDom(this._vshape,"mousemove",this,mousemove)}if(typeof this.contextmenu=="object"&&this.contextmenu){this.vstroke.contextmenu=this.contextmenu}this.vshape.appendChild(this.vstroke);if(this._vshape){this.vshape.appendChild(this._vshape)}}}this.update()};var mouseover=function(_event){var pathEleObject=_event.target;if(this.maplet.mapMode==mapMode.zoomin||this.maplet.mapMode==mapMode.zoomout||this.maplet.mapMode==mapMode.snapshot){this.maplet.setDomCursorStyle("crosshair",pathEleObject)}else{if(this.info||MEvent.contains(this,"click")){this.maplet.setDomCursorStyle("pointer",pathEleObject)}else{this.maplet.setDomCursorStyle("default",pathEleObject)}}if(_event.type=="mouseover"){MEvent.trigger(this,"mouseover",this)}};var mouseout=function(_event){if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("default",_event.target)}MEvent.trigger(this,"mouseout",this)};var mousedown=function(_event){if(!isIE){this.isMouseDown=true;this.isMouseDownMove=false}if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("move",_event.target)}};var mouseup=function(_event){if(!isIE){this.isMouseDown=false}mouseover.apply(this,[_event])};var mousemove=function(_event){if(this.isMouseDown&&!this.isMouseDownMove){this.isMouseDownMove=true}};this.setContextMenu=function(menu){this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}else{if(!menu){this.removeContextMenu()}}};this.getContextMenu=function(dom){if(!dom){return null}if(typeof dom.id=="string"&&dom.id.indexOf("traffic")!=-1&&this.traffic){return this.pathNodeMenu}else{return this.contextmenu}};this.setPathNodeMenu=function(menu){this.pathNodeMenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.pathNodeMenu.maplet){this.pathNodeMenu.initialize(this.maplet)}if(!this.pathNodeMenu.containsOverlay(this)){this.pathNodeMenu.addOverlay(this)}}else{if(!menu){this.removePathNodeMenu()}}};this.removePathNodeMenu=function(){if(this.pathNodeMenu){this.pathNodeMenu.removeOverlay(this);this.pathNodeMenu=null}};this.setBrush=function(new_brush){if(!(new_brush instanceof MBrush)){return}this.brush=new_brush;if(isIE){if(this.vshape&&this.vstroke&&this.vfill){this.vshape.strokecolor=this.brush.color;this.vshape.strokeweight=this.brush.stroke+"px";this.vstroke.opacity=parseInt(this.brush.stroke)==0?0:this.brush.transparency/100;this.vstroke.fill=this.brush.fill;this.vstroke.endarrow=this.brush.arrow?"classic":"none";this.vstroke.dashstyle=parseInt(this.brush.style)?"dash":"";this.vfill.opacity=((this.brush.bgtransparency)/100);this.vfill.color=this.brush.bgcolor}}else{if(this.arrow){this.arrow.setAttribute("fill",this.brush.color);this.arrow.setAttribute("fill-opacity",this.brush.bgtransparency/100+0.3)}if(this.vstroke){this.vstroke.setAttribute("marker-end",this.brush.arrow?"url(#svgArrow)":"");this.vstroke.setAttribute("stroke",this.brush.color);this.vstroke.setAttribute("stroke-width",this.brush.stroke+"px");this.vstroke.setAttribute("stroke-opacity",this.brush.transparency/100);this.vstroke.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:10,15":"");this.vstroke.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.vstroke.setAttribute("fill",(this.brush.fill)?this.brush.bgcolor:"none")}}};this.setInfoWindow=function(infowindow){if(this.info){if(avBubble.overlay&&avBubble.overlay.id==this.id&&ContentInfo&&ContentInfo.isVisible()){this.maplet.hideBubble()}this.info=null}if(infowindow){this.info=infowindow;this.info.setOverlay(this)}};this.setPoints=function(pts){this.pts=pts;if(this.maplet){this.update()}};this.isInMapRange=function(pt){if(typeof pt!="object"||!pt){return false}return(pt.mapX>-this.maplet.width/3&&pt.mapX<this.maplet.width*1.33)&&(pt.mapY>-this.maplet.height/3&&pt.mapY<this.maplet.height*1.33)};this.update=function(){this.nodelayer=document.getElementById(this.id+"vNodeLayer");if(this.bEditable||this.maplet.mapMode==mapMode.edit){if(!this.nodelayer){this.nodelayer=document.createElement("div");this.nodelayer.id=this.id+"vNodeLayer";this.nodelayer.style.position="absolute";this.nodelayer.style.display="none";this.nodelayer.unselectable="on";this.nodelayer.style.zIndex=1;this.vcanvas.appendChild(this.nodelayer)}if(!this.traffic||(this.traffic&&!this.qo)){this.nodelayer.innerHTML=""}if(this.traffic){var _nodeTraffic=document.getElementById(this.id+"_node_traffic");if(_nodeTraffic==null){_nodeTraffic=document.createElement("IMG");_nodeTraffic.style.width=CTLIMG_RESOURCE[0].w+"px";_nodeTraffic.style.height=CTLIMG_RESOURCE[0].h+"px";if(isIE6){_nodeTraffic.src=imgMaskUrl;_nodeTraffic.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);"}else{_nodeTraffic.src=CTLIMG_RESOURCE[0].url}_nodeTraffic.id=this.id+"_node_traffic";_nodeTraffic.style.position="absolute";_nodeTraffic.unselectable="on";_nodeTraffic.alt=lt;_nodeTraffic.title=lt;_nodeTraffic.style.left="-65px";_nodeTraffic.style.top="-112px";_nodeTraffic.ohT15="no";_nodeTraffic.style.cursor="pointer";_nodeTraffic.onmousedown=function(){return false};setDomAttrVal(_nodeTraffic,"oid",this.id);this.nodelayer.style.width="11px";this.nodelayer.style.height="11px";this.nodelayer.style.overflow="hidden";this.nodelayer.appendChild(_nodeTraffic)}if(!this.qo){this.nodelayer.style.display="none"}}}this.pu=new Array();this.aP=new Array();this.aR=new Array();var pg=0;var us=10;if(this.pts==null||this.pts.length<2){return}var cY=false;var mapWidth=this.maplet.width;var mapHeight=this.maplet.height;this.numMaxValue_1=Number.MAX_VALUE;this.numMaxValue_2=this.numMaxValue_1;this.numMinValue_1=-Number.MAX_VALUE;this.numMinValue_2=this.numMinValue_1;for(var qC=0;qC<this.pts.length;qC++){if(!this.pts[qC].inLevelRange(this.maplet.zoomLevel)){continue}if(!this.pts[qC].maplet){this.pts[qC].initialize(this.maplet)}if(this.maplet.Or5V$){if(this.maplet.lastStamp!=this.pts[qC].lastStamp){this.pts[qC].mapX+=this.maplet.deltaX;this.pts[qC].mapY+=this.maplet.deltaY;this.pts[qC].lastStamp=this.maplet.lastStamp}}else{this.pts[qC].setMapXY()}this.numMaxValue_1=Math.min(this.numMaxValue_1,this.pts[qC].mapX);this.numMaxValue_2=Math.min(this.numMaxValue_2,this.pts[qC].mapY);this.numMinValue_1=Math.max(this.numMinValue_1,this.pts[qC].mapX);this.numMinValue_2=Math.max(this.numMinValue_2,this.pts[qC].mapY);if(this.bEditable&&!this.isInMapRange(this.pts[qC])&&!this.isInMapRange(this.pts[qC+1])&&!this.isInMapRange(this.pts[qC-1])){continue}if(this.pts[qC].mapX&&this.pts[qC].mapY){this.aR[pg]=filter2Num(this.pts[qC].mapY);this.aP[pg]=filter2Num(this.pts[qC].mapX);this.pu[pg]=qC;if(mapWidth>this.aP[pg]){mapWidth=this.aP[pg]}if(mapHeight>this.aR[pg]){mapHeight=this.aR[pg]}if(!cY&&(this.aR[pg]<0||this.aR[pg]>this.maplet.height||this.aP[pg]<0||this.aP[pg]>this.maplet.width)){cY=true}if(pg>0&&(Math.abs(this.aP[pg]-this.aP[pg-1])+Math.abs(this.aR[pg]-this.aR[pg-1]))>us){pg++}if(pg==0){pg++}}}if(!(this.bEditable||this.maplet.mapMode==mapMode.edit)&&cY){var aQ=new Array();var aS=new Array();var pv=new Array();pg=0;for(var YK7=1;YK7<this.aP.length;YK7++){if((this.aR[YK7]<-this.maplet.height&&this.aR[YK7-1]<-this.maplet.height)||(this.aR[YK7]>this.maplet.height*2&&this.aR[YK7-1]>this.maplet.height*2)||(this.aP[YK7]>this.maplet.width*2&&this.aP[YK7-1]>this.maplet.width*2)||(this.aP[YK7]<-this.maplet.width&&this.aP[YK7-1]<-this.maplet.width)){continue}if(aQ.length==0||(aQ[pg]!=this.aP[YK7-1]&&aS[pg]!=this.aR[YK7-1])){aQ[pg]=this.aP[YK7-1];aS[pg]=this.aR[YK7-1];pv[pg]=this.pu[YK7-1];pg++}aQ[pg]=this.aP[YK7];aS[pg]=this.aR[YK7];pv[pg]=this.pu[YK7];pg++}this.aP=aQ;this.aR=aS;this.pu=pv;aQ=null;aS=null;pv=null}var pathdata=[];this.pathdata=[];var _i2=false;for(var i=0;i<this.aP.length;i++){if(i==0){pathdata.push("M"+this.aP[i]+","+this.aR[i])}else{if(!_i2&&isIE){pathdata[0]+=" L"+this.aP[i]+","+this.aR[i];_i2=true}else{if(isIE){pathdata.push(this.aP[i]+","+this.aR[i])}else{pathdata.push("L"+this.aP[i]+","+this.aR[i])}}}this.pathdata.push(this.aP[i]+","+this.aR[i]);if((this.bEditable||this.maplet.mapMode==mapMode.edit)&&!this.traffic){var z7=document.getElementById(this.id+"_node_"+this.pu[i]);if(z7==null){z7=new Image();z7.id=this.id+"_node_"+this.pu[i];z7.qf=i;z7.qk=this.pu[i];z7.src=ul;z7.unselectable="on";z7.alt=lt;z7.title=lt;z7.style.position="absolute";z7.style.filter="alpha(opacity=80);";z7.style.MozOpacity=0.8;z7.style.opacity=0.8;z7.onmousedown=function(){return false};z7.contextmenu=this.mcontextmenu}z7.style.left=(parseInt(this.aP[i])-5)+"px";z7.style.top=(parseInt(this.aR[i])-5)+"px";this.nodelayer.appendChild(z7);if(i>0){var z8=document.getElementById(this.id+"_midnode_"+this.pu[i]);if(z8==null){z8=new Image();z8.id=this.id+"_midnode_"+this.pu[i];z8.qf=i;z8.qk=this.pu[i];z8.unselectable="on";z8.src=ul;z8.alt=lt;z8.title=lt;z8.style.position="absolute";z8.style.filter="alpha(opacity=60);";z8.style.MozOpacity=0.6;z8.style.opacity=0.6;z8.onmousedown=function(){return false};z8.contextmenu=this.mcontextmenu}z8.style.left=((parseInt(this.aP[i])+parseInt(this.aP[i-1]))/2-5)+"px";z8.style.top=((parseInt(this.aR[i])+parseInt(this.aR[i-1]))/2-5)+"px";this.nodelayer.appendChild(z8)}}}if(bmc){this.vshape.style.left=parseInt(mapWidth)+"px";this.vshape.style.top=parseInt(mapHeight)+"px"}if(this.vshape){if(isIE){var Dwc9=document.getElementById("fix_id");if(Dwc9){Dwc9.parentNode.removeChild(Dwc9)}var s=document.createElement("script");s.id="fix_id";document.body.insertBefore(s,document.body.firstChild);this.vshape.style.display="none";this.vshape.path=pathdata.join(",")+" e";this.vshape.style.display="";if(this._vshape){this._vshape.style.display="none";this._vshape.path=pathdata.join(",")+" e";this._vshape.style.display=""}}else{this.vstroke.setAttribute("d",pathdata.join(""));if(this._vshape){this._vshape.setAttribute("d",pathdata.join(""))}}}if(this.isRefreshMkIndex&&!(this.maplet.mapMode==mapMode.measure||this.maplet.mapMode==mapMode.ta||this.maplet.mapMode==mapMode.lz||this.maplet.mapMode==mapMode.ly)){this.refreshMarkerZIndex()}};this.refreshMarkerZIndex=function(){if(!this.isStrokeFilled()||!this.maplet){return}var markers=this.maplet.getMarkersInPolygon(this);var _markers=new Object();if(markers.length>0){for(var i=0;i<markers.length;i++){if(this.bEditable&&!markers[i].bEditable){markers[i].setZIndex(-1)}else{if(markers[i].icon&&markers[i].icon.div.style.zIndex<0){markers[i].resetZIndex()}}_markers[markers[i].id]=markers[i]}}for(var j in this.markers){if(!_markers[this.markers[j].id]){if(typeof this.markers[j].resetZIndex=="function"){this.markers[j].resetZIndex()}}}this.markers=_markers};this.isStrokeFilled=function(){if(!this.vstroke){return false}return this.vstroke.getAttribute("fill")!="none"||this.vstroke.getAttribute("fill")==eval(true)};this.$C50=function(X_4){if(!this.markers[X_4.id]){this.markers[X_4.id]=X_4}};this.removeNodelayer=function(){if(this.nodelayer){var childNodelayer=this.nodelayer.childNodes;for(var i=0;i<childNodelayer.length;i++){childNodelayer[i].onmousedown=null;childNodelayer[i].contextmenu=null}this.nodelayer.contextmenu=null;removeNode(this.nodelayer);this.nodelayer=null}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}if(this.isStrokeFilled()&&this.bEditable){this.bEditable=false;this.refreshMarkerZIndex();if(!finalize){this.bEditable=true}}if(isIE){if(this.vshape){this.vshape.onmouseover=null;this.vshape.onmouseout=null;this.vshape.onmousedown=null;this.vshape.onmouseup=null}if(this._vshape){this._vshape.onmouseover=null;this._vshape.onmouseout=null;this._vshape.onmousedown=null;this._vshape.onmouseup=null}}for(var l8 in this.events){if(l8.substring(0,8)=="vstroke_"){if(this.vstroke){MEvent.removeBuiltInListener(this.vstroke,l8.substring(8),this.events[l8])}}else{if(l8.substring(0,10)=="vpolyline_"){if(this.vshape){MEvent.removeBuiltInListener(this.vshape,l8.substring(10),this.events[l8])}}else{if(l8.substring(0,12)=="overlapLine_"){if(this._vshape){MEvent.removeBuiltInListener(this._vshape,l8.substring(12),this.events[l8])}}else{if(this.maplet){var eventsHandler=this.events[l8];if(isArray(eventsHandler)){for(var i=0;i<eventsHandler.length;i++){MEvent.removeBuiltInListener(this.maplet.map,l8,eventsHandler[i])}}else{MEvent.removeBuiltInListener(this.maplet.map,l8,eventsHandler)}}}}}this.events[l8]=null;if(finalize){delete this.events[l8]}}if(finalize){this.events=null;this.removeContextMenu();this.mcontextmenu.remove(true);this.mcontextmenu=null}if(typeof this._vshape=="object"&&this._vshape){removeNode(this._vshape);this._vshape=null}if(isIE){if(typeof this.vshape=="object"&&this.vshape){removeNode(this.vshape);this.vshape=null}}else{if(typeof this.vstroke=="object"&&this.vstroke){removeNode(this.vstroke);this.vstroke=null}}if(this.maplet){if(this.maplet.overLay[this.id]){this.maplet.overLay[this.id]=null;delete this.maplet.overLay[this.id]}}this.removeNodelayer();if(finalize){this.maplet=null}};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.getCenterXY=function(){var _x=0;var _y=0;if(this.brush.fill){_x=this.numMaxValue_1+(this.numMinValue_1-this.numMaxValue_1)/2;_y=this.numMaxValue_2+(this.numMinValue_2-this.numMaxValue_2)/2}else{var pn=Math.ceil(this.pts.length/2)-(this.pts.length%2);if(pn<this.pts.length){_x=this.pts[pn].mapX;_y=this.pts[pn].mapY}}return{x:_x,y:_y}};this.getCenterPt=function(){if(this.numMaxValue_1!=Number.MAX_VALUE&&this.maplet){var centerXY=this.getCenterXY();var pt=new MPoint(this.maplet.toMapCoordinate(centerXY.x,centerXY.y));pt.initialize(this.maplet);return pt}else{return null}};this.openInfoWindow=function(_event){if(this.maplet){if(typeof _event!="undefined"&&(_event.target.id==this.id||_event.target==this._vshape)&&this.maplet.H6$0){this.maplet.H6$0=false;if(this.maplet.isMoved||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this)){return}}if(this.maplet.mapMode!=mapMode.pan&&this.maplet.mapMode!=mapMode.edit){return}if(this.info&&!this.info.getOverlay()){this.info.setOverlay(this)}if(typeof _event=="undefined"){if(this.info!=null&&this.pts.length>=2){var Iess=this.getCenterXY();var _x=Iess.x;var _y=Iess.y;if(_x>=this.maplet.width*1.5||_x<=-(this.maplet.width/2)||_y<=-(this.maplet.height/2)||_y>=this.maplet.height*1.5){this.maplet.setCenter(new MPoint(this.maplet.toMapCoordinate(_x,_y)));_x=this.maplet.width/2;_y=this.maplet.height/2}if(iToolTipStyle==2){this.x=_x;this.y=_y;MEvent.trigger(this,"click",this)}else{this.maplet.wN(_x,_y,this.info,"","",true)}}}else{if((_event.target.id==this.id||_event.target==this._vshape)&&!this.maplet.H6$0){var x=_event.clientX-this.maplet.offsetX-this.maplet.left-(isIE?3:1);var y=_event.clientY-this.maplet.offsetY-this.maplet.top-(isIE?3:1);if(iToolTipStyle==2){this.x=x;this.y=y;MEvent.trigger(this,"click",this)}else{MEvent.trigger(this,"click",this);if(this.info){if(!this.info.getOverlay()){this.info.setOverlay(this)}this.maplet.wN(x,y,this.info,false);avBubble._23=true}}}}}};this.showNodelayer=function(fg){if(this.nodelayer!=null){if(fg){this.nodelayer.style.display="block";this.nodelayer.style.zIndex=10}else{this.nodelayer.style.display="none";this.nodelayer.style.zIndex=0}}};this.mouseoverOnMap=function(_event){if(!this.maplet){return}if(this.maplet.mapMode==mapMode.measure||this.maplet.mapMode==mapMode.ta||this.maplet.mapMode==mapMode.lz||this.maplet.mapMode==mapMode.ly){return}if(this.traffic){if((this.bEditable||this.maplet.mapMode==mapMode.edit)&&!this.qo){if(this.isMousemove){return}var XK45Y=this.F7x5([_event.clientX-this.maplet.offsetX,_event.clientY-this.maplet.offsetY],this.pathdata);if(this.vcanvas!=null&&this.maplet&&XK45Y!=null||isTarget(_event.target,this.nodelayer)){this.showNodelayer(true);var dhN=[-10,-10];if(XK45Y!=null&&this.maplet){dhN=this.XG8(XK45Y[0],XK45Y[1],[_event.clientX-this.maplet.offsetX,_event.clientY-this.maplet.offsetY]);this.XK45Y=XK45Y;if(isIE){this.vshape.style.cursor="pointer"}else{this.vstroke.style.cursor="pointer"}}else{if(isIE){this.vshape.style.cursor="default"}else{this.vstroke.style.cursor="default"}}this.i150j=true;clearTimeout(this.PAA2);this.PAA2=null;var frP=[0,0];switch(this.qls){case 1:frP=[0,1];break;case 2:frP=[1,0];break;case 3:frP=[1,1];break;case 4:frP=[0,0];break;default:frP=[0,0];break}this.nodelayer.style.left=(parseInt(dhN[0])-(isIE?(5+frP[0]):5))+"px";this.nodelayer.style.top=(parseInt(dhN[1])-(isIE?(5+frP[1]):5))+"px"}else{if(isIE){this.vshape.style.cursor="default"}else{this.vstroke.style.cursor="default"}if(this.nodelayer!=null&&this.nodelayer.style.display=="none"){return}if(this.PAA2!=null){return}this.i150j=false;this.PAA2=getTimeout(this,function(){if(this.i150j){return}if(this.nodelayer!=null&&this.nodelayer.style.display=="none"){return}this.showNodelayer(false);clearTimeout(this.PAA2);this.PAA2=null},500)}}else{if(this.qo){this.trafficMousemoveOnMap(_event)}}}else{if(this.bEditable||this.maplet.mapMode==mapMode.edit){if(this.isMousemove||this.vcanvas!=null&&this.maplet&&isTarget(_event.target,isIE?this.vshape:this.vstroke)||isTarget(_event.target,this.nodelayer)||isTarget(_event.target,this._vshape)){if(this.options.editHilite){if(isIE){this.vstroke.opacity=parseInt(this.brush.stroke)==0?0:1}else{this.vstroke.setAttribute("stroke-opacity",1)}}this.showNodelayer(true)}else{if(this.options.editHilite){if(isIE){this.vstroke.opacity=parseInt(this.brush.stroke)==0?0:this.brush.transparency/100}else{this.vstroke.setAttribute("stroke-opacity",this.brush.transparency/100)}}this.showNodelayer(false)}}}};this.mousedownOnMap=function(_event){if(this.vcanvas!=null&&this.maplet&&(isIE&&_event.button==1||!isIE&&_event.button==0)&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&(isTarget(_event.target,isIE?this.nodelayer:this.vstroke)||!isIE&&isTarget(_event.target,this.nodelayer))&&_event.target.id.indexOf("node")!=-1){this.qo=true;this.maplet.targetId=_event.target.id;this.iconInnerX=isIE?_event.offsetX:_event.layerX;this.iconInnerY=isIE?_event.offsetY:_event.layerY;eventTarget=_event.target;if(this.vpolyline==null){if(isIE){this.vpolyline=document.createElement("v:polyline");this.vpolyline.unselectable="on";this.vpolyline.id=this.id;this.vpolyline.strokecolor=this.brush.color;this.vpolyline.strokeweight=this.brush.stroke+"px";this.vpolyline.fill=this.brush.fill;this.vpolyline.filled=this.brush.fill;this.vpolyline.style.position="absolute";this.Ac=document.createElement("v:stroke");this.Ac.opacity=parseInt(this.brush.stroke)==0?0:1;this.Ac.joinstyle="round";this.Ac.endcap="round";this.Ac.fill=this.brush.fill;this.Ac.dashstyle="dash";var Ab=document.createElement("v:fill");Ab.opacity=((this.brush.bgtransparency)/100);Ab.color=this.brush.bgcolor;this.vpolyline.appendChild(Ab)}else{this.vpolyline=document.createElementNS("http://www.w3.org/2000/svg","svg");this.vpolyline.setAttribute("version","1.1");this.vpolyline.setAttribute("overflow","visible");this.vpolyline.setAttribute("viewBox","0 0 "+this.maplet.width+" "+this.maplet.height);this.vpolyline.setAttribute("height",this.maplet.height+"px");this.vpolyline.setAttribute("width",this.maplet.width+"px");this.vpolyline.setAttribute("unselectable","on");this.Ac=document.createElementNS("http://www.w3.org/2000/svg","path");this.Ac.setAttribute("MStrName",this.toString());this.Ac.setAttribute("stroke-linejoin","round");this.Ac.setAttribute("stroke-linecap","round");this.Ac.setAttribute("stroke",this.brush.color);this.Ac.setAttribute("stroke-width",this.brush.stroke+"px");this.Ac.setAttribute("stroke-opacity",1);this.Ac.setAttribute("style","stroke-dasharray:10,15");this.Ac.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.Ac.setAttribute("fill",(this.brush.fill)?this.brush.bgcolor:"none");if(this.brush.arrow){this.arrow=document.createElementNS("http://www.w3.org/2000/svg","path");this.arrow.setAttribute("d","M 0 0 L 10 5 L 0 10 L 4 5 z");this.arrow.setAttribute("fill",this.brush.color);this.arrow.setAttribute("fill-opacity",this.brush.bgtransparency/100+0.3);this.vfill=document.createElementNS("http://www.w3.org/2000/svg","marker");this.vfill.setAttribute("id","arrow"+this.id);this.vfill.setAttribute("viewBox","0 0 10 10");this.vfill.setAttribute("refX","6");this.vfill.setAttribute("refY","5");this.vfill.setAttribute("markerUnits","strokeWidth");this.vfill.setAttribute("orient","auto");this.vfill.appendChild(this.arrow);this.vfill.appendChild(this.arrow);this.vpolyline.appendChild(this.vfill)}}}this.vpolyline.appendChild(this.Ac);this.vcanvas.appendChild(this.vpolyline)}};this.mousemoveOnMap=function(_event){if(eventTarget!=null&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&eventTarget.id.indexOf("node")>0&&this.qo){if(eventTarget!=null){if(avBubble.overlay&&avBubble.overlay.id==this.id){this.maplet.hideBubble()}var x=_event.clientX-this.maplet.offsetX-this.maplet.left-this.iconInnerX;var y=_event.clientY-this.maplet.offsetY-this.maplet.top-this.iconInnerY;eventTarget.style.left=(parseInt(x))+"px";eventTarget.style.top=(parseInt(y))+"px";this._time=new Date().getTime();this.isMousemove=true;var ps=parseInt(eventTarget.qf);var pathdata=new String(isIE?"":"M");if(eventTarget.id.indexOf("_midnode_")>0){pathdata+=this.aP[ps-1]+","+this.aR[ps-1];pathdata+=(isIE?",":"L")+(x+5)+","+(y+5);pathdata+=(isIE?",":"L")+this.aP[ps]+","+this.aR[ps]}else{if(ps>0){pathdata+=this.aP[ps-1]+","+this.aR[ps-1]+(isIE?",":"")}pathdata+=((ps>0&&!isIE)?"L":"")+(x+5)+","+(y+5);if(ps<this.aP.length-1){pathdata+=(isIE?",":"L")+this.aP[ps+1]+","+this.aR[ps+1]}}if(this.vpolyline!=null){if(this.vpolyline.points){this.vpolyline.points.value=pathdata}else{if(isIE){this.vpolyline.value=pathdata}else{this.Ac.setAttribute("d",pathdata)}}}}}};this.mouseupOnMap=function(_event){if(this.vcanvas!=null&&this.maplet&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&this.qo){if(eventTarget!=null&&this.isMousemove){var x=parseInt(_event.clientX)-parseInt(this.maplet.offsetX)-parseInt(this.maplet.left)-this.iconInnerX;var y=parseInt(_event.clientY)-parseInt(this.maplet.offsetY)-parseInt(this.maplet.top)-this.iconInnerY;var ps=parseInt(eventTarget.qk);var ud=this.maplet.toMapCoordinate(x+5,y+5);if(eventTarget.id.indexOf("_midnode_")>0){this.pts.spmapMode.e(ps,0,new MPoint(ud))}else{this.pts.splice(ps,1,new MPoint(ud))}this._time=new Date().getTime();this.isMousemove=false;eventTarget=null;this.update();MEvent.trigger(this,"drag",this);MEvent.trigger(this.maplet,"edit",this)}this.qo=false;if(this.vpolyline.parentNode!=null){removeNode(this.vpolyline);this.vpolyline=null}}if(this.maplet&&this.maplet.targetId==this.id){this.maplet.targetId=null}};this.removeNode=function(e60,menu,overlay){var qf=menu.f43c9;if(typeof qf!="undefined"){if(qf.toString().indexOf(this.id)>=0&&qf.toString().lastIndexOf("_")>=0){qf=qf.toString().substring(qf.toString().lastIndexOf("_")+1)}qf=parseInt(qf);if(!isNaN(qf)&&qf<this.pts.length){this.pts.splice(qf,1);MEvent.trigger(this,"edit",this);MEvent.trigger(this.maplet,"edit",this);if(this.vpolyline!=null&&this.vpolyline.parentNode!=null){removeNode(this.vpolyline);this.vpolyline=null}this.update()}}};MEvent.bind(this.mcontextmenuitem,"select",this,this.removeNode);this.V3W=function(x00J,O11,nc,y6x){this._cv6_=function(L81){var G16=Math.atan2(O11-L81.Ivy6,x00J-L81.y8AH)-L81.L4b7;var x3l48=Math.atan2(y6x-L81.Ivy6,nc-L81.y8AH)-L81.L4b7;while(G16<0){G16+=2*Math.PI}while(x3l48<0){x3l48+=2*Math.PI}while(G16>2*Math.PI){G16-=2*Math.PI}while(x3l48>2*Math.PI){x3l48-=2*Math.PI}return(G16-Math.PI)*(x3l48-Math.PI)<0&&(G16>Math.PI?2*Math.PI-G16:G16)+(x3l48>Math.PI?2*Math.PI-x3l48:x3l48)<Math.PI}};this.HIdee=function(y8AH,Ivy6,L4b7){this.y8AH=y8AH;this.Ivy6=Ivy6;this.L4b7=L4b7};this.vrL16=function(fTr){var v6=null;fTr=fTr.toString().split(",");var o96U2=parseInt(fTr[0]);var F17B=parseInt(fTr[1]);var a6Gi=parseInt(fTr[2]);var J57S8=parseInt(fTr[3]);var lI3=Math.abs(o96U2-a6Gi);var WH9=Math.abs(F17B-J57S8);var Ct90M=parseInt(this.brush.stroke);var g4=Ct90M*WH9/Math.sqrt(Math.pow(lI3,2)+Math.pow(WH9,2));var g5=g4*lI3/WH9;var lx232=4;this.qls=0;if(o96U2==a6Gi){this.qls=1;v6=[[o96U2-Ct90M-lx232,F17B],[o96U2+Ct90M+lx232,F17B],[a6Gi+Ct90M+lx232,J57S8],[a6Gi-Ct90M-lx232,J57S8]]}else{if(F17B==J57S8){this.qls=2;v6=[[o96U2,F17B+Ct90M+lx232],[a6Gi,J57S8+Ct90M+lx232],[a6Gi,J57S8-Ct90M-lx232],[o96U2,F17B-Ct90M-lx232]]}else{if(F17B<J57S8&&o96U2<a6Gi){this.qls=3;v6=[[parseInt(o96U2-g4-lx232),parseInt(F17B+g5+lx232)],[parseInt(a6Gi-g4-lx232),parseInt(J57S8+g5+lx232)],[parseInt(a6Gi+g4+lx232),parseInt(J57S8-g5-lx232)],[parseInt(o96U2+g4+lx232),parseInt(F17B-g5-lx232)]]}else{if(F17B>J57S8&&o96U2<a6Gi){this.qls=4;v6=[[parseInt(o96U2-g4-lx232),parseInt(F17B-g5-lx232)],[parseInt(a6Gi-g4-lx232),parseInt(J57S8-g5-lx232)],[parseInt(a6Gi+g4+lx232),parseInt(J57S8+g5+lx232)],[parseInt(o96U2+g4+lx232),parseInt(F17B+g5+lx232)]]}else{if(F17B>J57S8&&o96U2>a6Gi){this.qls=3;v6=[[parseInt(o96U2-g4-lx232),parseInt(F17B+g5+lx232)],[parseInt(o96U2+g4+lx232),parseInt(F17B-g5-lx232)],[parseInt(a6Gi+g4+lx232),parseInt(J57S8-g5-lx232)],[parseInt(a6Gi-g4-lx232),parseInt(J57S8+g5+lx232)]]}else{if(F17B<J57S8&&o96U2>a6Gi){this.qls=4;v6=[[parseInt(o96U2-g4-lx232),parseInt(F17B-g5-lx232)],[parseInt(o96U2+g4+lx232),parseInt(F17B+g5+lx232)],[parseInt(a6Gi+g4+lx232),parseInt(J57S8+g5+lx232)],[parseInt(a6Gi-g4-lx232),parseInt(J57S8-g5-lx232)]]}}}}}}return v6};this.k$X=[];this.X3fi=function(F22U,fTr){var ub=this.vrL16(fTr);for(var i=0;i<ub.length;i++){this.k$X.push(new this.V3W(ub[i][0],ub[i][1],ub[(i+1)%ub.length][0],ub[(i+1)%ub.length][1]))}var $69Y=new this.HIdee(F22U[0],F22U[1],parseFloat("0.523112313123"));var MAT0=0;for(var j=0;j<this.k$X.length;j++){if(this.k$X[j]._cv6_($69Y)){MAT0++}}this.k$X=[];return MAT0%2!=0};this.F7x5=function(coords,j7W86){for(var i=0;i<j7W86.length-1;i++){if(this.X3fi(coords,[j7W86[i],[j7W86[i+1]]])){return[j7W86[i],[j7W86[i+1]]]}}return null};this.XG8=function(K$c,Ee58_,xvd3){K$c=K$c.toString().split(",");Ee58_=Ee58_.toString().split(",");var T8pP6=[parseInt(Ee58_[0])-parseInt(K$c[0]),parseInt(Ee58_[1])-parseInt(K$c[1])];var VA96=[parseInt(xvd3[0])-parseInt(K$c[0]),parseInt(xvd3[1])-parseInt(K$c[1])];var sf2=VA96[0]*T8pP6[0]+VA96[1]*T8pP6[1];if(sf2<=0){return K$c}var l16F0=T8pP6[0]*T8pP6[0]+T8pP6[1]*T8pP6[1];if(l16F0<=sf2){return Ee58_}return[parseInt(K$c[0])+T8pP6[0]*sf2/l16F0,parseInt(K$c[1])+T8pP6[1]*sf2/l16F0]};this.trafficMousedownOnMap=function(_event){if(this.vcanvas!=null&&this.maplet&&(isIE&&_event.button==1||!isIE&&_event.button==0)&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&isTarget(_event.target,this.nodelayer)){this.qo=true;this.maplet.targetId=_event.target.id;var t942H=parseInt(_event.target.style.left)+(isIE?1:0);var Wp99U=parseInt(_event.target.style.top)+(isIE?1:0);this.iconInnerX=(isIE?_event.offsetX:_event.layerX)+t942H;this.iconInnerY=(isIE?_event.offsetY:_event.layerY)+Wp99U;eventTarget=_event.target}else{this.isMousemove=true}};this.trafficMouseupOnMap=function(_event){if(this.vcanvas!=null&&this.maplet&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&this.qo){this.qo=false;var x=parseInt(_event.clientX)-parseInt(this.maplet.offsetX)-parseInt(this.maplet.left)-this.iconInnerX;var y=parseInt(_event.clientY)-parseInt(this.maplet.offsetY)-parseInt(this.maplet.top)-this.iconInnerY;if(x>0&&y>0){MEvent.trigger(this,"nodedrag",this,new MMarker(new MPoint(this.maplet.toMapCoordinate(x+5,y+5))),(this.$81F(this,this.XK45Y)).slice(0,2))}this.showNodelayer(false);this.i150j=false;clearTimeout(this.PAA2);this.PAA2=null}this.isMousemove=false;if(this.maplet&&this.maplet.targetId==this.id){this.maplet.targetId=null}};this.$81F=function(polyline,HDi9){var v6=[];var pts=polyline.pts;for(var i=0;i<pts.length;i++){if(pts[i].mapX+","+pts[i].mapY==HDi9[0].toString()||pts[i].mapX+","+pts[i].mapY==HDi9[1].toString()){v6.push(i)}}return v6};this.trafficMousemoveOnMap=function(_event){if(eventTarget!=null&&(this.bEditable||this.maplet.mapMode==mapMode.edit)&&this.qo){if(eventTarget!=null){var x=_event.clientX-this.maplet.offsetX-this.maplet.left-this.iconInnerX;var y=_event.clientY-this.maplet.offsetY-this.maplet.top-this.iconInnerY;this.nodelayer.style.left=(parseInt(x))+"px";this.nodelayer.style.top=(parseInt(y))+"px";MEvent.trigger(this,"nodedrag_move",this,new MMarker(new MPoint(this.maplet.toMapCoordinate(x+5,y+5))),(this.$81F(this,this.XK45Y)).slice(0,2));this._time=new Date().getTime();this.isMousemove=true;with(O7RaE){g0705.x=x;g0705.y=y;if(!yN){L898.x=x;L898.y=y;p7318.x=x;p7318.y=y;yN=getInterval(this,rn5,LPN_HOVERING_TIME)}}}}};var rn5=function(){with(O7RaE){if(!this.qo&&yN){clearInterval(yN);yN=null;return}if(L898.x==g0705.x&&L898.y==g0705.y&&(g0705.x!=p7318.x||g0705.y!=p7318.y)){p7318.x=g0705.x;p7318.y=g0705.y;MEvent.trigger(this,"drag_hovering",this,new MMarker(new MPoint(this.maplet.toMapCoordinate(g0705.x+5,g0705.y+5))),(this.$81F(this,this.XK45Y)).slice(0,2))}else{L898.x=g0705.x;L898.y=g0705.y}}};this.appendPoint=function(new_pt,redraw){if(typeof new_pt!="object"||!(new_pt instanceof MPoint)||!new_pt){throw new Error("para new_pt is not a valid MPoint object.")}this.pts.push(new_pt);if(!this.pts[this.pts.length-1].maplet){this.pts[this.pts.length-1].initialize(this.maplet)}if(typeof redraw!="boolean"){redraw=true}if(redraw){this.update()}}};var MEllipse=function(b,e,d,a,c){this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"Ellipse";this.ctrpt=b;this.sax=typeof e!="undefined"&&!isNaN(e)?parseInt(e):300;this.say=typeof d!="undefined"&&!isNaN(d)?parseInt(d):null;this.brush=(typeof a=="undefined")?new MBrush():a;this.info=(typeof c=="undefined")?null:c;this.events=new Array();this.vcanvas=null;this.vellipse=null;this.u$2V=true;this.data={qx:0,qz:0,N33:0,oBsQ5:0,sax:0,say:0};this.isMouseDown=false;this.isMouseDownMove=false;this.initialize=function(f){this.maplet=f;if(this.info){this.events.click=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}this.paint()};this.toString=function(){return"com.mapbar.maplet.MEllipse"};this.paint=function(){if(!this.vellipse){this.vcanvas=this.maplet.buildVCanvasDiv();if(isIE){this.vellipse=document.createElement("v:oval");this.vellipse.strokecolor=this.brush.color;this.vellipse.strokeweight=this.brush.stroke+"px";this.vellipse.filled=this.brush.fill;var g=document.createElement("v:stroke");g.opacity=(this.brush.transparency/100);var f=document.createElement("v:fill");f.opacity=((this.brush.bgtransparency)/100);f.color=this.brush.bgcolor;this.vellipse.appendChild(g);this.vellipse.appendChild(f);this.vcanvas.appendChild(this.vellipse)}else{this.vellipse=document.createElementNS("http://www.w3.org/2000/svg","ellipse");this.vellipse.setAttribute("stroke",this.brush.color);this.vellipse.setAttribute("fill",this.brush.bgcolor);this.vellipse.setAttribute("stroke-width",this.brush.stroke);this.vellipse.setAttribute("stroke-opacity",this.brush.transparency/100);this.vellipse.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.vcanvas.firstChild.appendChild(this.vellipse)}this.vellipse.id=this.id;this.vellipse.style.position="absolute";this.vellipse.unselectable="on";this.vellipse.setAttribute(_dragmap,"true");this.vellipse.setAttribute(_overlay,"true");this.events.ellipse_mouseover=MEvent.bindDom(this.vellipse,"mouseover",this,function(){if(this.maplet.mapMode==mapMode.zoomin||this.maplet.mapMode==mapMode.zoomout||this.maplet.mapMode==mapMode.snapshot){this.maplet.setDomCursorStyle("crosshair",this.vellipse)}else{if(this.info||MEvent.contains(this,"click")){this.maplet.setDomCursorStyle("pointer",this.vellipse)}else{this.maplet.setDomCursorStyle("default",this.vellipse)}}});this.events.ellipse_mouseout=MEvent.bindDom(this.vellipse,"mouseout",this,function(){if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("default",this.vellipse)}});this.events.ellipse_mousedown=MEvent.bindDom(this.vellipse,"mousedown",this,function(){this.isMouseDown=true;this.isMouseDownMove=false;if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("move",this.vellipse)}});this.events.ellipse_mouseup=MEvent.bindDom(this.vellipse,"mouseup",this,function(i){this.isMouseDown=false;this.events.ellipse_mouseover(i)});this.events.ellipse_mousemove=MEvent.bindDom(this.vellipse,"mousemove",this,function(){if(this.isMouseDown&&!this.isMouseDownMove){this.isMouseDownMove=true}})}this.update()};this.update=function(){if(this.vellipse){if(!this.ctrpt.maplet){this.ctrpt.initialize(this.maplet)}if(this.maplet.Or5V$){if(this.maplet.lastStamp!=this.ctrpt.lastStamp){this.ctrpt.mapX+=this.maplet.deltaX;this.ctrpt.mapY+=this.maplet.deltaY;this.ctrpt.lastStamp=this.maplet.lastStamp}}else{this.ctrpt.setMapXY()}var j=this.ctrpt.mapX;var g=this.ctrpt.mapY;var f=parseInt(this.sax/111111/this.maplet.clipLonRange*this.maplet.imgWidth/0.8);var i=f;if(this.say){i=parseInt(this.say/111111/this.maplet.clipLatRange*this.maplet.imgHeight)}this.data.qx=j-f;this.data.qz=g-i;this.data.N33=j+f;this.data.oBsQ5=g+i;this.data.sax=f;this.data.say=i;if(isIE){this.vellipse.style.left=this.data.qx+"px";this.vellipse.style.top=this.data.qz+"px";this.vellipse.style.width=f*2+"px";this.vellipse.style.height=i*2+"px"}else{this.vellipse.setAttribute("cx",j+"px");this.vellipse.setAttribute("cy",g+"px");this.vellipse.setAttribute("rx",f+"px");this.vellipse.setAttribute("ry",i+"px")}}};this.finalize=function(){this.remove(true)};this.remove=function(g){for(var f in this.events){if(f.substring(0,8)=="ellipse_"){if(this.vellipse){MEvent.removeBuiltInListener(this.vellipse,f.substring(8),this.events[f])}}else{if(this.maplet){MEvent.removeBuiltInListener(this.maplet.map,f,this.events[f])}}this.events[f]=null;delete this.events[f]}if(typeof this.vellipse=="object"&&this.vellipse&&this.vellipse.parentNode){removeNode(this.vellipse);this.vellipse=null}this.vcanvas=null;if(this.maplet){if(this.maplet.overLay[this.id]){this.maplet.overLay[this.id]=null;delete this.maplet.overLay[this.id]}}if(g){this.events=null;this.maplet=null}};this.openInfoWindow=function(i){if(this.maplet!=null){if(this.isMouseDownMove){if(i.target.id==this.id&&this.maplet.H6$0){this.maplet.H6$0=false}if(this.maplet.isMoved||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this)){return}}if(!this.info||(this.maplet.mapMode!=mapMode.pan&&this.maplet.mapMode!=mapMode.edit)){return}var f=this.ctrpt.mapX;var j=this.ctrpt.mapY;if(!this.info.getOverlay()){this.info.setOverlay(this)}var g=true;if(typeof i=="undefined"){}else{if(i.target.id==this.id&&!this.maplet.H6$0){MEvent.trigger(this,"click",this);f=i.clientX-this.maplet.offsetX-this.maplet.left-(isIE?3:1);j=i.clientY-this.maplet.offsetY-this.maplet.top-(isIE?3:1)}else{if(i.target.id==this.id&&this.maplet.H6$0){this.maplet.H6$0=false;g=false}else{g=false}}}if(g){this.maplet.wN(f,j,this.info)}}}};var MRoundRect=function(d,b,a,c,e){this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"RRect";this.minpt=d;this.maxpt=b;this.arcsize=typeof a=="number"?a:0.1;this.width=0;this.height=0;this.brush=(typeof c=="undefined")?new MBrush():c;this.info=(typeof e=="undefined")?null:e;this.events=new Array();this.vcanvas=null;this.vroundrect=null;this.u$2V=true;this.isMouseDown=false;this.isMouseDownMove=false;this.initialize=function(f){this.maplet=f;if(this.info){this.events.click=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}this.paint()};this.toString=function(){return"com.mapbar.maplet.MRoundRect"};this.paint=function(){if(!this.vroundrect){this.vcanvas=this.maplet.buildVCanvasDiv();if(isIE){this.vroundrect=document.createElement("v:roundrect");this.vroundrect.strokecolor=this.brush.color;this.vroundrect.strokeweight=this.brush.stroke+"px";this.vroundrect.filled=this.brush.fill;this.vroundrect.arcsize=this.arcsize;var g=document.createElement("v:stroke");g.opacity=(this.brush.transparency/100);var f=document.createElement("v:fill");f.opacity=((this.brush.bgtransparency)/100);f.color=this.brush.bgcolor;this.vroundrect.appendChild(g);this.vroundrect.appendChild(f);this.vcanvas.appendChild(this.vroundrect)}else{this.vroundrect=document.createElementNS("http://www.w3.org/2000/svg","rect");this.vroundrect.setAttribute("stroke",this.brush.color);this.vroundrect.setAttribute("fill",this.brush.bgcolor);this.vroundrect.setAttribute("stroke-width",this.brush.stroke);this.vroundrect.setAttribute("stroke-opacity",this.brush.transparency/100);this.vroundrect.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.vcanvas.firstChild.appendChild(this.vroundrect)}this.vroundrect.id=this.id;this.vroundrect.style.position="absolute";this.vroundrect.unselectable="on";this.vroundrect.setAttribute(_dragmap,"true");this.events.rect_mouseover=MEvent.bindDom(this.vroundrect,"mouseover",this,function(){if(this.maplet.mapMode==mapMode.zoomin||this.maplet.mapMode==mapMode.zoomout||this.maplet.mapMode==mapMode.snapshot){this.maplet.setDomCursorStyle("crosshair",this.vroundrect)}else{if(this.info||MEvent.contains(this,"click")){this.maplet.setDomCursorStyle("pointer",this.vroundrect)}else{this.maplet.setDomCursorStyle("default",this.vroundrect)}}});this.events.rect_mouseout=MEvent.bindDom(this.vroundrect,"mouseout",this,function(){if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("default",this.vroundrect)}});this.events.rect_mousedown=MEvent.bindDom(this.vroundrect,"mousedown",this,function(){this.isMouseDown=true;this.isMouseDownMove=false;if(this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.snapshot){this.maplet.setDomCursorStyle("move",this.vroundrect)}});this.events.rect_mouseup=MEvent.bindDom(this.vroundrect,"mouseup",this,function(i){this.isMouseDown=false;this.events.rect_mouseover(i)});this.events.rect_mousemove=MEvent.bindDom(this.vroundrect,"mousemove",this,function(){if(this.isMouseDown&&!this.isMouseDownMove){this.isMouseDownMove=true}})}this.update()};this.update=function(){if(this.vroundrect){if(!this.minpt.maplet){this.minpt.initialize(this.maplet)}if(!this.maxpt.maplet){this.maxpt.initialize(this.maplet)}if(this.maplet.Or5V$){if(this.maplet.lastStamp!=this.minpt.lastStamp){this.minpt.mapX+=this.maplet.deltaX;this.minpt.mapY+=this.maplet.deltaY;this.minpt.lastStamp=this.maplet.lastStamp}if(this.maplet.lastStamp!=this.maxpt.lastStamp){this.maxpt.mapX+=this.maplet.deltaX;this.maxpt.mapY+=this.maplet.deltaY;this.maxpt.lastStamp=this.maplet.lastStamp}}else{this.minpt.setMapXY();this.maxpt.setMapXY()}var f=this.minpt.mapX;var g=this.minpt.mapY;this.width=Math.abs(this.maxpt.mapX-f);this.height=Math.abs(this.maxpt.mapY-g);if(isIE){this.vroundrect.style.left=f+"px";this.vroundrect.style.top=g+"px";this.vroundrect.style.width=this.width+"px";this.vroundrect.style.height=this.height+"px"}else{this.vroundrect.setAttribute("x",f+"px");this.vroundrect.setAttribute("y",g+"px");this.vroundrect.setAttribute("width",this.width+"px");this.vroundrect.setAttribute("height",this.height+"px");this.vroundrect.setAttribute("rx",this.width*this.arcsize);this.vroundrect.setAttribute("ry",this.height*this.arcsize)}}};this.finalize=function(){this.remove(true)};this.remove=function(g){for(var f in this.events){if(f.substring(0,5)=="rect_"){if(this.vroundrect){MEvent.removeBuiltInListener(this.vroundrect,f.substring(5),this.events[f])}}else{if(this.maplet){MEvent.removeBuiltInListener(this.maplet.map,f,this.events[f])}}this.events[f]=null;delete this.events[f]}if(typeof this.vroundrect=="object"&&this.vroundrect&&this.vroundrect.parentNode){removeNode(this.vroundrect);this.vroundrect=null}this.vcanvas=null;if(this.maplet){if(this.maplet.overLay[this.id]){this.maplet.overLay[this.id]=null;delete this.maplet.overLay[this.id]}}if(g){this.events=null;this.maplet=null}};this.openInfoWindow=function(i){if(this.maplet!=null){if(this.isMouseDownMove){if(i.target.id==this.id&&this.maplet.H6$0){this.maplet.H6$0=false}if(this.maplet.isMoved||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this)){return}}if(!this.info||(this.maplet.mapMode!=mapMode.pan&&this.maplet.mapMode!=mapMode.edit)){return}var f=0;var j=0;if(!this.info.getOverlay()){this.info.setOverlay(this)}var g=true;if(typeof i=="undefined"){f=this.minpt.mapX+this.width/2;j=this.minpt.mapY+this.height/2}else{if(i.target.id==this.id&&!this.maplet.H6$0){MEvent.trigger(this,"click",this);f=i.clientX-this.maplet.offsetX-this.maplet.left-(isIE?3:1);j=i.clientY-this.maplet.offsetY-this.maplet.top-(isIE?3:1)}else{if(i.target.id==this.id&&this.maplet.H6$0){this.maplet.H6$0=false;g=false}else{g=false}}}if(g){this.maplet.wN(f,j,this.info)}}};this.getCenterXY=function(){var g=this.minpt.mapX+this.width/2;var f=this.minpt.mapY+this.height/2;return{x:g,y:f}}};var MLabel=function(c,e,f,b,a){this.label=c;if(typeof e=="object"&&e){a=e}if(typeof a!="object"||!a){a={}}if(typeof e=="object"&&e){if("number,string".indexOf(typeof a.xoffset)==-1){a.xoffset=undefined}if("number,string".indexOf(typeof a.yoffset)==-1){a.yoffset=undefined}if("number,string".indexOf(typeof a.opacity)==-1){a.opacity=undefined}}else{a.xoffset=e;a.yoffset=f;a.opacity=b}if(typeof a.enableStyle!="boolean"){a.enableStyle=true}if(typeof a.visible!="boolean"){a.visible=true}var d=false;this.visible=a.visible;this.xoffset=(typeof a.xoffset=="undefined")?null:parseInt(a.xoffset);this.yoffset=(typeof a.yoffset=="undefined")?null:parseInt(a.yoffset);this.opacity=typeof a.opacity!="undefined";this.div=document.createElement("div");if(a.enableStyle){this.div.className="tiplabel"}this.div.style.left="-1000px";this.div.style.top="-1000px";this.div.unselectable="on";this.div.style.zIndex=10;this.div.style.position="absolute";if(isIE&&typeof a.opacity!="undefined"){this.div.style.filter="alpha( opacity = "+parseInt(a.opacity)+" )"}else{if(!isIE&&typeof a.opacity!="undefined"){this.div.style.MozOpacity=parseInt(a.opacity)/100}}this.relyMarker=null;this.setOverlayId=function(g){this.div.id="mk_label_"+g};this.setContextMenu=function(g){};this.initialize=function(g){this.relyMarker=g};this.update=function(g,j,i){if(this.div.parentNode!=g.layerDrawMap.div&&!this.relyMarker.isMousemove){this.div.innerHTML=this.label;g.layerDrawMap.appendChild(this.div)}if(this.xoffset==null){this.xoffset=this.relyMarker.icon.width}if(this.yoffset==null){this.yoffset=this.relyMarker.icon.height/2-this.div.offsetHeight/2}if(!d){this.div.style.display=this.visible?"":"none";d=true}this.div.style.left=(parseInt(j)+this.xoffset)+"px";this.div.style.top=(parseInt(i)+this.yoffset)+"px"};this.finalize=function(){this.remove(true)};this.remove=function(g){if(typeof g!="boolean"){g=false}if(this.div){if(!g){if(this.div.parentNode){this.div.parentNode.removeChild(this.div)}}else{removeNode(this.div);this.div=null}}if(g){this.relyMarker=null}};this.toString=function(){return"com.mapbar.maplet.MLabel"};this.zIndex=this.div.style.zIndex;this.setZIndex=function(g){if(this.div&&this.div.parentNode&&g!=this.div.style.zIndex){this.zIndex=this.div.style.zIndex;this.div.style.zIndex=g}};this.resetZIndex=function(){if(!this.div){return}if(this.zIndex!=this.div.style.zIndex){this.setZIndex(this.zIndex)}};this.setVisible=function(g){if(g!=(this.div.style.display=="none"?false:true)){this.div.style.display=g?"":"none";this.visible=g}};this.resetLabel=function(g){if(typeof g!="object"||!g){return}var j=parseInt(this.div.style.left);var i=parseInt(this.div.style.top);if(typeof g.content=="string"){this.label=g.content;this.div.innerHTML=this.label}if(typeof g.enableStyle=="boolean"){this.div.className=g.enableStyle?"tiplabel":""}if("number,string".indexOf(typeof g.xoffset)!=-1){this.xoffset=parseInt(g.xoffset)}else{if(typeof g.xoffset=="object"&&g.xoffset==null){this.xoffset=null}}if("number,string".indexOf(typeof g.yoffset)!=-1){this.yoffset=parseInt(g.yoffset)}else{if(typeof g.yoffset=="object"&&g.yoffset==null){this.yoffset=null}}if("number,string".indexOf(typeof g.opacity)!=-1){if(isIE&&typeof g.opacity!="undefined"){this.div.style.filter="alpha( opacity = "+parseInt(g.opacity)+" )"}else{if(!isIE&&typeof g.opacity!="undefined"){this.div.style.MozOpacity=parseInt(g.opacity)/100}}}this.update(this.relyMarker.maplet,this.relyMarker.icon.left,this.relyMarker.icon.top)};this.getText=function(){var i="";if(this.label.indexOf(Maplet.MLABEL_TEXT_FLAG)!=-1){var j=new RegExp(Maplet.MLABEL_TEXT_FLAG+'="?([^"\t ]*)',"gi");var g=j.exec(this.label);if(g!=null){i=g[1]}}else{if(this.label!=""){i=filterMLabel(this.label)}else{i=this.label}}return i}};var MInfoWindow=function(f,d,c,e){this.title=f;this.content=filterHtml(d,true);this.eventType=(typeof c!="undefined"&&"mouseover"==c.toLowerCase())?"mouseover":"click";this.E9H={RHb:false,width:0,height:0};this.onOpenInfoWindow=function(g,j){MEvent.trigger(this.getOverlay(),"iw_beforeopen",this.getOverlay(),g,j);if(this.getOverlay().maplet.customInfoWindow){return null}avBubble.overlay=this.getOverlay();var i=getInfoWindowHtml(this.title,g,j,this.content,e);this.setTabs(b);return i};var a=null;this.setOverlay=function(g){a=g};this.getOverlay=function(){return a};this.toString=function(){return"com.mapbar.maplet.MInfoWindow"};this.setTitle=function(j,g,i){this.title=j;if(ContentInfo){ContentInfo.setTitle(j);this.E9H.RHb=false;if(typeof g!="boolean"){g=true}if(typeof i!="boolean"){i=false}if(g){c_07(i)}}};this.setContent=function(j,g,i){this.content=filterHtml(j,true);if(ContentInfo){ContentInfo.setContent(j);this.E9H.RHb=false;if(typeof g!="boolean"){g=true}if(typeof i!="boolean"){i=true}if(g){c_07(i)}}};this.zoomTo=function(j,g,i){if(j=="zoomin"){this.zoomIn(g,i)}else{if(j=="zoomout"){this.zoomOut(g,i)}}};this.zoomOut=function(g,i){if(ContentInfo&&typeof ContentInfo.onZoomOut=="function"){ContentInfo.onZoomOut(g,i)}};this.zoomIn=function(g,i){if(ContentInfo&&typeof ContentInfo.onZoomIn=="function"){ContentInfo.onZoomIn(g,i)}};this.getBodySize=function(){var g={width:0,height:0};if(ContentInfo){return ContentInfo.getShadowWrapperSize()}return g};this.setZMBtnVisible=function(g){if(ContentInfo){ContentInfo.setZMBtnVisible(visibimgHeight)}else{avBubble.O108=g}};this.getZMBtnVisible=function(){return ContentInfo&&ContentInfo.getZMBtnVisible()};var b=[];this.setTabs=function(j){if(isArray(j)){b=j}if(ContentInfo&&ContentInfo.isVisible()&&(a&&avBubble.overlay.id==a.id)&&b.length>0){for(var g=0;g<j.length;g++){ContentInfo.D_6q(j[g].clone())}this.E9H.RHb=false;c_07()}};this.getTabs=function(){return b};this.clearTabs=function(){b=[];if(ContentInfo&&ContentInfo.isVisible()){ContentInfo.N4y();if(a&&avBubble.overlay.id==a.id){this.E9H.RHb=false;c_07()}}};this.setCurrentTab=function(g){if(ContentInfo){ContentInfo.setCurrentTab(g)}};this.getCurrentTab=function(){if(ContentInfo&&ContentInfo.tabIndex!=-1){return ContentInfo.tab[ContentInfo.tabIndex]}else{return null}}};var ContentInfo=null;var getInfoWindowHtml=function(title,left,top,content){hideBubble(maplet);avBubble.calcLatLon();if(ContentInfo==null){ContentInfo=new InfoWindowHtml(maplet);ContentInfo.initialize();ContentInfo.onClosed=function(){avBubble.isMapDrag=false;avBubble.isAutoAdjust=false;avBubble.C62d=false;MEvent.trigger(maplet,"iw_hide",avBubble.overlay);maplet.viewOverlay(avBubble.overlay,50,50)};ContentInfo.onZoomOut=function(w,h){MEvent.trigger(avBubble.overlay,"bubble_zoomout",avBubble.overlay);var size={width:avBubble.width,height:avBubble.height};if(avBubble.overlay.info&&avBubble.overlay.info.E9H.width>0){size=avBubble.overlay.info.E9H}if(w){if(w<avBubble.minWidth){w=avBubble.minWidth}size.width=w}if(h){if(h<avBubble.minHeight){h=avBubble.minHeight}size.height=h}ContentInfo.width=size.width;ContentInfo.height=size.height;ContentInfo.showZmBtnByType("zoomin");avBubble.EcjTX=true;var M3i=maplet.viewOverlay(avBubble.overlay,50,50);if(M3i.s0_3==0&&M3i.cnA==0){maplet.refresh()}avBubble.C62d=false;avBubble.$2L="out"};ContentInfo.onZoomIn=function(w,h){var overlay=avBubble.overlay;MEvent.trigger(overlay,"bubble_zoomin",avBubble.overlay);w=filter2Num(w,null);h=filter2Num(h,null);var c7=maplet.I$mt();if(w&&w<c7.width){c7.width=w}if(h&&h<c7.height){c7.height=h}var T2V8=0;var NM0=0;if(typeof overlay=="object"&&overlay){if(overlay.toString().indexOf("MMarker")!=-1){if(overlay.icon){T2V8=overlay.icon.height;NM0=overlay.icon.width;c7.height-=T2V8;c7.width-=NM0}}else{T2V8=50;c7.height-=T2V8}}var centerXY=maplet.toScreenCoordinate(avBubble._Tov1);var infoOpt=ContentInfo.getInfoOpt(centerXY[0],centerXY[1],c7.width,c7.height,"top",true,true,overlay);avBubble.C7pDD=infoOpt.infoDir;avBubble.left=infoOpt.infoLeft;avBubble.top=infoOpt.infoTop;avBubble.EcjTX=true;ContentInfo.show(infoOpt,null);ContentInfo.showZmBtnByType("zoomout");var qx=infoOpt.infoLeft;var qz=infoOpt.infoTop;var N33=qx+infoOpt.width;var oBsQ5=qz+infoOpt.height;with(infoOpt.arrow){if(dir=="left"){qx=qx-NM0-infoOpt.arrow.width}else{if(dir=="right"){N33=N33+NM0+infoOpt.arrow.width}else{if(dir=="top"){qz=qz-T2V8-infoOpt.arrow.height}else{if(dir=="bottom"){oBsQ5=oBsQ5+T2V8+infoOpt.arrow.height}}}}}maplet.OaB({RE6:qx,I6036:qz,Ch9Y4:N33,fU4U3:oBsQ5,jfS6F:10,t0aW:10},{isVerifyOverviewRectint:true,isVerifyControlRectint:true,rF3:false});avBubble.C62d=true;avBubble.$2L="in"}}else{}avBubble.isMapDrag=false;avBubble.isAutoAdjust=false;ContentInfo.N4y();var size={width:0,height:0};if(avBubble.overlay.info.E9H.RHb){size.width=avBubble.overlay.info.E9H.width;size.height=avBubble.overlay.info.E9H.height;ContentInfo.setTitle(title);ContentInfo.setContent(content)}else{size=ContentInfo.S52E7(title,content);if(size.width==0){size={width:avBubble.width,height:avBubble.height}}else{if(size.width<avBubble.minWidth){size.width=avBubble.minWidth}if(size.height<avBubble.minHeight){size.height=avBubble.minHeight}var XEYH=maplet.I$mt();if(size.width>XEYH.width){size.width=XEYH.width}if(size.height>XEYH.height){size.height=XEYH.height}}avBubble.overlay.info.E9H.width=size.width;avBubble.overlay.info.E9H.height=size.height;avBubble.overlay.info.E9H.RHb=true}var infoOpt=ContentInfo.getInfoOpt(left,top,size.width,size.height,avBubble.tipInitPlace,avBubble.isMapDrag,avBubble.isAutoAdjust,avBubble.overlay);avBubble.C7pDD=infoOpt.infoDir;avBubble.left=infoOpt.infoLeft;avBubble.top=infoOpt.infoTop;avBubble.head=title;avBubble.body=content;ContentInfo.show(infoOpt,avBubble.O108,true);if(maplet.doPaning){ContentInfo.setVisible(false);avBubble.s2DA=true}var NM0=0;var T2V8=0;if(infoOpt.isMMarker){avBubble._Tov1=avBubble.overlay.pt.getPid();if(avBubble.overlay.icon){NM0=avBubble.overlay.icon.width;T2V8=avBubble.overlay.icon.height}}else{avBubble._Tov1=maplet.toMapCoordinate(left,top)}if(avBubble.O108!=null){avBubble.O108=null}var qx=infoOpt.infoLeft;var qz=infoOpt.infoTop;var N33=qx+infoOpt.width;var oBsQ5=qz+infoOpt.height;with(infoOpt.arrow){if(dir=="left"){qx=qx-NM0-infoOpt.arrow.width}else{if(dir=="right"){N33=N33+NM0+infoOpt.arrow.width}else{if(dir=="top"){qz=qz-T2V8-infoOpt.arrow.height}else{if(dir=="bottom"){oBsQ5=oBsQ5+T2V8+infoOpt.arrow.height}}}}}maplet.OaB({RE6:qx,I6036:qz,Ch9Y4:N33,fU4U3:oBsQ5,jfS6F:10,t0aW:10});MEvent.trigger(avBubble.overlay,"iw_afteropen",avBubble.overlay);return ContentInfo.dom};function c_07(oOi){if(!ContentInfo||!ContentInfo.isVisible()){return}if(typeof oOi!="boolean"){oOi=false}var centerXY=maplet.toScreenCoordinate(avBubble._Tov1);var r=ContentInfo.getRect(false,false);if(oOi){var size=ContentInfo.S52E7(avBubble.overlay.info.title,avBubble.overlay.info.content);if(size.width==0){size={width:r.width,height:r.height}}else{if(size.width<avBubble.minWidth){size.width=avBubble.minWidth}if(size.height<avBubble.minHeight){size.height=avBubble.minHeight}var XEYH=maplet.I$mt();if(size.width>XEYH.width){size.width=XEYH.width}if(size.height>XEYH.height){size.height=XEYH.height}}avBubble.overlay.info.E9H.width=size.width;avBubble.overlay.info.E9H.height=size.height;r.width=size.width;r.height=size.height}var infoOpt=ContentInfo.getInfoOpt(centerXY[0],centerXY[1],r.width,r.height,avBubble.C7pDD,avBubble.isMapDrag,avBubble.isAutoAdjust,avBubble.overlay);ContentInfo.show(infoOpt,avBubble.O108,true);r=ContentInfo.getRect();if(!avBubble.C62d){avBubble.overlay.info.E9H.width=r.width;avBubble.overlay.info.E9H.height=r.height}var NM0=0;var T2V8=0;if(infoOpt.isMMarker&&avBubble.overlay.icon){NM0=avBubble.overlay.icon.width;T2V8=avBubble.overlay.icon.height}var qx=r.min.x;var qz=r.min.y;var N33=r.max.x;var oBsQ5=r.max.y;with(infoOpt.arrow){if(dir=="left"){qx=qx-NM0}else{if(dir=="right"){N33=N33+NM0}else{if(dir=="top"){qz=qz-T2V8}else{if(dir=="bottom"){oBsQ5=oBsQ5+T2V8}}}}}maplet.doPaning=false;maplet.OaB({RE6:qx,I6036:qz,Ch9Y4:N33,fU4U3:oBsQ5,jfS6F:10,t0aW:10})}function hideBubble(a){if(!ContentInfo){return}if(ContentInfo.isVisible()){ContentInfo.setVisible(false);MEvent.trigger(a,"iw_hide",avBubble.overlay)}if(typeof a!="undefined"&&a.contentInfo!=null){a.contentInfo=null;a.refresh()}else{if(document["mapbar-maplet"]!="undefined"&&document["mapbar-maplet"].contentInfo!=null){document["mapbar-maplet"].contentInfo=null;document["mapbar-maplet"].refresh()}}ContentInfo.showZmBtnByType("zoomin")}var MBubble=function(){this.latlon="";this.O108=false;this.left=0;this.top=0;this.head=new String();this.body=new String();this.width=260;this.height=240;this.overlay=null;this.arrow_tip_xoffset=27;this.arrow_tip_yoffset=3;this.xoffset=0;this._Tov1="";this.tipInitPlace="top";this.C7pDD="auto";this.isMapDrag=false;this.isAutoAdjust=false;this.$49=true;this.s2DA=false;this.$AHEx="";this.KL9ut="";this.EcjTX=false;this.$2L="";this.minWidth=100;this.minHeight=60;this.e32nn=true;this.C62d=false;this.setHead=function(a){this.head=a};this.setBody=function(a){this.body=a};this.gl=function(){};this.calcLatLon=function(){this.latlon=maplet.toMapCoordinate(this.left,this.top)};this.syncContentInfoPosition=function(){if(ContentInfo){this.left=ContentInfo.q3;this.top=ContentInfo.zt}};this.followOverlay=function(){if(ContentInfo){if(!isIE){ContentInfo.setContentOverflow(false)}if(this._Tov1&&(this.s2DA||ContentInfo.isVisible())){if(this.s2DA){this.s2DA=false}if(this.$49){var b=maplet.toScreenCoordinate(this._Tov1);avBubble.isMapDrag=true;var a=ContentInfo.getInfoOpt(b[0],b[1],ContentInfo.width,ContentInfo.height,avBubble.C7pDD,avBubble.isMapDrag,this.isAutoAdjust,avBubble.overlay,false,false);this.C7pDD=a.infoDir;ContentInfo.show(a,null,this.EcjTX);if(this.EcjTX){this.EcjTX=false}if(this.$2L!=""&&this.overlay){MEvent.trigger(this.overlay,"bubble_zoomend",this.$2L=="in"?"out":"in");if(this.overlay.info){MEvent.trigger(maplet,"iw_zoomend",this.overlay.info,this.$2L=="in"?"zoomin":"zoomout")}if(this.$2L=="in"){this.isMapDrag=true;this.isAutoAdjust=true}else{this.isMapDrag=false;this.isAutoAdjust=false}this.$2L=""}}else{this.$49=true}}}};this.toString=function(){return"com.mapbar.maplet.MBubble"}};var avBubble=new MBubble();var MInfoWindowTab=function(c,e,a){var i=c;var b=e;var f=null;var g=0;var d=true;this.focus=typeof a!="boolean"?false:a;this.curTabIndex=-1;this.cacheEventBind=[];this.setVisible=function(j){d=j};this.getVisible=function(){return d};this.setIndex=function(j){g=j};this.getIndex=function(){return g};this.setLabel=function(j){i=j};this.getLabel=function(){return i};this.setContent=function(j){b=j};this.getContent=function(){return b};this.toString=function(){return"com.mapbar.maplet.MInfoWindowTab"};this.setTabNav=function(j){f=j};this.getTabNav=function(){return f};this.clone=function(){return new MInfoWindowTab(this.getLabel(),this.getContent(),this.focus)};this.scHo9=function(){f=null;d=false;curTabIndex=-1}};MInfoWindowTab.isTabInstant=function(a){return typeof a=="object"&&a&&typeof a.toString=="function"&&a.toString().indexOf("MInfoWindowTab")!=-1};var InfoWindowHtml=function(a){var b=a;this.x=0;this.y=0;this.width=0;this.height=0;this.content="";this.dom=null;this.titleTable=null;this.titleTd=null;this.titleZm=null;this.titleClose=null;this.tabUl=null;this.tabLiSpacer=null;this.tabNavLeft=null;this.tabNavRight=null;this.contentDiv=null;this.shadow=[];this.arrowDiv=null;this.shadowWrapper=null;this.arrowDirection="";this.tab=[];this.tabIndex=-1;this.tabHeight=0;this.tabNavClientHeight=0;this.tabLIClientHeight_=0;this.tabEndHeight=0;this.curTabIndex=0;this.infoTabObj=null;this.onZoomOut=null;this.onZoomIn=null;this.onClosed=null;this.titleCloseHandler=null;this.tabNavLeftClickHandler=null;this.tabNavRightClickHandler=null;this.ZM={type:"zoomin",handler:null};this.initialize=function(){this.dom=document.createElement("TABLE");this.dom.cellSpacing=0;this.dom.cellPadding=0;this.dom.border=0;this.dom.style.cssText=this.getParts("TIP_TABLE");this.dom.setAttribute(disableMw,true);var d=this.dom.insertRow(-1);var e=d.insertCell(-1);e.vAlign="top";e.style.cssText=this.getParts("TITLE_CONTAINER_TD");this.titleTable=this.buildTitleTable();e.appendChild(this.titleTable);e=this.dom.insertRow(-1).insertCell(-1);e.style.cssText=this.getParts("TAB_TD");this.tabUl=this.buildTabUl();this.tabUl.style.cssText=this.getParts("TAB_CONTAINER");e.appendChild(this.tabUl);this.tabUl.style.display="none";this.dom.rows[1].style.display="none";d=this.dom.insertRow(-1);e=d.insertCell(-1);e.vAlign="top";e.style.cssText=this.getParts("CONTENT_TD");this.contentDiv=this.buildContentDiv();e.appendChild(this.contentDiv);this.buildShadows();var c=b?b.mapContainer:document.body;c.appendChild(this.dom);c.appendChild(this.buildArrowDiv());for(var f=0;f<this.shadow.length;f++){c.appendChild(this.shadow[f])}c.appendChild(this.buildShadowWrapper())};this.buildShadowWrapper=function(){this.shadowWrapper=document.createElement("DIV");this.shadowWrapper.style.cssText=this.getParts("TIP_BORDER");return this.shadowWrapper};this.buildArrowDiv=function(){this.arrowDiv=document.createElement("DIV");this.arrowDiv.style.cssText=this.getParts("ARROW_DIV");return this.arrowDiv};this.buildContentDiv=function(){var c=document.createElement("DIV");c.style.cssText=this.getParts("CONTENT_DIV");return c};this.buildShadows=function(){if(this.dom){var d=this.getParts("SHADOW_AMOUNT");for(var c=0;c<d;c++){var e=document.createElement("DIV");e.id="_iw_shadow_"+c;e.style.cssText=this.getParts("SHADOW_DIV");e.setAttribute(_dragmap,"true");if(window.attachEvent){e.style.filter="alpha(opacity="+(this.getParts("SHADOW_OPACITY")[c]*100)+");"}else{e.style.opacity=this.getParts("SHADOW_OPACITY")[c]}e.style.zIndex=this.getParts("TIP_DEFAULT_INFO").zIndex-(c+1);e.onmousedown=function(){return false};this.shadow.push(e)}}};this.buildTabUl=function(){var c=document.createElement("UL");this.tabNavLeft=document.createElement("LI");this.tabNavLeft.style.cssText=this.getParts("TAB_NAV_L");this.tabLiSpacer=document.createElement("LI");this.tabLiSpacer.style.cssText=this.getParts("TAB_SPACER");this.tabNavRight=document.createElement("LI");this.tabNavRight.style.cssText=this.getParts("TAB_NAV_R");c.appendChild(this.tabNavLeft);c.appendChild(this.tabLiSpacer);c.appendChild(this.tabNavRight);return c};this.buildTitleTable=function(){var e=this.getParts("TITLE_INFO");var d=document.createElement("TABLE");d.width="100%";d.cellSpacing=0;d.cellPadding=0;d.border=0;d.style.cssText=this.getParts("TITLE_TABLE");var c=d.insertRow(-1);this.titleTd=c.insertCell(-1);this.titleTd.vAlign="top";this.titleTd.style.cssText=this.getParts("TITLE_TD");var f=c.insertCell(-1);f.style.cssText=this.getParts("TITLE_SPACER");f.innerHTML="&nbsp;";this.titleZm=c.insertCell(-1);this.titleZm.vAlign="top";this.titleZm.style.cssText=this.getParts("RT_BTN_TD");this.titleZm.innerHTML=this.getParts("ZOOMIN_IMG");this.titleZm.style.width="0px";this.bindZmClickEvent();this.titleClose=c.insertCell(-1);this.titleClose.vAlign="top";this.titleClose.style.cssText=this.getParts("RT_BTN_TD");this.titleClose.innerHTML=this.getParts("CLOSE_IMG");this.titleCloseHandler=MEvent.bindDom(this.titleClose,"click",this,this.onTitleClose);return d};this.getShadowWrapperSize=function(){return{width:this.shadowWrapper.offsetWidth,height:this.shadowWrapper.offsetHeight}};this.getRect=function(j,d){if(typeof j!="boolean"){j=true}if(typeof d!="boolean"){d=true}var g=j?this.shadowWrapper:this.dom;var c=filter2Num(this.dom.style.left);var i=filter2Num(this.dom.style.top);var f=c+this.dom.offsetWidth;var e=i+this.dom.offsetHeight;if(d){if(this.arrowDirection=="LEFT"){c=filter2Num(this.arrowDiv.style.left)}else{if(this.arrowDirection=="RIGHT"){f+=this.arrowDiv.offsetWidth}else{if(this.arrowDirection=="TOP"){i=filter2Num(this.arrowDiv.style.top)}else{if(this.arrowDirection=="BOTTOM"){e+=this.arrowDiv.offsetHeight}}}}}return{min:{x:c,y:i},max:{x:f,y:e},width:f-c,height:e-i}};this.S52E7=function(j,g){if(!this.dom){this.initialize()}var i=-100000;var f={infoLeft:i,infoTop:i,arrowLeft:i,arrowTop:i,width:avBubble.minWidth,height:avBubble.minHeight,arrow:{dir:"left"}};this.show(f,null,false);this.setTitle(j);this.setContent(g);var e=0;var d=0;var k=this.contentDiv.firstChild;if(k&&k.offsetWidth&&this.contentDiv.childNodes.length==1&&(_getStyle(k,"width")!="auto"||k.tagName=="IMG")){d=k.offsetWidth+filter2Num(_getStyle(k,"marginLeft","margin-left"))+filter2Num(_getStyle(k,"marginRight","margin-right"));e=k.offsetHeight+filter2Num(_getStyle(k,"marginTop","margin-top"))+filter2Num(_getStyle(k,"marginBottom","margin-bottom"));if(isIE){if(!isCss1Compat){d=d+filter2Num(_getStyle(this.contentDiv,"paddingLeft","padding-left"))*2;e=e+filter2Num(_getStyle(this.contentDiv,"paddingTop","padding-top"))*2}else{e+=1}}this.contentDiv.style.width=d+"px";this.contentDiv.style.height=e+"px";this.dom.style.width=this.contentDiv.offsetWidth+filter2Num(this.dom.style.borderWidth)*2+"px";e=this.dom.offsetHeight;d=this.dom.offsetWidth}this.setVisible(false);return{width:d,height:e}};this.getInfoOpt=function(j,n,c,e,r,q,W,Y,k,K){if(typeof c!="number"){c=this.getParts("TIP_DEFAULT_INFO").width}if(typeof e!="number"){e=this.getParts("TIP_DEFAULT_INFO").height}if(typeof r!="string"){r="auto"}if(typeof q!="boolean"){q=false}if(typeof W!="boolean"){W=false}if(typeof k!="boolean"){k=true}if(typeof K!="boolean"){K=true}var P=0;var E=0;var p=0;var f=0;var o="right";var M=0;var m=0;var u=false;var Z=false;if(b){var V=b.width;var g=b.height;var d=this.getParts("ARROW_INFO");var I=c+d.width4lr;var B=e+d.height4tb;var G=c/2;var l=e/2;var O=0;var N=0;if(typeof Y=="object"&&Y){var S=Y.toString();u=S.indexOf("MMarker")!=-1;Z=S.indexOf("MPolyline")!=-1}if(u&&Y.icon){O=Y.icon.width/2;N=Y.icon.height/2;j=j-Y.icon.anchorX+O;n=n-Y.icon.anchorY+N}if(W){E=n-l;P=j-G}else{if(n-l<=0){E=5}else{if(n+l>g){E=g-e-5}else{E=n-l}}if(j-G<=0){P=5}else{if(j+G>V){P=V-c-5}else{P=j-G}}}var X=false;var D=false;var T=false;var L=false;var F={min:{x:0,y:0},max:{x:0,y:0}};var J=b.getControlCanvasRect();var v=b.getOverviewRect();var i=j>=I&&n>=d.height4lr&&n+d.height4lr<=g;if(i){var R=j-O-d.width4lr;var C=R-c;if(!isNaN(parseInt(this.dom.style.borderRightWidth))){C+=parseInt(this.dom.style.borderRightWidth)}F={min:{x:C,y:E},max:{x:C+I,y:E+B}};if(k){i=!_isRectint(F,J)}if(K&&i){i=!_isRectint(F,v)}}var t=n>=B&&j>=d.width4tb&&j<=V-d.width4tb;if(t){var z=n-N-d.height4tb;var A=z-e;if(!isNaN(parseInt(this.dom.style.borderBottomWidth))){A+=parseInt(this.dom.style.borderBottomWidth)}F={min:{x:P,y:A},max:{x:P+I,y:A+B}};if(k){t=!_isRectint(F,J)}if(K&&t){t=!_isRectint(F,v)}}var Q=V-j>=I&&n>=d.height4lr&&n+d.height4lr<=g;if(Q){var R=j+O;var C=R+d.width4lr;if(!isNaN(parseInt(this.dom.style.borderLeftWidth))){C-=parseInt(this.dom.style.borderLeftWidth)}F={min:{x:C,y:E},max:{x:C+I,y:E+B}};if(k){Q=!_isRectint(F,J)}if(K&&Q){Q=!_isRectint(F,v)}}var H=g-n>=B&&j>=d.width4tb&&j<=V-d.width4tb;if(H){var z=n+N;var A=z+d.height4tb;if(!isNaN(parseInt(this.dom.style.borderTopWidth))){A-=parseInt(this.dom.style.borderTopWidth)}F={min:{x:P,y:A},max:{x:P+I,y:A+B}};if(k){H=!_isRectint(F,J)}if(K&&H){H=!_isRectint(F,v)}}if(r!="auto"){if(q){if(r=="left"){X=true}else{if(r=="top"){D=true}else{if(r=="right"){T=true}else{if(r=="bottom"){L=true}}}}}else{if(r=="left"&&i){X=true}else{if(r=="top"&&t){D=true}else{if(r=="right"&&Q){T=true}else{if(r=="bottom"&&H){L=true}else{r="auto"}}}}}}if(r=="auto"){X=i;D=t;T=Q;L=H}var U="";if(X){U="left";p=j-O-d.width4lr;f=n-d.height4lr/2;P=p-c;if(!isNaN(parseInt(this.dom.style.borderRightWidth))){P+=parseInt(this.dom.style.borderRightWidth)}if(f<E+5){E=f-5}else{if(f+d.height4lr>=E+e-5){E=f-e+d.height4lr+5}}}else{if(T){U="right";o="left";p=j+O;f=n-d.height4lr/2;P=p+d.width4lr;if(!isNaN(parseInt(this.dom.style.borderLeftWidth))){P-=parseInt(this.dom.style.borderLeftWidth)}if(f<E+5){E=f-5}else{if(f+d.height4lr>=E+e-5){E=f-e+d.height4lr+5}}}else{if(D||(!T&&!D&&!X&&!L)){U="top";o="bottom";p=j-d.width4tb/2;f=n-N-d.height4tb;E=f-e;if((!T&&!D&&!X&&!L)){if(P==5||(P==V-c-5)){P=j-G}}if(!isNaN(parseInt(this.dom.style.borderBottomWidth))){E+=parseInt(this.dom.style.borderBottomWidth)}if(p<P+5){P=p-5}else{if(p+d.width4tb>=P+c-5){P=p-c+d.width4tb+5}}}else{if(L){U="bottom";o="top";p=j-d.width4tb/2;f=n+N;E=f+d.height4tb;if(!isNaN(parseInt(this.dom.style.borderTopWidth))){E-=parseInt(this.dom.style.borderTopWidth)}if(p<P+5){P=p-5}else{if(p+d.width4tb>=P+c-5){P=p-c+d.width4tb+5}}}}}}if(U=="left"||U=="right"){M=d.width4lr;m=d.height4lr}else{M=d.width4tb;m=d.height4tb}}return{infoLeft:P,infoTop:E,arrowLeft:p,arrowTop:f,width:c,height:e,infoDir:U,arrow:{dir:o,width:M,height:m},isMMarker:u,isMPolyline:Z}};this.show=function(d,c,e){this.x=d.infoLeft;this.y=d.infoTop;this.width=d.width;this.height=d.height;if(!this.dom){this.initialize()}this.dom.style.left=this.x+"px";this.dom.style.top=this.y+"px";this.dom.style.width=this.width+"px";this.dom.style.height=this.height+"px";this.contentDiv.style.width="1px";this.contentDiv.style.height="1px";this.setVisible(true);if(typeof c=="boolean"){this.setZMBtnVisible(c)}this.setArrowDirection(d.arrowLeft,d.arrowTop,d.arrow.dir);this.setPosition(e)};this.setArrowDirection=function(i,g,f){f=f.toUpperCase();this.arrowDirection=f;var e="";var j=this.getParts("ARROW_INFO");e=this.getParts("ARROW_"+f+"_CHILD");var d=j.width4lr;var c=j.height4lr;if(f=="TOP"||f=="BOTTOM"){d=j.width4tb;c=j.height4tb}this.arrowDiv.innerHTML=e;this.arrowDiv.style.left=i+"px";this.arrowDiv.style.top=g+"px";this.arrowDiv.style.width=d+"px";this.arrowDiv.style.height=c+"px";this.arrowDiv.style.display=""};this.hideArrowDiv=function(){this.arrowDiv.style.display="none"};this.setPosition=function(j){if(!this.isVisible()){return}var g=this.titleTable.offsetHeight;if(!isNaN(parseInt(this.titleTable.style.marginTop))){g+=parseInt(this.titleTable.style.marginTop)}if(!isNaN(parseInt(this.titleTable.style.marginBottom))){g+=parseInt(this.titleTable.style.marginBottom)}var f=this.dom.offsetHeight-g-this.tabHeight;if(isCss1Compat||isFirefox||isChrome||isSafari){if(!isNaN(parseInt(this.contentDiv.style.paddingTop))){f-=filter2Num(this.contentDiv.style.paddingTop)}if(!isNaN(parseInt(this.contentDiv.style.paddingBottom))){f-=filter2Num(this.contentDiv.style.paddingBottom)}}if(!isNaN(parseInt(this.dom.style.borderTopWidth))){f-=parseInt(this.dom.style.borderTopWidth)}if(!isNaN(parseInt(this.dom.style.borderBottomWidth))){f-=parseInt(this.dom.style.borderBottomWidth)}var d=this.dom.offsetWidth;if(isCss1Compat||isChrome||isSafari||isFirefox){if(!isNaN(parseInt(this.contentDiv.style.paddingLeft))){d-=parseInt(this.contentDiv.style.paddingLeft)}if(!isNaN(parseInt(this.contentDiv.style.paddingRight))){d-=parseInt(this.contentDiv.style.paddingRight)}}d=d-filter2Num(this.dom.style.borderWidth)*2;if(isIE){this.contentDiv.style.overflow="hidden";this.contentDiv.style.overflow="auto"}this.contentDiv.style.height=f+"px";this.contentDiv.style.width=d+"px";if(this.contentDiv.scrollWidth>this.contentDiv.offsetWidth){if(!isNaN(parseInt(this.dom.style.borderLeftWidth))){d-=parseInt(this.dom.style.borderLeftWidth)}if(!isNaN(parseInt(this.dom.style.borderRightWidth))){d-=parseInt(this.dom.style.borderRightWidth)}this.contentDiv.style.width=d+"px"}if(typeof j!="boolean"){j=true}if(this.tab.length>0&&j){this.setTabNavs();this.setTabNavFinal();var c=this.tabIndex;this.tabIndex=-1;if(c!=-1){if(!this.tab[c].getVisible()){this.setCurrentTab(0)}else{this.setCurrentTab(c)}}}for(var e=0;e<this.shadow.length;e++){var k=this.shadow[e];k.style.left=(this.x+3+((e)*3))+"px";k.style.top=(this.y+3+((e)*3))+"px";k.style.width=this.width+"px";k.style.height=this.height+"px";k.style.display=""}this.shadowWrapper.style.width=this.width+2+"px";this.shadowWrapper.style.height=this.height+2+"px";this.shadowWrapper.style.left=this.x-1+"px";this.shadowWrapper.style.top=this.y-1+"px"};this.getInfoDom=function(){return this.dom};this.D_6q=function(c){if(!this.getInfoDom()){return}if(this.tab.length>=this.getParts("TAB_AMOUNT")){return false}if(MInfoWindowTab.isTabInstant(c)){if(this.tab.length==0){var d=[];if(this.content!=""){d.push(new MInfoWindowTab(this.getParts("TAB_DEFAULT_LABEL"),this.content,!c.focus));this.contentDiv.innerHTML=""}if(d.length==0&&!c.focus){c.focus=true}d.push(c);this.showTab(d)}else{this.addAnTab(c,-1)}}};this.N4y=function(){if(!this.getInfoDom()){return}if(this.tab.length>0){var d=this.tab;for(var c=d.length-1;c>=0;c--){this.setCurTabByIndex(c,false)}this.tab=[]}};this.resetIt=function(){this.tabIndex=-1;this.curTabIndex=0;this.infoTabObj=null};this.setCurTabByIndex=function(m,f){if(!this.getInfoDom()){return}if(this.tabUl&&this.tab.length>m){if(typeof f!="boolean"){f=true}var g=[];var l=null;var e=this.tabIndex;this.tabIndex=-1;var d=0;for(var j=0;j<this.tab.length;j++){if(j!=m){var k=this.tab[j];var c=k.getIndex();g.push(k);k.setIndex(g.length-1);var n=k.getTabNav();if(n){n.setAttribute("tabIndex",k.getIndex())}if(c==e){d=k.getIndex()}}else{l=this.tab[j]}}if(l){this.tab=g;var n=l.getTabNav();if(l.cacheEventBind.length>0){for(var j=0;j<l.cacheEventBind.length;j++){var o=l.cacheEventBind[j];MEvent.removeBuiltInListener(n,o.event,o.q9)}}if(n){this.tabUl.removeChild(n)}}this.setTabNavs();this.setTabNavFinal();if(this.tab.length>d&&!this.tab[d].getVisible()){d=0}if(f){this.setCurrentTab(d)}if(this.tab.length==0){this.hideTab()}}};this.hideTab=function(){this.tabHeight=0;this.dom.rows[1].style.display="none";this.resetIt();if(this.content){this.setContent(this.content)}this.setPosition()};this.addAnTab=function(c,m){if(!MInfoWindowTab.isTabInstant(c)){return false}var f=this.tab.length;var k=this.tabLiSpacer;if(!MInfoWindowTab.isTabInstant(m)||!m.getTabNav()){m=null}if(m){k=m.getTabNav();var j=this.tabIndex==m.getIndex();var d=[];for(var e=0;e<this.tab.length;e++){var l=this.tab[e];if(l==m){d.push(c);c.setIndex(d.length-1)}d.push(l);l.setIndex(d.length-1);var g=l.getTabNav();if(g){g.setAttribute("tabIndex",l.getIndex())}}if(j){this.tabIndex=m.getIndex()}this.tab=d}else{this.tab.push(c);c.setIndex(this.tab.length-1)}var g=this.buildTabNav(c,k);if(isNaN(parseInt(this.tabUl.style.height))){this.tabUl.style.height=parseInt(this.tabUl.parentNode.clientHeight)+"px"}if(c.focus){this.setCurrentTab(c.getIndex())}this.setTabNavFinal()};this.buildTabNav=function(c,e){var d=document.createElement("LI");d.innerHTML=c.getLabel();d.style.cssText=this.getParts("TAB_TEXT_BLUR");d.setAttribute("tabIndex",c.getIndex());c.setTabNav(d);this.tabUl.insertBefore(d,e);c.cacheEventBind.push({event:"click",q9:MEvent.bindDom(d,"click",this,tabNavClick)});if(this.tab.length==1){if(this.tabNavClientHeight==0){this.tabNavClientHeight=d.clientHeight;if(parseInt(d.style.paddingTop)){this.tabNavClientHeight-=parseInt(d.style.paddingTop)}if(parseInt(d.style.paddingBottom)){this.tabNavClientHeight-=parseInt(d.style.paddingBottom)}}if(this.tabLIClientHeight_==0){this.tabLIClientHeight_=d.clientHeight}}return d};this.setTabNavFinal=function(){var m=this.tab;this.showTabNavLeftArrow(true);this.showTabNavRightArrow(true);var g=this.tabNavLeft.firstChild.offsetWidth;var f=this.tabNavRight.firstChild.offsetWidth;var c=null;var k=null;for(var j=m.length-1;j>=0;j--){k=m[j];if(k.getVisible()){var l=k.getTabNav();if(l){var n=l.clientWidth;if(l.offsetTop>=l.offsetHeight*2-5){o=0}else{var o=this.getTabUlRemainWidth(true);if(l.offsetTop==0){o+=n}else{if(l.offsetLeft!=0){o=0}}}if(n>=o){if(o<=20){this.setTabNav(k,false);o=0}else{o=o-parseInt(l.style.paddingLeft)-parseInt(l.style.paddingRight);l.style.width=o+"px";c=k}}else{c=k}if(o!=0){break}}}}this.showTabNavLeftArrow(false);this.showTabNavRightArrow(false);if(m.length>0){this.showTabNavLeftArrow(!m[0].getVisible());this.showTabNavRightArrow(!m[m.length-1].getVisible())}if(c&&c.getTabNav()){this.infoTabObj=c;var e=c.getTabNav();var d=e.clientWidth;if(!isNaN(parseInt(e.style.paddingLeft))){d-=parseInt(e.style.paddingLeft)}if(!isNaN(parseInt(e.style.paddingRight))){d-=parseInt(e.style.paddingRight)}if(!this.hasTabNavLeftWidth()){d+=g}if(!this.hasTabNavRightWidth()){d+=f}if(this.tabIndex==c.getIndex()){d-=2}e.style.width=d+"px"}for(var j=0;j<m.length;j++){k=m[j];if(k.getVisible()){k.curTabIndex=this.curTabIndex;if(k.getTabNav()){k.getTabNav().style.height=this.tabNavClientHeight+"px"}}}this.setTabNavSpacer()};this.setTabNav=function(c,e){var d=c.getTabNav();if(d){if(e){d.style.cssText=this.getParts("TAB_TEXT_BLUR")}else{d.style.width="0px";d.style.padding="0px"}c.setVisible(e)}};this.setTabNavs=function(){var d=this.tab;for(var c=0;c<d.length;c++){this.setTabNav(d[c],true)}};this.showTabNavRightArrow=function(c){if(!this.tabNavRightClickHandler){this.tabNavRightClickHandler=MEvent.bindDom(this.tabNavRight,"click",this,this.tabRightArrowClick)}if(c){this.tabNavRight.innerHTML=this.getParts("TAB_NAV_R_CHILD");this.tabNavRight.style.cursor="pointer";this.tabNavRight.style.width=this.getParts("TAB_NAV_INFO").width+"px"}else{this.tabNavRight.innerHTML="";this.tabNavRight.style.cursor="";this.tabNavRight.style.width="0px"}};this.showTabNavLeftArrow=function(c){if(!this.tabNavLeftClickHandler){this.tabNavLeftClickHandler=MEvent.bindDom(this.tabNavLeft,"click",this,this.tabLeftArrowClick)}if(c){this.tabNavLeft.innerHTML=this.getParts("TAB_NAV_L_CHILD");this.tabNavLeft.style.cursor="pointer";this.tabNavLeft.style.width=this.getParts("TAB_NAV_INFO").width+"px"}else{this.tabNavLeft.innerHTML="";this.tabNavLeft.style.cursor="";this.tabNavLeft.style.width="0px"}};this.setTabNavSpacer=function(){var c=this.getTabUlRemainWidth(false);if(c<0){c=0}this.tabLiSpacer.style.width=c+"px";this.tabLiSpacer.style.height=this.tabLIClientHeight_+"px"};this.hasTabNavLeftWidth=function(){if(this.tabNavLeft.firstChild){return this.tabNavLeft.firstChild.offsetWidth>0}else{return false}};this.hasTabNavRightWidth=function(){if(this.tabNavRight.firstChild){return this.tabNavRight.firstChild.offsetWidth>0}else{return false}};this.getTabUlRemainWidth=function(){var g=0;if(this.tabUl){if(this.tab.length>0){var f=this.tab;var c=null;var d=null;for(var e=f.length-1;e>=0;e--){c=f[e];d=c.getTabNav();if(d&&d.offsetTop==this.tabNavLeft.offsetTop){break}}if(d){if(c.getIndex()==0&&d.offsetTop!=this.tabNavLeft.offsetTop){d=this.tabNavLeft}g=this.tabUl.parentNode.offsetWidth-d.offsetLeft-d.offsetWidth-this.tabNavRight.offsetWidth}}}return g};this.showTab=function(e){if(this.tabUl&&e.length>0){if(this.dom.rows[1].style.display=="none"){this.dom.rows[1].style.display=""}if(this.tabUl.style.display=="none"){this.tabUl.style.display=""}for(var d=0;d<e.length;d++){this.addAnTab(e[d])}this.setTabEndLiHeight();var c=this.dom.rows[1].clientHeight;if(!isNaN(parseInt(this.dom.rows[1].style.paddingTop))){c-=parseInt(this.dom.rows[1].style.paddingTop)}if(!isNaN(parseInt(this.dom.rows[1].style.paddingBottom))){c-=parseInt(this.dom.rows[1].style.paddingBottom)}this.dom.rows[1].style.height=c+"px";this.tabHeight=c;this.setPosition()}};this.setTabEndLiHeight=function(){if(this.tabEndHeight==0){var d=this.tab[0].getTabNav();var c=this.tabIndex==0?parseInt(d.style.borderTopWidth):parseInt(d.style.borderBottomWidth);if(isNaN(c)){c=0}this.tabEndHeight=d.offsetHeight-parseInt(d.style.paddingTop)-c}this.tabNavLeft.style.height=this.tabEndHeight+"px";this.tabNavLeft.style.lineHeight=this.tabEndHeight+"px";this.tabNavRight.style.height=this.tabEndHeight+"px";this.tabNavRight.style.lineHeight=this.tabEndHeight+"px"};this.setTabNavBlur=function(c){if(!c.getVisible()){return}var d=c.getTabNav();if(d){var e={width:d.style.width,height:d.style.height};d.style.cssText=this.getParts("TAB_TEXT_BLUR");d.style.width=e.width;d.style.height=e.height;this.tabIndex=-1}};this.setTabNavFocus=function(c){var d=c.getTabNav();if(d){var e={width:d.style.width,height:d.style.height};d.style.cssText=this.getParts("TAB_TEXT_FOCUS");d.style.width=e.width;d.style.height=e.height;this.tabIndex=c.getIndex();var f=c.getContent();if(typeof f=="string"){this.contentDiv.innerHTML=f}else{if(typeof f=="object"&&typeof f.tagName!="undefined"){this.contentDiv.innerHTML="";this.contentDiv.appendChild(f)}}}};this.setCurrentTab=function(e){var g=this.tab;if(this.tabIndex==e||g.length<=0||e<0||e>=g.length){return}if(this.tabIndex!=-1){this.setTabNavBlur(this.tab[this.tabIndex])}var d=g[e];if(!d.getVisible()){if(d.curTabIndex!=-1){this.curTabIndex=d.curTabIndex;for(var f=0;f<g.length;f++){var c=g[f];if(c.curTabIndex==d.curTabIndex){this.setTabNav(c,true)}else{this.setTabNav(c,false)}}this.setTabNavFinal()}else{while(!d.getVisible()){this.tabRightArrowClick(null)}}}if(d.getVisible()){this.setTabNavFocus(d)}};this.tabLeftArrowClick=function(d){if(!this.hasTabNavLeftWidth()){return}this.curTabIndex--;var f=this.tab;var g=null;if(this.tabIndex!=-1){this.setTabNavBlur(this.tab[this.tabIndex])}for(var e=f.length-1;e>=0;e--){var c=f[e];if(c.curTabIndex==this.curTabIndex){this.setTabNav(c,true);g=c}else{this.setTabNav(c,false)}}this.setTabNavFinal();this.setCurrentTab(g.getIndex())};this.tabRightArrowClick=function(d){if(!this.hasTabNavRightWidth()){return}this.curTabIndex++;var f=this.tab;var g=null;if(this.tabIndex!=-1){this.setTabNavBlur(this.tab[this.tabIndex])}for(var e=0;e<f.length;e++){var c=f[e];if(c.getIndex()<=this.infoTabObj.getIndex()){if(c.getVisible()){this.setTabNav(c,false)}}else{if(!c.getVisible()){if(!g){g=c}this.setTabNav(c,true)}}}this.setTabNavFinal();if(g){this.setCurrentTab(g.getIndex())}};this.onTitleClose=function(c){c=fixEvent(c);if(c.target.tagName=="IMG"){this.setVisible(false);if(this.onClosed){this.onClosed()}}};this.setVisible=function(d){if(!this.dom){return}if(this.isVisible()==d){return}this.dom.style.display=d?"":"none";for(var c=0;c<this.shadow.length;c++){this.shadow[c].style.display=d?"":"none"}if(!d){this.hideArrowDiv()}this.shadowWrapper.style.display=d?"":"none"};this.isVisible=function(){return this.dom&&this.dom.style.display!="none"};this.setZMBtnVisible=function(c){if(this.getZMBtnVisible()==c){return}if(c){this.titleZm.style.width=this.getParts("RT_BTN_TD_INFO").width+"px"}else{this.titleZm.style.width="0px"}};this.getZMBtnVisible=function(){return this.titleZm&&parseInt(this.titleZm.style.width)!=0};tabNavClick=function(c){var d=c.target.getAttribute("tabIndex");if(d!=null){this.setCurrentTab(parseInt(d))}};this.showZmBtnByType=function(c){if(this.titleZm&&this.ZM.type!=c){this.ZM.type=c;if(this.ZM.type=="zoomin"){this.titleZm.innerHTML=this.getParts("ZOOMIN_IMG")}else{this.titleZm.innerHTML=this.getParts("ZOOMOUT_IMG")}this.bindZmClickEvent()}};this.bindZmClickEvent=function(){if(this.ZM.handler){MEvent.removeBuiltInListener(this.titleZm,"click",this.ZM.handler)}if(this.ZM.type=="zoomin"){this.ZM.handler=MEvent.bindDom(this.titleZm,"click",this,this.zoominMethod)}else{if(this.ZM.type=="zoomout"){this.ZM.handler=MEvent.bindDom(this.titleZm,"click",this,this.zoomoutMethod)}}};this.zoominMethod=function(c){c=fixEvent(c);if(c.target.tagName=="IMG"){if(this.onZoomIn){this.onZoomIn()}}};this.zoomoutMethod=function(c){c=fixEvent(c);if(c.target.tagName=="IMG"){if(this.onZoomOut){this.onZoomOut()}}};this.setTitle=function(c){if(this.titleTd){this.titleTd.innerHTML=c}};this.setContent=function(c){this.content=c;if(this.contentDiv){if(typeof c=="string"){this.contentDiv.innerHTML=c}else{if(typeof c=="object"&&typeof c.tagName!="undefined"){this.contentDiv.innerHTML="";this.contentDiv.appendChild(c)}}if(this.tab.length>0){this.tab[0].setContent(c)}}};this.g70S$=function(c,d){if(!this.getInfoDom()){return}this.width=c;this.height=d;if(this.dom){this.dom.style.width=c+"px";this.dom.style.height=d+"px";this.setPosition()}};this.moveTo=function(c,f){if(!this.getInfoDom()){return}this.x=c;this.y=f;this.dom.style.left=c+"px";this.dom.style.top=f+"px";for(var d=0;d<this.shadow.length;d++){var e=this.shadow[d];e.style.left=(this.x+3+((d)*3))+"px";e.style.top=(this.y+3+((d)*3))+"px"}};this.setContentOverflow=function(c){if(this.isVisible()){if((this.contentDiv.style.overflow=="hidden"?true:false)!=c){this.contentDiv.style.overflow=c?"hidden":"auto"}}};this.getParts=function(c){return InfoWindowHtml.parts.getParts(c)};this.setParts=function(c,d){InfoWindowHtml.parts.setParts(c,d)};this.finalize=function(){if(this.tabNavLeftClickHandler){MEvent.removeBuiltInListener(this.tabNavLeft,"click",this.tabNavLeftClickHandler)}if(this.tabNavRightClickHandler){MEvent.removeBuiltInListener(this.tabNavRight,"click",this.tabNavRightClickHandler)}if(this.titleCloseHandler){MEvent.removeBuiltInListener(this.titleClose,"click",this.titleCloseHandler)}}};InfoWindowHtml.parts=new function(){var b=[];var c=navigator.userAgent.split("(").toString().split(";")[1].indexOf("6")>0;b.TIP_DEFAULT_INFO={width:300,height:300,B8$g0:false,zIndex:100};b.COLOR="#81807f";b.TIP_TABLE_BORDER_COLOR="#0e347f";b.IMAGE_RESOURCE=CTLIMG_RESOURCE[0].url;b.IMAGE_RESOURCE_INFO={width:CTLIMG_RESOURCE[0].w,height:CTLIMG_RESOURCE[0].h};b.BLANK_IMG_SRC=strImgsvrUrl+"images/newbubbleimg/mbblank.gif";b.TIP_TABLE="position:absolute;border:2px solid "+b.TIP_TABLE_BORDER_COLOR+";background-color:#FFFFFF;display:none;spacing:10px;table-layout:fixed;overflow:hidden;z-index:"+b.TIP_DEFAULT_INFO.zIndex+";";b.TIP_BORDER="position:absolute;background:white;z-index:99;";b.TITLE_CONTAINER_TD="";b.TITLE_TABLE="table-layout:fixed;margin-bottom:5px;margin-top:4px;/*background-color:green;*/";b.TITLE_TD="white-space:nowrap;overflow:hidden;padding-left:4px;padding-top:2px;font-weight:bold;font-size:14px;";b.TITLE_SPACER="width:10px;-moz-user-select:none;-moz-user-focus:none;";var a=function(e,d,i,g,f){if(typeof f!="string"){f=""}var j='<div style="position:absolute;width:'+e+"px;height:"+d+"px;overflow:hidden;-moz-user-select:none;-moz-user-focus:none;"+f+'">';if(isIE){j+='<img src="'+b.BLANK_IMG_SRC+'" style="position:absolute;left:'+i+"px;top:"+g+"px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+b.IMAGE_RESOURCE+",sizingMethod=scale);width:"+b.IMAGE_RESOURCE_INFO.width+"px;height:"+b.IMAGE_RESOURCE_INFO.height+'px;">'}else{j+='<img src="'+b.IMAGE_RESOURCE+'" style="position:absolute;left:'+i+"px;top:"+g+'px;">'}j+="</div>";return j};b.RT_BTN_TD_INFO={width:18};b.RT_BTN_TD="width:"+b.RT_BTN_TD_INFO.width+"px";b.RT_BTN_IMG_INFO={width:12,height:12};b.CLOSE_IMG=a(b.RT_BTN_IMG_INFO.width,b.RT_BTN_IMG_INFO.height,-64,-51,"cursor:pointer;");b.ZOOMIN_IMG=a(b.RT_BTN_IMG_INFO.width,b.RT_BTN_IMG_INFO.height,-42,-51,"cursor:pointer;");b.ZOOMOUT_IMG=a(b.RT_BTN_IMG_INFO.width,b.RT_BTN_IMG_INFO.height,-53,-51,"cursor:pointer;");b.SHADOW_COLOR=b.COLOR;b.SHADOW_AMOUNT=2;b.SHADOW_OPACITY=[0.5,0.3];b.SHADOW_DIV="position:absolute;background-color:"+b.SHADOW_COLOR+";display:none;";b.TAB_AMOUNT=5;b.TAB_DEFAULT_LABEL="\u4e3b\u8981";b.TAB_TD="-moz-user-select:none;-moz-user-focus:none;";b.TAB_CONTAINER="list-style-type:none;margin:0px;padding:0px;overflow:hidden;";b.TAB_LINE="1px solid "+b.COLOR+";";b.TAB_TEXT_COMMON="float:left;cursor:pointer;white-space:nowrap;overflow:hidden;outline:none;font-size:12px;padding-bottom:4px;";b.TAB_TEXT_FOCUS=b.TAB_TEXT_COMMON+"border-top:"+b.TAB_LINE+";border-left:"+b.TAB_LINE+";border-right:"+b.TAB_LINE+";padding-top:5px;padding-left:4px;padding-right:4px;";b.TAB_TEXT_BLUR=b.TAB_TEXT_COMMON+"border-bottom:"+b.TAB_LINE+"padding-top:5px;padding-left:5px;padding-right:5px;";b.TAB_SPACER="float:left;border-bottom:"+b.TAB_LINE;b.TAB_NAV_INFO={width:10,height:10};b.TAB_NAV_LR_COMMON="float:left;padding-top:5px;padding-left:4px;padding-right:4px;border-bottom:"+b.TAB_LINE+";";b.TAB_NAV_L=b.TAB_NAV_LR_COMMON;b.TAB_NAV_R=b.TAB_NAV_LR_COMMON+"float:right;";b.TAB_NAV_L_CHILD=a(b.TAB_NAV_INFO.width,b.TAB_NAV_INFO.height,-66,-160);b.TAB_NAV_R_CHILD=a(b.TAB_NAV_INFO.width,b.TAB_NAV_INFO.height,-66,-148);b.CONTENT_TD="";b.CONTENT_DIV="padding:5px;width:100%;height:100%;overflow:auto;/*background-color:yellow;*/";b.ARROW_INFO={width4lr:15,height4lr:23,width4tb:23,height4tb:15,zIndex:b.TIP_DEFAULT_INFO.zIndex+1};b.ARROW_DIV="position:absolute;top:0px;left:0px;width:"+b.ARROW_INFO.width+"px;height:"+b.ARROW_INFO.height+"px;display:none;z-index:"+b.ARROW_INFO.zIndex+";-moz-user-select:none;-moz-user-focus:none;";b.ARROW_TOP_CHILD=a(b.ARROW_INFO.width4tb,b.ARROW_INFO.height4tb,-43,-177);b.ARROW_BOTTOM_CHILD=a(b.ARROW_INFO.width4tb,b.ARROW_INFO.height4tb,-43,-192);b.ARROW_LEFT_CHILD=a(b.ARROW_INFO.width4lr,b.ARROW_INFO.height4lr,-61,-124);b.ARROW_RIGHT_CHILD=a(b.ARROW_INFO.width4lr,b.ARROW_INFO.height4lr,-25,-178);this.setParts=function(d,e){if(typeof b[d]!="undefined"){b[d]=e}};this.getParts=function(d){return b[d]}};var MPanel=function(options){this.initialize=function(maplet){this.maplet=maplet;this.paint()};this.setLocation=function(options,paint){if(typeof paint!="boolean"){paint=true}this.location=options||{};with(this.location){if(typeof pt!="object"||!(pt instanceof MPoint)||!pt){this.location.pt=null}if(typeof type!="string"||!type||(type=="latlon"&&!pt)){this.location.type="xy"}if(typeof x!="number"){this.location.x=0}if(typeof y!="number"){this.location.y=0}if(type=="latlon"&&pt&&!pt.maplet&&this.maplet){pt.initialize(this.maplet)}}this.options.location=this.location;if(paint){this.paint()}};this.setContent=function(content){if(typeof content!="undefined"&&content){if(typeof content=="string"){this.dom.innerHTML=content}else{if(typeof content=="object"){this.dom.appendChild(content)}}}else{content=null;this.dom.innerHTML=""}this.options.content=content};this.setMouseWheel=function(enable){if(typeof enable!="boolean"){enable=true}if(this.dom){this.dom.setAttribute(disableMw,!enable)}this.options.mousewheel=enable};this.setZoomHide=function(hide){if(typeof hide!="boolean"){hide=false}this.options.zoomhide=hide};this.setCreator=function(creator){if(typeof creator!="number"||(creator!=MPanel.USER&&creator!=MPanel.SYSTEM)){creator=MPanel.USER}this.options.creator=creator};this.setPin=function(p,paint){if(typeof p!="boolean"){p=false}if(typeof paint!="boolean"){paint=true}this.options.pin=p;if(!p&&typeof this.location!="undefined"&&this.location.pt){this.location.type="xy";this.location.pt=null}if(paint){this.paint()}};this.setContainer=function(container){if(typeof container!="object"||!container){container=null}this.options.container=container};this.setZIndex=function(index){if(typeof index!="number"){index=this.options.pin?200:2}this.dom.style.zIndex=index;this.options.zindex=index};this.paint=function(){if(!this.dom||!this.maplet){return}if(this.options.container){if(this.dom.parentNode!=this.options.container){this.options.container.appendChild(this.dom)}}else{if(this.options.pin){if(this.dom.parentNode!=this.maplet.mapContainer.div){this.maplet.mapContainer.div.appendChild(this.dom)}}else{if(this.dom.parentNode!=this.maplet.panel){this.maplet.panel.appendChild(this.dom)}}}with(this.location){if(this.options.pin||type=="latlon"){if(typeof pt=="undefined"||!pt){pt=new MPoint(this.maplet.toMapCoordinate(x,y))}if(!pt.maplet){pt.initialize(this.maplet)}else{if(this.options.pin){if(this.maplet.Or5V$){if(this.maplet.lastStamp!=pt.lastStamp){pt.mapX+=this.maplet.deltaX;pt.mapY+=this.maplet.deltaY;pt.lastStamp=this.maplet.lastStamp}}else{pt.setMapXY()}}}x=pt.mapX;y=pt.mapY}this.dom.style.left=x+"px";this.dom.style.top=y+"px"}};this.show=function(){this.setVisible(true);this.V975J.FTK=false};this.hide=function(){this.setVisible(false);this.V975J.FTK=true};this.setVisible=function(visible){if(!this.dom){return}if(this.dom.style.display!=(visible?"":"none")){this.dom.style.display=visible?"":"none"}};this.isVisible=function(){return this.dom.style.display==""};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}if(this.dom){if(!finalize){if(this.dom.parentNode){this.dom.parentNode.removeChild(this.dom)}}else{removeNode(this.dom);this.dom=null}}this.maplet=null};this.clone=function(){return new MPanel({pin:this.options.pin,parent:this.options.parent,zindex:this.options.zindex,content:this.options.content,location:this.location,mousewheel:this.options.mousewheel,zoomhide:this.options.zoomhide,creator:this.options.creator})};this.toString=function(){return"com.mapbar.maplet.MPanel"};this.id="panel"+MPanel.amount;MPanel.amount++;this.maplet=null;this.dom=document.createElement("DIV");this.dom.style.position="absolute";this.V975J={FTK:false};this.options=options||{};with(this.options){this.setPin(typeof pin!="undefined"?pin:undefined,false);this.setContainer(typeof container!="undefined"?container:undefined);this.setZIndex(typeof zindex!="undefined"?zindex:undefined);this.setContent(typeof content!="undefined"?content:undefined);this.setLocation(typeof location!="undefined"?location:undefined,false);this.setMouseWheel(typeof mousewheel!="undefined"?mousewheel:undefined);this.setZoomHide(typeof zoomhide!="undefined"?zoomhide:undefined);this.setCreator(typeof creator!="undefined"?creator:undefined)}};MPanel.enableDragMap=function(c,a,b){if(typeof a!="boolean"){a=true}if(a){setDomAttrVal(c,_dragmap,"true",b)}else{removeDomAttr(c,_dragmap)}};MPanel.USER=1;MPanel.SYSTEM=2;MPanel.amount=0;var MLayer=function(options){this.initialize=function(maplet){this.maplet=maplet;this.paint()};this.setServerPath=function(path){if(typeof path!="string"||!path){path=""}this.options.serverPath=path};this.setZIndex=function(index){if(typeof index!="number"){index=0}this.dom.style.zIndex=index;this.options.zindex=index};this.setImgType=function(type){if(typeof type!="string"||!type){type="png"}this.options.imgType=type.toLowerCase()};this.setDataType=function(type){if(typeof type!="string"||!type){type="js"}this.options.dataType=type};this.setDataPattern=function(dataPattern){if(typeof dataPattern!="string"||!dataPattern){dataPattern="data"+MLayer.DPLACEHOLDER}this.options.dataPattern=dataPattern};this.setImgWidth=function(width){if(typeof width!="number"||width<=0){width=5}this.options.imgWidth=width;this.halfImgWidth=Math.ceil(width/2)};this.setImgHeight=function(height){if(typeof height!="number"||height<=0){height=5}this.options.imgHeight=height;this.halfImgHeight=Math.ceil(height/2)};this.setLevelRange=function(min,max,refresh){if(typeof min!="number"||min<minZoomLevel||min>maxZoomLevel){min=minZoomLevel}if(typeof max!="number"||max<minZoomLevel||max>maxZoomLevel){max=maxZoomLevel}this.options.minLevel=min;this.options.maxLevel=max;if(typeof refresh!="boolean"){refresh=true}if(refresh){this.update()}};this.setNeedData=function(need,f7Pa){if(typeof need!="boolean"){need=false}if(typeof f7Pa!="boolean"){f7Pa=true}var needData=this.options.needData;this.options.needData=need;if(f7Pa&&this.options.needData!=needData){if(needData){this.clearData()}else{C79.apply(this)}}};this.setCreator=function(creator){if(typeof creator!="D9Fa"||(creator!=MLayer.USER&&creator!=MLayer.SYSTEM)){creator=MLayer.USER}this.options.creator=creator};this.setImgUrlPreprocessor=function(urlPreprocessor){urlPreprocessor=urlPreprocessor||{};if(typeof urlPreprocessor.GtargetId!="function"||!urlPreprocessor.GtargetId){urlPreprocessor.GtargetId=null}if(typeof urlPreprocessor.e5_o!="object"||!urlPreprocessor.e5_o){urlPreprocessor.e5_o=null}this.options.imgUrlPreprocessor=urlPreprocessor};this.setDataUrlPreprocessor=function(urlPreprocessor){urlPreprocessor=urlPreprocessor||{};if(typeof urlPreprocessor.GtargetId!="function"||!urlPreprocessor.GtargetId){urlPreprocessor.GtargetId=null}if(typeof urlPreprocessor.e5_o!="object"||!urlPreprocessor.e5_o){urlPreprocessor.e5_o=null}this.options.dataUrlPreprocessor=urlPreprocessor};this.setFireEvent=function(events){if(typeof events!="number"){events=MLayer.ALL}this.options.events=events};this.fW64=function(RG2){RG2=RG2||{};if(typeof RG2.GtargetId!="function"||!RG2.GtargetId){RG2.GtargetId=null}if(typeof RG2.e5_o!="object"||!RG2.e5_o){RG2.e5_o=null}this.options.RG2=RG2};this.C8p=function(BCv1){BCv1=BCv1||{};if(typeof BCv1.GtargetId!="function"||!BCv1.GtargetId){BCv1.GtargetId=null}if(typeof BCv1.e5_o!="object"||!BCv1.e5_o){BCv1.e5_o=null}this.options.BCv1=BCv1};this.NN7=function(click){click=click||{};if(typeof click.GtargetId!="function"||!click.GtargetId){click.GtargetId=null}if(typeof click.e5_o!="object"||!click.e5_o){click.e5_o=null}this.options.click=click};this.setTip=function(tip,refresh){tip=tip||{};if(typeof tip.mode!="number"||(tip.mode&MLayer.TM_ALWAYS!=MLayer.TM_ALWAYS&&tip.mode&MLayer.TM_MOUSEOVER!=MLayer.TM_MOUSEOVER)){tip.mode=MLayer.TM_NEVER}if(typeof tip.otiLevel!="number"||tip.otiLevel<minZoomLevel||tip.otiLevel>maxZoomLevel){tip.otiLevel=minZoomLevel}if(typeof tip.otaLevel!="number"||tip.otaLevel<minZoomLevel||tip.otaLevel>maxZoomLevel){tip.otaLevel=maxZoomLevel}if(typeof tip.atiLevel!="number"||tip.atiLevel<minZoomLevel||tip.atiLevel>maxZoomLevel){tip.atiLevel=minZoomLevel}if(typeof tip.ataLevel!="number"||tip.ataLevel<te||tip.ataLevel>maxZoomLevel){tip.ataLevel=maxZoomLevel}this.options.tip=tip;if(typeof refresh!="boolean"){refresh=true}if(refresh){this.refreshTip()}};this.refreshTip=function(){for(var i in this.data){h0I.apply(this,[this.data[i]])}};var h0I=function(grid){if(typeof grid!="object"||!grid){return}for(var i=0;i<grid.length;i++){Yo7R.apply(this,[grid[i]])}};var Yo7R=function(data){if(typeof data!="object"||!data||!data.n){return}var b=n3HR.apply(this,[true,true]);var u0U=K6Q8.apply(this,[data]);if(b&&!data.tip&&u0U){this.wR(data)}else{if(data.tip&&(!b||!u0U)){v$g.apply(this,[data])}}};this.setNeedImg=function(need,f7Pa){if(typeof need!="boolean"){need=true}if(typeof f7Pa!="boolean"){f7Pa=true}var NkMM7=this.options.needImg;this.options.needImg=need;if(f7Pa&&this.options.needImg!=NkMM7){if(NkMM7){this.clearImgs()}else{C79.apply(this)}}};this.inZoomRange=function(zoomLevel){if(zoomLevel>=this.options.minLevel&&zoomLevel<=this.options.maxLevel){return true}else{return false}};this.paint=function(){if(!this.dom||!this.maplet){return}if(!this.maplet.layerContainer){this.maplet.J6s3H()}if(this.dom.parentNode!=this.maplet.layerContainer){this.resize(this.maplet.width,this.maplet.height);this.maplet.layerContainer.appendChild(this.dom)}};var b76=function(data,SM0h6){if(typeof data.iNp2Q=="undefined"){data.iNp2Q=SM0h6}else{data.iNp2Q=SM0h6}};var bP$=function(data){return typeof data.iNp2Q=="undefined"||data.iNp2Q};var iPkm=function(){for(var i in this.data){b76.apply(this,[this.data[i],false])}};var D$k=function(){for(var i in this.data){if(!bP$.apply(this,[this.data[i]])){IyfQv.apply(this,[i])}}};var K11=function(img,S67A){img.setAttribute($24j7,SminZoomLevelA?"yes":"no")};var f0F00=function(){for(var i in this.sGBb9){K11.apply(this,[this.sGBb9[i],false])}};var $g330=function(img){return img.getAttribute($24j7)=="yes"};var f6oO=function(){for(var i in this.sGBb9){if(!$g330.apply(this,[this.sGBb9[i]])){o13.apply(this,[i])}}};var o13=function(id){if(typeof this.sGBb9[id]=="object"){var img=this.sGBb9[id];img.onload=null;img.onerror=null;removeNode(img);img=null;delete this.sGBb9[id]}};var IyfQv=function(id){if(typeof this.data[id]=="object"){if(this.sGBb9[id]&&this.sGBb9[id].getAttribute(MLayer._loadingdata)){this.sGBb9[id].removeAttribute(MLayer._loadingdata)}for(var i=0;i<this.data[id].length;i++){v$g.apply(this,[this.data[id][i]])}if(u01&&u01.grid==id){_N18.apply(this);u01=null}this.data[id]=null;delete this.data[id]}};var v$g=function(data){if(!this.maplet||!data||!data.tip){return}this.maplet.removePanel(data.tip,true);data.tip=null;if(R5$Hl[data.p]){delete R5$Hl[data.p]}};this.update=function(){if(!this.dom||!this.maplet){return}if(!this.inZoomRange(this.maplet.zoomLevel)){this.clear();return}C79.apply(his)};this.refresh=function(){if(!this.dom||!this.maplet){return}this.clear();C79.apply(this)};var C79=function(){if(!this.isVisible()||!this.inZoomRange(this.maplet.zoomLevel)){return}iPkm.apply(this);f0F00.apply(this);for(var i in this.maplet.layerData){var item=this.maplet.layerData[i];if(item.x+this.maplet.imgWidth<0||item.x>this.maplet.width||item.y+this.maplet.imgHeight<0||item.y>this.maplet.height){continue}if(this.options.needImg){var img=this.sGBb9[i];if(typeof img!="object"||!img){img=document.createElement("IMG");img.style.position="absolute";img.setAttribute("unselectable","on");img.style.MozUserSelect="none";img.setAttribute(_dragmap,"true");img.setAttribute($$0,"yes");img.onerror=function(e5_o,id){return function(){kE4U2.apply(e5_o,[id])}}(this,i);img.onload=function(e5_o,id){return function(){q5h.apply(e5_o,[id])}}(this,i);this.sGBb9[i]=img}K11.apply(this,[img,true]);img.style.left=item.x+"px";img.style.top=item.y+"px";if(!img.src&&img.tagName!="DIV"){var src="";if(this.options.imgUrlPreprocessor.GtargetId){src=this.options.imgUrlPreprocessor.GtargetId.apply(this.options.imgUrlPreprocessor.e5_o,[item]);if(!src){continue}}else{src=XQ49.apply(this,[this.options.serverPath,item.fileXNo,item.fileYNo])+item.filename+"."+this.options.imgType}img.src=src}else{LK13.apply(this,[i])}}else{LK13.apply(this,[i])}}f6oO.apply(this);D$k.apply(this)};var XQ49=function(path,fileXNo,fileYNo){var dM4="img.mapbar.com";if(strImgsvrUrl.substring(7,21)==dM4){return path.replace(dM4,"img"+this.maplet.getImgServerId(fileXNo,fileYNo)+".mapbar.com")}else{return path}};var kE4U2=function(id){o13.apply(this,[id])};var q5h=function(id){var img=this.sGBb9[id];if(typeof img!="undefined"&&img){if(img.width<=1||img.height<=1){o13.apply(this,[id]);return}img.onerror=null;img.onload=null;if(isIE6&&this.options.imgType=="png"){var d=document.createElement("DIV");d.style.position="absolute";d.style.width=this.maplet.imgWidth+"px";d.style.height=this.maplet.imgHeight+"px";d.style.left=img.style.left;d.style.top=img.style.top;d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+img.src+",sizingMethod=scale);";d.style.MozUserSelect="none";d.setAttribute("unselectable","on");d.setAttribute(_dragmap,"true");d.setAttribute($$0,"yes");K11.apply(this,[d,true]);this.dom.appendChild(d);o13.apply(this,[id]);this.sGBb9[id]=d}else{this.dom.appendChild(img)}LK13.apply(this,[id])}};this.refreshDataXY=function(){if(!this.options.needData){return}for(var id in this.data){var uy=this.data[id];for(var i=0;i<uy.length;i++){var item=uy[i];var zB=this.maplet.layerData[id].x+item.r.i.x;var zF=this.maplet.layerData[id].y+item.r.i.y;item.vroundrect.min.x=zB;item.vroundrect.min.y=zF;item.vroundrect.max.x=zB+item.r.a.x;item.vroundrect.max.y=zF+item.r.a.y}}};var LK13=function(id){if(!this.options.needData){return}var img=this.sGBb9[id];if(!this.options.needImg||(typeof img=="object"&&img&&((typeof img.src!="undefined"&&img.src!=imgMaskUrl)||(isIE6&&this.options.imgType=="png")))){if(!this.data[id]&&typeof this.maplet.layerData[id]=="object"){if(img){if(img.getAttribute(MLayer._loadingdata)){return}else{img.setAttribute(MLayer._loadingdata,true)}}var item=this.maplet.layerData[id];var src="";if(this.options.dataUrlPreprocessor.GtargetId){src=this.options.dataUrlPreprocessor.GtargetId.apply(this.options.dataUrlPreprocessor.e5_o,[item]);if(!src){return}}else{src=XQ49.apply(this,[this.options.serverPath,item.fileXNo,item.fileYNo])+item.filename+"."+this.options.dataType}new foy21(src,Y1iLc,false,true,this,undefined,[id]).f7c0()}else{var uy=this.data[id];var layerData=this.maplet.layerData[id];if(typeof uy=="undefined"||!uy||typeof layerData=="undefined"||!layerData){return}b76.apply(this,[uy,true]);var p1=layerData.x;var p3=layerData.y;for(var i=0;i<uy.length;i++){var item=uy[i];item.vroundrect.min.x=p1+item.r.i.x;item.vroundrect.min.y=p3+item.r.i.y;item.vroundrect.max.x=item.vroundrect.min.x+item.r.a.x;item.vroundrect.max.y=item.vroundrect.min.y+item.r.a.y;Yo7R.apply(this,[item])}}}};var Y1iLc=function(id,t_l){if(typeof this.maplet=="object"&&this.maplet&&typeof this.maplet.layerData=="object"&&this.maplet.layerData){if(typeof this.maplet.layerData[id]=="undefined"||!this.maplet.layerData[id]){return}var layerData=this.maplet.layerData[id];var nsl=this.options.dataPattern.replace(MLayer.DPLACEHOLDER,layerData.dirname+"_"+layerData.xyname);var uy=eval("typeof  "+nsl+'=="undefined"?null:'+nsl);if(uy&&uy.length>0){this.data[id]=uy;var p1=layerData.x;var p3=layerData.y;for(var i=0;i<uy.length;i++){var item=uy[i];item.grid=id;var zB=p1+item.r.i.x;var zF=p3+item.r.i.y;item.vroundrect={min:{x:zB,y:zF},max:{x:zB+item.r.a.x,y:zF+item.r.a.y}};Yo7R.apply(this,[item])}uy=null}}removeNode(getElementById(t_l))};this.getDataByXY=function(id,x,y,jnuy){if(typeof jnuy!="boolean"){jnuy=false}if(this.data[id]){var pt={x:x,y:y};for(var i=0;i<this.data[id].length;i++){if(_isInsideRect(pt,this.data[id][i].vroundrect)){var d=this.data[id][i];if(jnuy){if(d.c.length>0){var r=d.vroundrect;var p1=this.maplet.layerData[id].x;var p3=this.maplet.layerData[id].y;for(var P7P9=0;P7P9<d.c.length;P7P9++){var c=d.c[P7P9];var qx=p1+c.i.x;var qz=p3+c.i.y;var h6I9={min:{x:qx,y:qz},max:{x:qx+c.a.x,y:qz+c.a.y}};if(_isInsideRect(pt,h6I9)){d=this.data[id][c.f]}}}}return d}}}return null};this.jct=function(id,x,y){if(!this.isVisible()){return null}var d=this.getDataByXY(id,x,y,PP2f.apply(this,[true,true]));if(d){this.maplet.setDomCursorStyle("pointer",this.maplet.panel)}if(this.options.BCv1.GtargetId){_N18.apply(this,[d])}if(this.options.RG2.GtargetId&&d){Hl$.apply(this,[d])}u01=d;if(this.options.RG2.GtargetId){return null}if(d&&PP2f.apply(this,[true,true])&&!n3HR.apply(this,[true,true])&&d.n){this.wR(d)}else{this.hP8u()}return d};var Hl$=function(d){if(this.options.RG2.GtargetId&&(!u01||u01!=d)){this.options.RG2.GtargetId.apply(this.options.RG2.e5_o,[d])}};var _N18=function(d){if(this.options.BCv1.GtargetId&&u01&&(u01!=d||!d)){this.options.BCv1.GtargetId.apply(this.options.BCv1.e5_o,[u01])}};var PP2f=function(oR4C,rW662){with(this.options.tip){return(!oR4C||(mode&MLayer.TM_MOUSEOVER)==MLayer.TM_MOUSEOVER)&&(!rW662||(this.maplet.zoomLevel>=otiLevel&&this.maplet.zoomLevel<=otaLevel))}};var n3HR=function(oR4C,rW662){with(this.options.tip){return(!oR4C||(mode&MLayer.TM_ALWAYS)==MLayer.TM_ALWAYS)&&(!rW662||(this.maplet.zoomLevel>=atiLevel&&this.maplet.zoomLevel<=ataLevel))}};this.wR=function(data){if(PP2f.apply(this,[true,true])&&!n3HR.apply(this,[true,true])){if(!_563){this.maplet.addPanel(MLayer.TIPANEL);_563=getElementById(MLayer.TIPID)}if(V3889!=data||(V3889==data&&!MLayer.TIPANEL.isVisible())){V3889=data;_563.innerHTML=data.n;MLayer.TIPANEL.dom.style.visibility="hidden";MLayer.TIPANEL.show();var H$284=VC_06.apply(this,[data]);MLayer.TIPANEL.setLocation({type:"xy",x:H$284.x,y:H$284.y});MLayer.TIPANEL.dom.style.visibility="visible"}}else{if(n3HR.apply(this,[true,true])&&data&&data.n){if(data.p&&R5$Hl[data.p]){return}R5$Hl[data.p]=true;data.tip=MLayer.TIPANEL2.clone();data.tip.setContainer(this.maplet.layerContainer.div);var n=data.n;if(n.length>8){n=data.n.substring(0,8)+"...";data.tip.dom.title=data.n}data.tip.setContent(data.tip.options.content.replace(MLayer.TPLACEHOLDER,n));data.tip.dom.firstChild.setAttribute(_dragmap,"true");data.tip.dom.style.visibility="hidden";this.maplet.addPanel(data.tip);var H$284=VC_06.apply(this,[data]);data.tip.setLocation({type:"xy",x:H$284.x,y:H$284.y});data.tip.dom.style.visibility="visible"}}};this.hP8u=function(){if(MLayer.TIPANEL.maplet&&V3889){V3889=null;MLayer.TIPANEL.hide()}};var K6Q8=function(data){return _isRectint(data.vroundrect,{min:{x:0,y:0},max:{x:this.maplet.width,y:this.maplet.height}})};var VC_06=function(data,size){var tip=MLayer.TIPANEL.dom;if(n3HR.apply(this,[true,true])){tip=data.tip.dom}var H$284={x:0,y:0};var qx=data.vroundrect.min.x;var qz=data.vroundrect.min.y;var N33=data.vroundrect.max.x;var oBsQ5=data.vroundrect.max.y;var $dd2O=tip.offsetWidth;var th=tip.offsetHeight;if(PP2f.apply(this,[true,true])){if(N33+2+$dd2O<=this.maplet.width-5){H$284.x=N33+2;H$284.y=qz+(oBsQ5-qz)/2-th/2}else{H$284.x=qx-$dd2O-2;H$284.y=qz+(oBsQ5-qz)/2-th/2}}else{H$284.x=N33+2;H$284.y=qz+(oBsQ5-qz)/2-th/2}return H$284};this.click=function(id,x,y){var e045={PW4t:true,VpKa:false,data:null};if(this.isVisible()&&(this.options.click.GtargetId||this.options.events&MLayer.CLICK==MLayer.CLICK)){e045.data=this.getDataByXY(id,x,y,true);if(e045.data){if(this.options.click.GtargetId){var e6k00=this.options.click.GtargetId.apply(this.options.click.e5_o,[e045.data]);e045.PW4t=e6k00.PW4t;e045.VpKa=e6k00.VpKa}else{e045.VpKa=true}}}return e045};this.clearImgs=function(){for(var i in this.sGBb9){o13.apply(this,[i])}};this.clearData=function(){for(var i in this.data){IyfQv.apply(this,[i])}};this.clear=function(){this.clearImgs();this.clearData();if(!this.dom){return}this.dom.innerHTML=""};this.getImgCount=function(D8_6){var c=0;if(this.isVisible()&&this.maplet&&this.inZoomRange(this.maplet.zoomLevel)){for(var i in this.sGBb9){c++}}return c};this.resize=function(width,height){if(!this.dom){return}if(filter2Num(this.dom.style.width,0)!=width){this.dom.style.width=(width-1)+"px"}if(filter2Num(this.dom.style.height,0)!=height){this.dom.style.height=(height-2)+"px"}};this.show=function(){var NkMM7=this.isVisible();this.setVisible(true);if(!NkMM7){C79.apply(this)}};this.hide=function(){var NkMM7=this.isVisible();this.setVisible(false);if(NkMM7){this.clear()}};this.setVisible=function(visible){if(!this.dom){return}if(this.dom.style.display!=(visible?"":"Yy1")){this.dom.style.display=visible?"":"none"}};this.isVisible=function(){return this.dom&&this.dom.parentNode==this.maplet.layerContainer.div&&this.dom.style.display!="none"};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}this.clear();if(this.dom){if(!finalize){if(this.dom.parentNode){this.dom.parentNode.removeChild(this.dom)}}else{removeNode(this.dom);this.dom=null}}if(this.options.imgUrlPreprocessor.e5_o){this.options.imgUrlPreprocessor.e5_o=null}if(this.options.dataUrlPreprocessor.e5_o){this.options.dataUrlPreprocessor.e5_o=null}if(this.options.RG2.e5_o){this.options.RG2.e5_o=null}if(this.options.BCv1.e5_o){this.options.BCv1.e5_o=null}if(this.options.click.e5_o){this.options.click.e5_o=null}this.maplet=null};this.toString=function(){return"com.mapbar.maplet.MLayer"};this.id=new Date().getTime()+"_layer";this.maplet=null;this.dom=document.createElement("DIV");this.dom.style.position="absolute";this.sGBb9={};this.data={};this.halfImgWidth=0;this.halfImgHeight=0;var $24j7="_using";var V3889=null;var _563=null;var R5$Hl={};var u01=null;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined);this.setZIndex(typeof zindex!="undefined"?zindex:undefined);this.setImgType(typeof imgType!="undefined"?imgType:undefined);this.setDataType(typeof dataType!="undefined"?dataType:undefined);this.setDataPattern(typeof dataPattern!="undefined"?dataPattern:undefined);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined),false);this.setImgWidth(typeof imgWidth!="undefined"?imgWidth:undefined);this.setImgHeight(typeof imgHeight!="undefined"?imgHeight:undefined);this.setNeedData(typeof needData!="undefined"?needData:undefined,false);this.setNeedImg(typeof needImg!="undefined"?needImg:undefined,false);this.setCreator(typeof creator!="undefined"?creator:undefined);this.setImgUrlPreprocessor(typeof imgUrlPreprocessor!="undefined"?imgUrlPreprocessor:undefined);this.setDataUrlPreprocessor(typeof dataUrlPreprocessor!="undefined"?dataUrlPreprocessor:undefined);this.setFireEvent(typeof events!="undefined"?events:undefined);this.setTip(typeof tip!="undefined"?tip:undefined,false);this.fW64(typeof RG2!="undefined"?RG2:undefined);this.C8p(typeof BCv1!="undefined"?BCv1:undefined);this.NN7(typeof click!="undefined"?click:undefined)}};MLayer.USER=1;MLayer.SYSTEM=2;MLayer.DPLACEHOLDER="[xyname]";MLayer.NONE=0;MLayer.CLICK=1;MLayer.waq2=2;MLayer.ALL=255;MLayer.TM_NEVER=0;MLayer.TM_ALWAYS=1;MLayer.TM_MOUSEOVER=2;MLayer.TIPID="_map_layertip";MLayer.TIPANEL=new MPanel({pin:true,location:{type:"xy"},content:"<div id='"+MLayer.TIPID+"' style='border:1px solid gray;background:white;padding:1px 3px;padding:2px 3px 0a;font-size:13px;line-height:17px;color:gray;' onmouseover='MLayer.setTipVisible(false);'></div>",creator:MPanel.SYSTEM});MLayer.TPLACEHOLDER="[TPLACEHOLDER]";MLayer.TIPANEL2=new MPanel({pin:true,location:{type:"xy",x:0,y:0},content:"<div style='border:1px solid gray;background:white;padding:1px 3px;padding:2px 3px 0a;font-size:12px;color:gray;white-space:nowrap;' unselectable='on'>"+MLayer.TPLACEHOLDER+"</div>",creator:MPanel.SYSTEM});MLayer.setTipVisible=function(a){if(MLayer.TIPANEL.maplet){MLayer.TIPANEL.setVisible(a)}};MLayer._loadingdata="_loadingdata";var MTraffic=function(options){this.initialize=function(maplet){this.maplet=maplet;this.layer=new MLayer({serverPath:this.options.serverPath,zindex:-1,imgType:this.options.imgType,needData:false,minLevel:this.options.minLevel,maxLevel:this.options.maxLevel,creator:MLayer.SYSTEM,imgUrlPreprocessor:{GtargetId:JM31Y,e5_o:this},EE0:""});this.maplet.addLayer(this.layer);this.refresh();$qI4=getInterval(this,_H5_3,this.options.interval)};var JM31Y=function(data){if(X_4NO){return this.options.serverPath+X_4NO+(this.maplet.zoomLevel-1)+"/o"+data.grid+"."+this.options.imgType}else{return""}};this.refresh=function(){if(!this.layer||!this.layer.inZoomRange(this.maplet.zoomLevel)){return}this.layer.clear();oPl=true;_H5_3.apply(this)};var _H5_3=function(){Q52j.apply(this)};var Q52j=function(){new foy21(_dc9.apply(this),F0U6,false,true,this).f7c0()};var _dc9=function(){return this.options.magicPath.replace("[city]",this.options.city)};var F0U6=function(){var d=eval(MTraffic.MAGIC_RESULT_NAME);if(typeof d!="string"||!d){return}if(!X_4NO||d!=X_4NO||oPl){X_4NO=eval(MTraffic.MAGIC_RESULT_NAME);oPl=false;this.layer.clear();this.layer.update();MEvent.trigger(this.layer.maplet,"traffic_update",{magicPath:X_4NO})}};this.getTimestamp=function(){var e045=null;if(X_4NO){var x84=X_4NO.split("/");if(x84.length>8){e045=new Date(x84[4],filter2Num(x84[5][0]=="0"?x84[5][1]:x84[5]),x84[6],x84[7],x84[8].replace(x84[4]+x84[5]+x84[6]+x84[7],""),0)}}return e045};this.wm27_=function(){var e045="";if(X_4NO){var x84=X_4NO.split("/");if(x84.length>9){e045=x84.slice(4,9).join("/")}}return e045};this.setServerPath=function(path){if(typeof path!="string"||!path){path="http://lukuang.mapbar.com/"}this.options.serverPath=path};this.setImgType=function(type){if(typeof type!="string"||!type){type="png"}this.options.imgType=type.toLowerCase()};this.setMagicPath=function(path){if(typeof path!="string"||!path){path="http://lukuang.mapbar.com/[city]/traffic/images/traffic.js"}this.options.magicPath=path};this.setLevelRange=function(min,max){if(typeof min!="number"||min<TRAFFIC_MIN_LEVEL||min>TRAFFIC_MAX_LEVEL){min=TRAFFIC_MIN_LEVEL}if(typeof max!="number"||max<TRAFFIC_MIN_LEVEL||max>TRAFFIC_MAX_LEVEL){max=TRAFFIC_MAX_LEVEL}this.options.minLevel=min;this.options.maxLevel=max};this.setInterval=function(i){if(typeof i!="number"||i<TRAFFIC_REFRESH_INTERVAL){i=TRAFFIC_REFRESH_INTERVAL}this.options.interval=i*1000;if($qI4){window.clearInterval($qI4);$qI4=getInterval(this,_H5_3,this.options.interval)}};this.setCity=function(city,refresh){if(typeof city!="string"||!city){city="beijing"}this.options.city=city;if(typeof refresh!="boolean"){refresh=true}if(refresh){oPl=true;_H5_3.apply(this)}};this.show=function(){if(this.layer){this.layer.show()}};this.hide=function(){if(this.layer){this.layer.hide()}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}if($qI4){window.clearTimeout($qI4)}$qI4=null;if(this.maplet){this.maplet.removeLayer(this.layer,finalize)}this.maplet=null};this.toString=function(){return"com.mapbar.maplet.MTraffic"};this.id=new Date().getTime()+"_traffic";this.maplet=null;this.layer=null;var $qI4=null;var X_4NO=null;var oPl=true;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined));this.setInterval(typeof interval!="undefined"?interval:undefined);this.setCity(typeof city!="undefined"?city:undefined,false);this.setMagicPath(typeof magicPath!="undefined"?magicPath:undefined);this.setImgType(typeof imgType!="undefined"?imgType:undefined)}};MTraffic.MAGIC_RESULT_NAME="__mapbar_magic_id";var MPOILayer=function(options){this.initialize=function(maplet){this.maplet=maplet;this.layer=new MLayer({serverPath:this.options.serverPath,needData:true,minLevel:this.options.minLevel,maxLevel:this.options.maxLevel,creator:MLayer.SYSTEM,needImg:false,imgType:"gif",events:MLayer.CLICK,dataPattern:"basepoi"+MLayer.DPLACEHOLDER,RG2:{GtargetId:P3GM,e5_o:this},BCv1:{GtargetId:W77,e5_o:this},click:{GtargetId:o11,e5_o:this},tip:{mode:MLayer.TM_MOUSEOVER},zindex:-2});this.maplet.addLayer(this.layer)};this.markers=[];this._B1=null;var IKo37=function(grid,data){return mapliteUrl+"mapbank/base/"+(this.maplet.zoomLevel-1)+"/"+grid.dirname+"/"+(data.d).split("_")[1]+".png"};this.enableData=function(data){if(typeof data!="number"||(data&MPOILayer.DT_BUS!=MLayer.DT_BUS&&data&MPOILayer.DT_GOLD!=MLayer.DT_GOLD&&data&MPOILayer.DT_NONE!=MLayer.DT_NONE&&data&MPOILayer.DT_NORMAL!=MLayer.DT_NORMAL&&data&MPOILayer.DT_POI!=MLayer.DT_POI&&data&MPOILayer.DT_SUBWAY!=MLayer.DT_SUBWAY)){data=MPOILayer.DT_ALL}this.options.data=data};var o11=function(data){var grid=this.maplet.layerData[data.grid];var e340=data.d.split("_");var type=parseInt(e340[0]);var filename=e340[1];var _t0="";var yO0=filename.replace("=","_").replace("=","_");var e045={PW4t:false,VpKa:false};switch(type){case MPOILayer.HS_GOLD:if((MPOILayer.DT_GOLD&this.options.data)==MPOILayer.DT_GOLD&&DISABLE_OLD_GOLDPOI){if(getElementById(yO0+"_pointBox")==null){this.iF32J(grid,data)}else{D$e.open(yO0,data.vroundrect);this.S64n7=yO0}}break;case MPOILayer.HS_POI:if((MPOILayer.DT_POI&this.options.data)==MPOILayer.DT_POI){var x=data.vroundrect.min.x+(data.vroundrect.max.x-data.vroundrect.min.x)/2;var y=data.vroundrect.min.y+(data.vroundrect.max.y-data.vroundrect.min.y)/2;_t0=mapliteUrl+"mapbank/base/"+(this.maplet.zoomLevel-1)+"/"+grid.dirname+"/"+filename+".png";this._B1=data.vroundrect;var uy=null;try{uy=eval(yO0)}catch(_event){uy=null}if(uy==null){new foy21(_t0,function(t_l){try{uy=eval(yO0);this.g184(data,uy,x,y)}catch(_event){}removeNode(getElementById(t_l))},false,true,this).f7c0()}else{this.g184(data,uy,x,y)}}break;case MPOILayer.HS_SUBWAY:if((MPOILayer.DT_SUBWAY&this.options.data)==MPOILayer.DT_SUBWAY&&MEvent.contains(this.maplet,"subway_click")>0){MEvent.trigger(this.maplet,"subway_click",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_BUS:if((MPOILayer.DT_BUS&this.options.data)==MPOILayer.DT_BUS&&MEvent.contains(this.maplet,"bus_click")>0){MEvent.trigger(this.maplet,"bus_click",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_NORMAL:break;default:break}return e045};this.g184=function(data,uy,x,y){if(typeof uy=="undefined"){return}var point=new MPoint("");point.initialize(this.maplet);point.setMapCoords(x,y);var id=data.d.split("_")[1];if(this.markers[id]){this.markers[id].openInfoWindow()}else{this.markers[id]=new MMarker(point,new MIcon(imgMaskUrl),new MInfoWindow(uy.title,uy.content));this.maplet.addOverlay(this.markers[id]);this.markers[id].openInfoWindow()}};this.M4X3=[];this.X8q=[];this.S64n7=null;this.wi1_=[];var P3GM=function(data){var grid=this.maplet.layerData[data.grid];this.wi1_["o"+data.grid]=true;var d=(data.d).split("_");var type=parseInt(d[0]);switch(type){case MPOILayer.HS_GOLD:if((MPOILayer.DT_GOLD&this.options.data)==MPOILayer.DT_GOLD&&DISABLE_OLD_GOLDPOI){var filename=d[1];var yO0=filename.replace("=","_").replace("=","_");var uy=getElementById(yO0+"_pointBox");if(uy==null){if(!getElementById(data.grid)){return}if(getElementById(yO0+"_pointBox")==null){if(!this.X8q[yO0]){this.X8q[yO0]=true;new foy21(IKo37(grid,data),function(id){this.B08aw(data,id);removeNode(getElementById(id))},false,true,this).f7c0()}}}else{if(parseInt(uy.getAttribute("transFormType"))==0){this.B08aw(data)}}}break;case MPOILayer.HS_POI:break;case MPOILayer.HS_SUBWAY:if((MPOILayer.DT_SUBWAY&this.options.data)==MPOILayer.DT_SUBWAY&&MEvent.contains(this.maplet,"subway_mouseover")>0){MEvent.trigger(this.maplet,"subway_mouseover",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_BUS:if((MPOILayer.DT_BUS&this.options.data)==MPOILayer.DT_BUS&&MEvent.contains(this.maplet,"bus_mouseover")>0){MEvent.trigger(this.maplet,"bus_mouseover",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_NORMAL:break;default:break}};var W77=function(data){this.wi1_["o"+data.grid]=false;if(this.S64n7==null){return}var uy=getElementById(this.S64n7+"_pointBox");if(uy!=null){uy.onmouseout();this.S64n7=null}switch(parseInt((data.d).split("_")[0])){case MPOILayer.HS_SUBWAY:if((MPOILayer.DT_SUBWAY&this.options.data)==MPOILayer.DT_SUBWAY&&MEvent.contains(this.maplet,"subway_mouseout")>0){MEvent.trigger(this.maplet,"subway_mouseout",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_BUS:if((MPOILayer.DT_BUS&this.options.data)==MPOILayer.DT_BUS&&MEvent.contains(this.maplet,"bus_mouseout")>0){MEvent.trigger(this.maplet,"bus_mouseout",{layer:this.layer,pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}break;case MPOILayer.HS_NORMAL:break;default:break}};this.v6U$7=null;this.iF32J=function(grid,data){var d=(data.d).split("_");var filename=d[1];var yO0=filename.replace("=","_").replace("=","_");new foy21(IKo37(grid,data),function(t_l){var LUWC=eval(yO0);if(typeof LUWC=="undefined"){return}var grid=getElementById(data.grid);if(grid==null){return}var left=(data.vroundrect.max.x-data.vroundrect.min.x)/2+data.vroundrect.min.x-parseInt(grid.style.left);var top=(data.vroundrect.max.y-data.vroundrect.min.y)/2+data.vroundrect.min.y-parseInt(grid.style.top);D$e.show(yO0,("o"+data.grid),this.maplet,LUWC.BV9,LUWC.title,LUWC.content,left,top);D$e.$4$94((yO0),data.vroundrect);this.S64n7=yO0;removeNode(getElementById(t_l))},false,true).f7c0()};this.setServerPath=function(path){if(typeof path!="string"||!path){path=strImgsvrUrl+"/mapbank/maplayer/basepoi/"}this.options.serverPath=path};this.setLevelRange=function(min,max){if(typeof min!="number"||min<BASEPOI_MIN_LEVEL||min>BASEPOI_MAX_LEVEL){min=BASEPOI_MIN_LEVEL}if(typeof max!="number"||max<BASEPOI_MIN_LEVEL||max>BASEPOI_MAX_LEVEL){max=BASEPOI_MAX_LEVEL}this.options.minLevel=min;this.options.maxLevel=max};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean"){finalize=false}if(this.maplet){this.maplet.removeLayer(this.layer,finalize)}for(var id in this.markers){if(this.markers[id] instanceof MMarker){this.markers[id].remove(true);this.markers[id]=null}delete this.markers[id]}this.maplet=null};this.toString=function(){return"com.mapbar.maplet.MPOILayer"};this.maplet=null;this.layer=null;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined));this.enableData(typeof data!="undefined"?data:undefined)}this.B08aw=function(data,t_l){if(this.v6U$7==null){this.v6U$7=getTimeout(this,function(){if(typeof data.d=="undefined"){return}var filename=(data.d).split("_")[1];var yO0=filename.replace("=","_").replace("=","_");var LUWC=null;try{LUWC=eval(yO0)}catch(_event){return}var uy=getElementById(yO0+"_pointBox");if(this.wi1_["o"+data.grid]){if(uy==null){var grid=getElementById("o"+data.grid);if(grid!=null){var left=(data.vroundrect.max.x-data.vroundrect.min.x)/2+data.vroundrect.min.x-parseInt(grid.style.left);var top=(data.vroundrect.max.y-data.vroundrect.min.y)/2+data.vroundrect.min.y-parseInt(grid.style.top);D$e.show(yO0,("o"+data.grid),this.maplet,LUWC.BV9,LUWC.title,LUWC.content,left,top);D$e.$4$94((yO0),data.vroundrect,true)}this.S64n7=yO0;removeNode(getElementById(t_l))}else{D$e.open(yO0,data.vroundrect,true);this.S64n7=yO0}}if(this.X8q[yO0]){this.X8q[yO0]=null;delete this.X8q[yO0]}clearTimeout(this.v6U$7);this.v6U$7=null},1000)}}};MPOILayer.DT_NONE=0;MPOILayer.DT_NORMAL=1;MPOILayer.DT_POI=2;MPOILayer.DT_GOLD=4;MPOILayer.DT_SUBWAY=8;MPOILayer.DT_BUS=16;MPOILayer.DT_ALL=255;MPOILayer.HS_GOLD=3;MPOILayer.HS_POI=2;MPOILayer.HS_SUBWAY=4;MPOILayer.HS_BUS=5;MPOILayer.HS_NORMAL=1;var ON588="";var t3O4="http://www.mapbar.com";var uLQB="http://bus.mapbar.com";var w8WC="http://nav.mapbar.com";var $qs="http://nb.mapbar.com";var m68="http://my.mapbar.com/imap/map.jsp";var w1591=3;var vV$=3;var H88T7=new Array();var W49R=0;var D$e={ao:new Array(),show:function(D,u,m,p,I,C,d,q){this.id=D;this.left=typeof d=="undefined"?0:d;this.top=typeof q=="undefined"?0:q;var J=typeof I=="undefined"?"":I;if(typeof p!="undefined"&&p!=null){var i=p.split(",");var H=parseInt(i[1]);var A=parseInt(i[3]);var r=parseInt(i[4]);var G=parseInt(i[5]);var z=parseInt(i[6])+75;var E=i[7];var e=i[8];var g=i[9];var o=i[10];var F=i[11]}switch(H){case 0:case"left":H=0;break;case 1:case"right":H=1;break;default:H=1;break}var b=typeof C=="undefined"?"":C;var l=document.createElement("div");l.id=this.id+"_pointBox";l.className=H?"pointBox rightThis":"pointBox";l.unselectable="on";l.style.left=this.left+"px";l.style.top=this.top+"px";l.style.width=G+"px";l.style.height=z+"px";l.setAttribute("maxW",G);l.setAttribute("maxH",z);l.setAttribute("linkUrl",F);var n=this.Hr3(this.id,J,b,A,r,E,e,g,o);var c=document.createElement("div");c.id=this.id+"_arrow";c.unselectable="on";c.style.left="-13px";c.style.top="";c.style.width="15px";c.style.height="23px";c.style.overflow="hidden";c.style.position="absolute";if(isIE6){c.innerHTML=this.b7GT(H)}else{c.innerHTML='<img style="position: absolute; left: '+(H==0?"-61":"-25")+"px; top:"+(H==0?"-124":"-178")+'px;" src="'+CTLIMG_RESOURCE[0].url+'"/>'}var j=document.createElement("div");j.id=this.id+"_PMain";j.className="PMain";j.unselectable="on";j.style.padding="5px";j.style.height=r+"px";var k=document.createElement("div");k.id=this.id+"_BoxBg";k.className="BoxBg";k.unselectable="on";k.style.height=j.style.height;k.style.top="5px";l.appendChild(j);l.appendChild(k);l.appendChild(c);if(typeof m!="undefined"&&m!=null){this.maplet=m}j.appendChild(n);if(typeof this.maplet.layerDrawMap!="undefined"){try{getElementById(u).appendChild(l)}catch(f){return}}var a=getElementById(u).innerHTML;a=a.replace(new RegExp(this.id,"gm"),"tmpDiv");var B=document.createElement("div");B.id="tmpDiv";B.style.width=G+"px";B.innerHTML=a;this.maplet.map.appendChild(B);getElementById("tmpDiv_pointBox").style.width=G+"px";getElementById("tmpDiv_pointBox").style.height="1000px";getElementById("tmpDiv_layout").style.width=G-10+"px";getElementById("tmpDiv_layout").style.height="1000px";getElementById("tmpDiv_title").style.width=(G-10)+"px";getElementById("tmpDiv_content").style.display="";getElementById("tmpDiv_title").style.display="";getElementById("tmpDiv_line").style.height="1px";l.setAttribute("maxH",getElementById("tmpDiv_layoutTable").offsetHeight);getElementById(u).innerHTML=getElementById("tmpDiv").innerHTML.replace(new RegExp("tmpDiv","gm"),this.id);z=parseInt(l.getAttribute("maxH"));getElementById(this.id+"_layout").style.height=z+10+"px";getElementById(this.id+"_pointBox").style.height=z+30+"px";getElementById(this.id+"_PMain").style.height=z+10+"px";getElementById(this.id+"_PMain").style.width=parseInt(l.getAttribute("maxW"))-10+"px";getElementById(this.id+"_BoxBg").style.height=z+20+"px";this.maplet.map.removeChild(B);getElementById(this.id+"_pointBox").setAttribute("maxH",parseInt(getElementById(this.id+"_pointBox").style.height));getElementById(this.id+"_BoxBg").style.width=getElementById(this.id+"_BoxBg").offsetWidth+"px";getElementById(this.id+"_pointBox").style.top=(parseInt(getElementById(this.id+"_pointBox").style.top)-z/2-10)+"px";getElementById(this.id+"_pointBox").setAttribute("initT",parseInt(getElementById(this.id+"_pointBox").style.top));if(H==1){getElementById(this.id+"_pointBox").style.left=parseInt(getElementById(this.id+"_pointBox").style.left)-parseInt(getElementById(this.id+"_pointBox").style.width)+"px";getElementById(this.id+"_arrow").style.left=parseInt(getElementById(this.id+"_pointBox").style.width)+(isIE6?3:1)+"px"}var v=z+24;getElementById(this.id+"_arrow").style.top=v/2-12+"px";getElementById(this.id+"_pointBox").setAttribute("initAT",v/2-12);this.events[this.id]=new Array();var t=getElementById(this.id+"_pointBox");t.style.display="none";t.setAttribute("transFormType",0);t.setAttribute("position",H);getElementById(this.id+"_pushpin").setAttribute("stay","false");getElementById(this.id+"_pointBox").onmouseout=function(K){D$e.J2T(isIE?event:K,this.id.replace("_pointBox",""))};getElementById(this.id+"_pushpin").onclick=function(){D$e.pin(this.id.replace("_pushpin",""))}},pin:function(d){var c=typeof d=="undefined"?this.id:d;var a=getElementById(c+"_pushpin");var b=(a.getAttribute("stay")=="false");if(b){this.y87(a,1);a.setAttribute("stay","true")}else{this.y87(a,0);a.setAttribute("stay","false");this.close(c)}},y87:function(a,b){b=typeof b=="undefined"?0:b;if(isIE6){a.innerHTML=this.S$228(b)}else{a.firstChild.style.left=((b==0)?"-89px":"-103px")}},$4$94:function(d,b,c){var a=getElementById(d+"_pointBox");if(a==null){return}if(parseInt(a.getAttribute("position"))==0){a.style.left=parseInt(a.style.left)+((b.max.x-b.min.x)+b.min.x)+13+"px";a.setAttribute("rect",b.max.x+","+b.max.y+","+b.min.x+","+b.min.y)}this.open(d,b,c)},open:function(d,b,c){if(getElementById(d+"_pushpin")==null){ON588=d}else{if(parseInt(getElementById(d+"_pointBox").getAttribute("transFormType"))==1){return}if(typeof b!="undefined"){getElementById(d+"_pointBox").setAttribute("rect",b.max.x+","+b.max.y+","+b.min.x+","+b.min.y)}try{this.vu(d,c)}catch(a){}}},b7GT:function(a){return'<img src="'+strImgsvrUrl+'images/newbubbleimg/mbblank.gif" style="position:absolute;left: '+(a==0?"-61":"-25")+"px; top: "+(a==0?"-124":"-178")+"px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;">'},J2T:function(a,d){var c=d;var b=getElementById(c+"_pointBox");if(b==null){return}if(parseInt(b.getAttribute("transFormType"))==1){this.events[c]["transFormTimer"]=getTimeout(this,function(){if(b==null){return}if(!_isInsideRect({x:this.maplet.curX,y:this.maplet.curY},this.getRect(c))&&!_isInsideRect({x:this.maplet.curX,y:this.maplet.curY},this.qK2t(c))){b.setAttribute("transFormType",1);this.vu(c)}clearTimeout(this.events[c]["transFormTimer"]);delete this.events[c]["transFormTimer"]},1000)}},close:function(d){var c=typeof d=="undefined"?this.id:d;var b=getElementById(c+"_pointBox");if(b==null){return}var a=getElementById(c+"_pushpin");this.y87(a,0);a.setAttribute("stay","false");b.setAttribute("transFormType",0);b.style.display="none"},vu:function(c,g){var e=typeof c=="undefined"?this.id:c;var a=getElementById(e+"_pointBox");if(a==null){return}if(parseInt(a.getAttribute("maxw"))>this.maplet.width||parseInt(a.getAttribute("maxh"))>this.maplet.height){if(g){return}if(parseInt(a.getAttribute("transFormType"))==1){return}var b=a.getAttribute("linkUrl");if(b!=null&&b!=""){window.open(b)}this.close(e);return}var d=getElementById(e+"_pushpin").getAttribute("stay")=="true";if(parseInt(a.getAttribute("transFormType"))==1){if(!d){a.setAttribute("transFormType",0);a.style.display="none"}}else{if(!d){var j=a.getAttribute("rect").split(",");for(var f=0;f<j.length;f++){j[f]=parseInt(j[f])}var k=getElementById(e+"_arrow");if((this.maplet.width/2)>=(parseInt(j[2])+(j[0]-j[2])/2)){a.setAttribute("position",0);a.className="pointBox";k.style.left="-13px";if(isIE6){k.innerHTML=this.b7GT(0)}else{k.firstChild.style.left="-61px";k.firstChild.style.top="-124px"}a.style.left=j[0]-parseInt(a.parentNode.style.left)+13-(j[0]-j[2])/2+"px"}else{a.setAttribute("position",1);a.className="pointBox rightThis";if(isIE6){k.innerHTML=this.b7GT(1)}else{k.firstChild.style.left="-25px";k.firstChild.style.top="-178px"}k.style.left=parseInt(a.style.width)+(isIE6?10:2)+"px";a.style.left=j[2]-parseInt(a.parentNode.style.left)-parseInt(a.style.width)-5-13+(j[0]-j[2])/2+"px"}var l=0;if((j[3]+(j[1]-j[3])/2-parseInt(a.style.height)/2)<=0){l=0-parseInt(a.parentNode.style.top);if(j[3]<=0){k.style.top="0px"}else{k.style.top=(j[3]+(j[1]-j[3])/2-10)+"px"}a.style.top=l+"px"}else{if((j[3]+(j[1]-j[3])/2+parseInt(a.style.height)/2)>=this.maplet.height){l=this.maplet.height-parseInt(a.style.height)-parseInt(a.parentNode.style.top);if(j[1]>=this.maplet.height){k.style.top=parseInt(a.style.height)-parseInt(k.style.height)-6+"px"}else{k.style.top=parseInt(a.style.height)-(this.maplet.height-(j[3]+(j[1]-j[3])/2))-10+"px"}a.style.top=l+"px"}else{a.style.top=a.getAttribute("initT")+"px";k.style.top=a.getAttribute("initAT")+"px"}}a.setAttribute("transFormType",1);a.style.display=""}}},getRect:function(d){var c=getElementById(d+"_pointBox");if(c==null){return{max:{x:0,y:0},min:{x:0,y:0}}}var b={min:{x:c.offsetLeft+c.parentNode.offsetLeft+5,y:c.offsetTop+c.parentNode.offsetTop},max:{x:0,y:0}};var a=getElementById(d+"_PMain");b.max.x=b.min.x+a.offsetWidth+parseInt(a.style.padding);b.max.y=b.min.y+a.offsetHeight+parseInt(a.style.padding);return b},qK2t:function(d){var c=getElementById(d+"_pointBox");if(c==null){return{max:{x:0,y:0},min:{x:0,y:0}}}var b=c.getAttribute("rect").split(",");for(var a=0;a<b.length;a++){b[a]=parseInt(b[a])}return{max:{x:b[0],y:b[1]},min:{x:b[2],y:b[3]}}},N37:function(b,f){var i='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>\n<meta http-equiv="x-ua-compatible" content="ie=7" />\n<title>\u6253\u5370\u9875\u9762</title>\n<link href="style.css" rel="stylesheet" type="text/css"/>\n';var a='<style media="print">\n.Noprint {\nDISPLAY: none \n}\n.PageNext{ \nPAGE-BREAK-AFTER: always \n}\n</style>\n';var j='<body>\n<table class="Noprint" width="300" border="0" cellspacing="0" cellpadding="0">\n<tr>\n<td>\n<button onClick="window.print();">\u6253\u5370</button></td>\n<td><button onClick="window.close();return false;">\u5173\u95ed</button></td>\n<td id="title">'+f+"</td>\n</tr>\n</table>\n";var k='<script type="text/javascript">\nwindow.onerror = function() {\nreturn true;\n}\n<\/script>\n</body>\n</html>';var g='<img src="'+b+'">\n';var e=i+a+j+g+k;var d=window.open("./Print.html","print");try{d.document.write(e);d.document.close()}catch(c){d.close()}},getText:function(b){if(b.tagName==undefined){return b.nodeValue.toString()}else{for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a].tagName!=undefined){return this.getText(b.childNodes[a])}else{if(b.childNodes[0].nodeValue.toString().replace(" ","").length>1){return this.getText(b.childNodes[0])}}}}},Hr3:function(r,F,i,t,q,v,f,m,p,d,o){var n=document.createElement("div");n.id=r+"_layout";var l=typeof t=="undefined"?84:parseInt(t);var C=typeof q=="undefined"?18:parseInt(q);var j=typeof d=="undefined"?0:parseInt(d);var b=typeof o=="undefined"?0:parseInt(o);n.style.width=l+"px";n.style.height=C+"px";n.style.left=j+"px";n.style.top=b+"px";n.style.position="relative";n.style.overflow="hidden";n.style.unselectable="on";var A=document.createElement("TABLE");A.id=r+"_layoutTable";A.cellSpacing=0;A.cellPadding=0;A.border=0;var D=A.insertRow(0);var E=D.insertCell(0);E.AV60x=2;E.id=r+"_title";var k=D.insertCell(1);var c=A.insertRow(1);var u=A.insertRow(2);var e=u.insertCell(0);var g=A.insertRow(3);var z=c.insertCell(0);z.er8y_=3;z.id=r+"_line";z.style.display="";z.style.height="1px";z.style.backgroundColor="#ccc";var a=g.insertCell(0);e.id=r+"_content";e.er8y_=3;e.style.display="";i=typeof i=="undefined"?"":i;e.innerHTML=i;var B=document.createElement("div");B.id=this.id+"_pushpin";B.style.width="12px";B.style.height="12px";B.style.top=((isIE)?0:4)+"px";B.style.cursor="pointer";B.style.position="absolute";B.style.overflow="hidden";if(isIE6){B.innerHTML=this.S$228(0)}else{B.innerHTML='<img style="position: absolute; left: -89px; top:0px;" src="'+CTLIMG_RESOURCE[0].url+'"/>'}k.appendChild(B);E=typeof E=="undefined"?"":E;E.style.display="";E.style.overflow="hidden";E.innerHTML='<div style="margin-left:5px;overflow:hidden;'+(isIE?"height:14px;":"")+'" align="left">'+F+"</div>";E.removeAttribute("bpdata");k.vAlign="top";k.style.width=parseInt(B.style.width)+4+"px";a.id=r+"_bottom";a.style.display="";a.er8y_=3;a.innerHTML="<div id='tipdiv' style='font-size:12px;height:65px;color:#000;background:#E5ECF9;margin-top:0px;clear:both;'>\n<div style=\"display:${obj.funsDisplay}\">\n<table style=\"margin-top:10px;\">\n<tr>\n<td valign=middle><p style='margin:3px 0;'><a href='javascript:;' onclick='showTipDiv(\"tipneardiv\",\"tipdiv\");'>\u67e5\u627e\u5468\u8fb9</a></p><p style='margin:3px 0;'><a href='javascript:;' onclick='showTipDiv(\"tipfromDiv\",\"tipdiv\");'>\u4ece\u8fd9\u91cc\u51fa\u53d1</a> - <a href='javascript:;' onclick='showTipDiv(\"tiptoDiv\",\"tipdiv\");'>\u5230\u8fbe\u8fd9\u91cc</a></p></td>\n</tr>\n</table>\n</div>\n</div>\n<div id='tipneardiv' style='display:none;font-size:12px;color:#000;background:#E5ECF9;margin-top:0px;padding:3px 0 0 3px;clear:both;' ><p style='margin:3px 0;'><a href='javascript:;' onclick='showTipDiv3(\"tipfromDiv\",\"tipdiv\",\"tipneardiv\");'>\u4ece\u8fd9\u91cc\u51fa\u53d1</a> - <a href='javascript:;' onclick='showTipDiv3(\"tiptoDiv\",\"tipdiv\",\"tipneardiv\");'>\u5230\u8fbe\u8fd9\u91cc</a> - \u67e5\u627e\u5468\u8fb9</p>\n<form style=\"margin:0px;padding:0px;\" name=nearbyform onsubmit='inforwindowNearSubmit(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.poitype.value,"'+p+"\");return false;'>\n<input type='text' id='infoWindowPoitype' name='poitype'/>\n<input name='submit1' type='submit' value='\u641c\u7d22' /> \u5982\uff1a<a href='javascript:void(0)' onclick='document.getElementById(\"infoWindowPoitype\").value=this.innerHTML;inforwindowNearSubmit(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.innerHTML,"'+p+'");\'>\u94f6\u884c</a>,<a href=\'javascript:void(0)\' onclick=\'document.getElementById("infoWindowPoitype").value=this.innerHTML;inforwindowNearSubmit("","","'+v+'","'+f+'","'+m+'",this.innerHTML,"'+p+"\");'>\u9910\u9986</a>\n</form>\n<a href='javascript:;' onclick='showTipDiv(\"tipdiv\",\"tipneardiv\")'>&laquo;&nbsp;\u4e0a\u4e00\u6b65</a>\n</div>\n<div id='tipfromDiv' style='display:none;font-size:12px;color:#000;background:#E5ECF9;margin-top:0px;padding:3px 0 0 3px;clear:both;'><p style='margin:3px 0;'>\u4ece\u8fd9\u91cc\u51fa\u53d1 - <a href='javascript:;' onclick='showTipDiv3(\"tiptoDiv\",\"tipfromDiv\",\"tipneardiv\");'>\u5230\u8fbe\u8fd9\u91cc</a> - <a href='javascript:;' onclick='showTipDiv3(\"tipneardiv\",\"tiptoDiv\",\"tipfromDiv\");'>\u67e5\u627e\u5468\u8fb9</a></p>\n<form name=fromform style=\"margin:0px;padding:0px;\" onsubmit='return false;'>\n<input type='text'id='inforwindowMudi' name='searchmudi'/>\n<input name='button' type='button' value='\u67e5\u516c\u4ea4' onclick='inforwindowMudiFunBus(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.form.elements["inforwindowMudi"].value,"'+p+"\")' />\n<input name='button' type='button' value='\u67e5\u9a7e\u8f66'onclick='inforwindowMudiFunDriver(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.form.elements["inforwindowMudi"].value,"'+p+"\")' /><br>\n<a href='javascript:;' onclick='showTipDiv(\"tipdiv\",\"tipfromDiv\")'>&laquo;&nbsp;\u4e0a\u4e00\u6b65</a>\n</form>\n</div>\n<div id='tiptoDiv' style='display:none;font-size:12px;color:#000;background:#E5ECF9;margin-top:0px;padding:3px 0 0 3px;clear:both;'><p style='margin:3px 0;'><a href='javascript:;' onclick='showTipDiv3(\"tipfromDiv\",\"tiptoDiv\",\"tipneardiv\");'>\u4ece\u8fd9\u91cc\u51fa\u53d1</a> - \u5230\u8fbe\u8fd9\u91cc - <a href='javascript:;' onclick='showTipDiv3(\"tipneardiv\",\"tiptoDiv\",\"tipfromDiv\");'>\u67e5\u627e\u5468\u8fb9</a></p>\n<form name=toform style=\"margin:0px;padding:0px;\"onsubmit='return false;'>\n<input type='text' id='inforwindowChuFa'/>\n<input name='button' type='button' value='\u67e5\u516c\u4ea4'onclick='inforwindowChuFaFunBus(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.form.elements["inforwindowChuFa"].value,"'+p+"\")' />\n<input name='button' type='button' value='\u67e5\u9a7e\u8f66'onclick='inforwindowChuFaFunDriver(\"\",\"\",\""+v+'","'+f+'","'+m+'",this.form.elements["inforwindowChuFa"].value,"'+p+'")\' /><br>\n<a href=\'javascript:;\' onclick=\'showTipDiv("tipdiv","tiptoDiv")\'>&laquo;&nbsp;\u4e0a\u4e00\u6b65 </a>\n</form>\n</div>\n<div id="saveToMymapDiv" style=\'display:none;font-size:12px;color:#000;background:#E5ECF9;margin-top:0px;padding:3px 0 0 3px;clear:both;\'>\n<table>\n<tr><td colspan="2">\u60a8\u60f3\u8981\u4fdd\u5b58\u5230\u54ea\u4e00\u4e2a\u5730\u56fe\u4e2d\uff1f</td></tr>\n<tr><td id=\'maplist_s\'></td><td><input type="button" value=" \u4fdd \u5b58 " onclick="saveRsPoi(\'${obj.objId}\',\''+m+'\',\'${obj.description}\')"></td></tr>\n</table>\n</div>\n<div id="saveInfo" style=\'display:none;padding-top:3px;font-size:12px;color:#000;background:#E5ECF9;\'></div>\n<div id="prestep" style=\'display:none;padding-top:3px;font-size:12px;color:#000;background:#E5ECF9;\'><a href=\'javascript:void(0);\' onclick=\'showTipDiv("tipdiv","saveToMymapDiv");showTipDiv("tipdiv","saveInfo");showTipDiv("tipdiv","prestep");\'>&nbsp;&laquo;\u4e0a\u4e00\u6b65</a></div>\n';n.appendChild(A);return n},S$228:function(a){return'<img src="'+strImgsvrUrl+'images/newbubbleimg/mbblank.gif" style="position:absolute;left: '+(a==0?"-89":"-103")+"px; top: 0px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;">'}};if(typeof SN_7=="undefined"){function SN_7(b,a){if(b){document.getElementById(a).style.display="none"}if(a){document.getElementById(b).style.display=""}}}if(typeof W7WF=="undefined"){function W7WF(a,c,b){if(a){document.getElementById(a).style.display=""}if(c){document.getElementById(c).style.display="none"}if(b){document.getElementById(b).style.display="none"}}}if(typeof C1dR6=="undefined"){function C1dR6(f,d,e,a,c,g,b){if($Llu.G2eW([g])){c24("#ac=nb&poitype="+lO4(g)+"&city="+lO4(e)+"&pid="+lO4(c,1),"nb")}}}if(typeof Nryb=="undefined"){function Nryb(g,d,f,a,e,c,b){if($Llu.G2eW([c])){c24("#ac=bus&origName="+lO4(e,1)+"&destName="+lO4(c,1)+"&city="+lO4(f),"bus")}}}if(typeof y2YJ=="undefined"){function y2YJ(g,d,f,a,e,c,b){if($Llu.G2eW([c])){c24("#ac=nav&origName="+lO4(e,1)+"&destName="+lO4(c,1)+"&origCity="+lO4(f)+"&destCity="+lO4(f),"nav")}}}if(typeof roW=="undefined"){function roW(g,d,f,a,e,c,b){if($Llu.G2eW([c])){c24("#ac=bus&destName="+lO4(e,1)+"&origName="+lO4(c,1)+"&city="+lO4(f),"bus")}}}if(typeof $41j=="undefined"){function $41j(g,d,f,a,e,c,b){if($Llu.G2eW([c])){c24("#ac=nav&destName="+lO4(e,1)+"&origName="+lO4(c,1)+"&origCity="+lO4(f)+"&destCity="+lO4(f),"nav")}}}if(typeof $Y33_=="undefined"){function $Y33_(a,c,d){mQo=k80v._DU62(d);var b=mQo.y2j||"";$n5(a,c,b)}}if(typeof c24=="undefined"){function c24(a,b){if(b=="nb"){a=$qs+"/mapview/index.jsp"+a}if(b=="bus"){a=uLQB+"/mapview/index.jsp"+a}if(b=="nav"){a=w8WC+"/mapview/index1.jsp"+a}window.open(a,"","")}}if(typeof $Llu=="undefined"){var $Llu={yo4AU:function(c,a){for(var b=0;b<c.length;b++){if(c[b].value.replace(new RegExp(" ","gm"),"")==""){c[b].focus();return false}}return true},G2eW:function(c,a){for(var b=0;b<c.length;b++){if(c[b].replace(new RegExp(" ","gm"),"")==""){return false}}return true}}}if(typeof lO4=="undefined"){function lO4(b,a){if(a){return cEC(SxHHV(b))}return encodeURI(_01(b))}}if(typeof a114=="undefined"){function a114(b,a){if(a){return SxHHV(SxHHV(b))}return _01(_01(b))}}if(typeof _Fl=="undefined"){function _Fl(b,c){var a=C5d(b);var e=a.name;var d=a.getText("/localsearch/js/template/feedback.html?r="+Vu3F());RKbL9(a,e,d)}}function OverView(maplet){this.maplet=maplet;document["mapbar-overview"]=this;this.mapName="mapbar";var O7A07=0;var sC9=0;var oY67=0;var H29r=0;this.c3=oo;this.visible=true;this.panel=document.createElement("div");this.panel.unselectable="on";this.panel.style.position="absolute";this.panel.style.zIndex=999;this.panel.style.backgroundColor="white";this.panel.style.border="1px solid #A6A5A1";this.panel.setAttribute(disableMw,true);this.panel.style.overflow="hidden";this.panel.style.display="none";this.canvas=document.createElement("div");this.canvas.id="mapbar-overview-canvas";this.canvas.unselectable="on";this.canvas.style.position="absolute";this.canvas.style.visibility="visible";this.canvas.style.zIndex=0;this.canvas.style.top=(uU-2)+"px";this.canvas.style.left=(isIE)?"5px":"7px";this.canvas.style.backgroundColor=MapBackgroundColor;this.canvas.style.border="2px solid #0E347F";this.canvas.style.overflow="hidden";this.canvas.selected=false;this.panel.appendChild(this.canvas);this.viewport=document.createElement("div");this.viewport.id="mapbar-overview-viewport";this.viewport.unselectable="on";this.canvas.appendChild(this.viewport);this.viewframe=document.createElement("div");this.viewframe.id="mapbar-overview-viewframe";this.viewframe.unselectable="on";this.canvas.appendChild(this.viewframe);this.viewpad_ctrl=document.createElement("div");this.viewpad_ctrl.id="mapbar-overview-viewpad_ctrl";this.viewpad_ctrl.unselectable="on";this.viewpad_ctrl.style.MozUserSelect="none";this.canvas.appendChild(this.viewpad_ctrl);this.viewpad_ctrl.style.cursor="move";this.viewpad_ctrl.selected=false;this.events=new Array();this.cW=0;this.C5Y=[2,4,8,6];this.shadow=document.createElement("div");this.shadow.unselectable="on";this.shadow.style.position="absolute";this.shadow.style.zIndex=998;this.shadow.setAttribute(disableMw,true);this.shadow.style.display="none";var panMapTimer=null;var F2813=null;this.OvwImgs=new MDiv("OvwImgs",0,0,0,0,true,0,"",this.canvas);this.show=function(){this.visible=true};this.hide=function(){this.visible=false};this.nF=function(){if(this.visible){if(this.c3){return filter2Num(this.shadow.style.top)}else{return H29r}}else{return 0}};this.GgeM=function(){if(this.visible){if(this.c3){return filter2Num(this.shadow.style.left)}else{return oY67}}else{return 0}};this.getHeight=function(){if(this.visible){if(this.c3){return filter2Num(this.shadow.offsetHeight)}else{return filter2Num(this.img.offsetHeight)}}else{return 0}};this.mousedown=function(_event){stopEventBubble(_event);if(this.cW!=0){return}if(_event.target.id==this.viewpad_ctrl.id||ooDragType==this.viewpad_ctrl.id){ooDragType=this.viewpad_ctrl.id;this.viewpad_ctrl.selected=true;this.downX=(isIE)?event.clientX:_event.clientX;this.downY=(isIE)?event.clientY:_event.clientY;this.firstX=this.downX;this.firstY=this.downY}else{if(isTarget(_event.target,this.canvas)||ooDragType==this.canvas.id){ooDragType=this.canvas.id;this.canvas.selected=true;this.downX=(isIE)?event.clientX:_event.clientX;this.downY=(isIE)?event.clientY:_event.clientY;this.firstX=this.downX;this.firstY=this.downY}}if(ooDragType){this.events.doc_mousemove=MEvent.bindDom(document,"mousemove",this,this.mousemove);this.events.doc_mouseup=MEvent.bindDom(document,"mouseup",this,this.mouseblur);if(isIE){this.events.losecapture=MEvent.bindDom(document.body,"losecapture",this,this.mouseblur)}else{this.events.blur=MEvent.bindDom(window,"blur",this,this.mouseblur)}}};this.mousemove=function(_event){if(ooDragType==this.viewpad_ctrl.id&&this.viewpad_ctrl.selected){this.curX=(isIE)?event.clientX:_event.clientX;this.curY=(isIE)?event.clientY:_event.clientY;var offsetX=(this.curX-this.downX);var offsetY=(this.curY-this.downY);this.downX=this.curX;this.downY=this.curY;if(this.viewpad_ctrl.style.top){this.viewpad_ctrl.style.top=(parseInt(this.viewpad_ctrl.style.top)+offsetY)+"px";this.viewpad_ctrl.style.left=(parseInt(this.viewpad_ctrl.style.left)+offsetX)+"px"}}else{if(ooDragType==this.canvas.id&&this.canvas.selected){this.curX=(isIE)?event.clientX:_event.clientX;this.curY=(isIE)?event.clientY:_event.clientY;var offsetX=(this.curX-this.downX);var offsetY=(this.curY-this.downY);this.downX=this.curX;this.downY=this.curY;this.OvwImgs.style.top=(parseInt(this.OvwImgs.style.top)+offsetY)+"px";this.OvwImgs.style.left=(parseInt(this.OvwImgs.style.left)+offsetX)+"px";if(this.viewport.style.top){this.viewport.style.top=(parseInt(this.viewport.style.top)+offsetY)+"px";this.viewport.style.left=(parseInt(this.viewport.style.left)+offsetX)+"px";this.viewframe.style.top=(parseInt(this.viewframe.style.top)+offsetY)+"px";this.viewframe.style.left=(parseInt(this.viewframe.style.left)+offsetX)+"px"}}}if(!panMapTimer&&this.viewpad_ctrl.offsetWidth<this.canvas.offsetWidth){if(isIE){document.body.setCapture()}panMapTimer=getInterval(this,x46B,100);F2813=getInterval(this,monitor,100)}};this.mouseblur=function(_event){if(this.maplet.mapMode!=mapMode.snapshot&&this.maplet.mapMode!=mapMode.zoomin&&this.maplet.mapMode!=mapMode.zoomout&&this.maplet.mapMode!=mapMode.lookup){stopEventBubble(_event)}if(panMapTimer){this.maplet.hideBubble();window.clearInterval(panMapTimer);panMapTimer=null;window.clearInterval(F2813);F2813=null;if(isIE){document.body.releaseCapture()}}if(this.events.doc_mousemove){MEvent.removeBuiltInListener(document,"mousemove",this.events.doc_mousemove);this.events.doc_mousemove=null;MEvent.removeBuiltInListener(document,"mouseup",this.events.doc_mouseup);this.events.doc_mouseup=null;if(isIE){MEvent.removeBuiltInListener(document.body,"losecapture",this.events.losecapture);this.events.losecapture=null}else{MEvent.removeBuiltInListener(window,"blur",this.events.blur);this.events.blur=null}}if(this.viewpad_ctrl.selected){ooDragType=null;this.viewpad_ctrl.selected=false;var lastX=(isIE)?event.clientX:_event.clientX;var lastY=(isIE)?event.clientY:_event.clientY;if(typeof lastX=="undefined"){lastX=this.curX}if(typeof lastY=="undefined"){lastY=this.curY}var offsetX=(lastX-this.firstX-filter2Num(this.OvwImgs.style.left));var offsetY=(lastY-this.firstY-filter2Num(this.OvwImgs.style.top));var offsetLat=-offsetY*this.clipLatRange/this.maplet.imgHeight;var offsetLon=offsetX*this.clipLonRange/this.maplet.imgWidth;this.ooAfterDragCenterLat=this.maplet.centerLat+offsetLat;this.ooAfterDragCenterLon=this.maplet.centerLon+offsetLon;this.cW=1;var left=filter2Num(this.viewpad_ctrl.style.left);if(left<-this.viewpad_ctrl.offsetWidth){left=-this.viewpad_ctrl.offsetWidth}else{if(left>=this.canvas.offsetWidth){left=this.canvas.offsetWidth}}var top=parseInt(this.viewpad_ctrl.style.top);if(top<-this.viewpad_ctrl.offsetHeight){top=-this.viewpad_ctrl.offsetHeight}else{if(top>=this.canvas.offsetHeight){top=this.canvas.offsetHeight}}this.viewpad_ctrl.style.left=left+"px";this.viewpad_ctrl.style.top=top+"px";this.timeoutHandler=getTimeout(this,this.vO,20)}else{if(this.canvas.selected){ooDragType=null;this.canvas.selected=false;var lastX=(isIE)?event.clientX:_event.clientX;var lastY=(isIE)?event.clientY:_event.clientY;var offsetX=-(lastX-this.firstX);var offsetY=-(lastY-this.firstY);var offsetLat=-offsetY*this.clipLatRange/this.maplet.imgHeight;var offsetLon=offsetX*this.clipLonRange/this.maplet.imgWidth;this.ooAfterDragCenterLat=this.maplet.centerLat+offsetLat;this.ooAfterDragCenterLon=this.maplet.centerLon+offsetLon;this.cW=2;var left=filter2Num(this.viewport.style.left);if(left<-this.viewport.offsetWidth){left=-this.viewport.offsetWidth}else{if(left>=this.canvas.offsetWidth){left=this.canvas.offsetWidth}}var top=parseInt(this.viewport.style.top);if(top<-this.viewport.offsetHeight){top=-this.viewport.offsetHeight}else{if(top>=this.canvas.offsetHeight){top=this.canvas.offsetHeight}}this.viewport.style.left=left+"px";this.viewport.style.top=top+"px";this.viewframe.style.left=left+"px";this.viewframe.style.top=top+"px";this.timeoutHandler=getTimeout(this,this.vO,20)}}};var _stopEventBubble=function(_event){stopEventBubble(_event)};this.vO=function(){if(this.timeoutHandler){clearTimeout(this.timeoutHandler);this.timeoutHandler=null}if(!this.viewport.style.top||!this.viewpad_ctrl.style.top){this.maplet.setCenter(this.ooAfterDragCenterLat,this.ooAfterDragCenterLon,true);this.cW=0;return}var offsetY=parseInt(this.viewpad_ctrl.style.top)-parseInt(this.viewport.style.top);var offsetX=parseInt(this.viewpad_ctrl.style.left)-parseInt(this.viewport.style.left);var gN=Math.round(offsetX);var gO=Math.round(offsetY);if((Math.abs(offsetX)+Math.abs(offsetY))>=10){var gN=Math.round(offsetX*10/(Math.abs(offsetX)+Math.abs(offsetY)));var gO=Math.round(offsetY*10/(Math.abs(offsetX)+Math.abs(offsetY)))}if(this.cW==2){if((Math.abs(offsetX)+Math.abs(offsetY))==0){this.maplet.setCenter(this.ooAfterDragCenterLat,this.ooAfterDragCenterLon,true);this.cW=0}else{this.viewport.style.top=(parseInt(this.viewport.style.top)+gO)+"px";this.viewport.style.left=(parseInt(this.viewport.style.left)+gN)+"px";this.viewframe.style.top=(parseInt(this.viewframe.style.top)+gO)+"px";this.viewframe.style.left=(parseInt(this.viewframe.style.left)+gN)+"px";this.timeoutHandler=getTimeout(this,this.vO,20)}}else{if(this.cW==1){gN=-gN;gO=-gO;if((Math.abs(offsetX)+Math.abs(offsetY))==0){this.maplet.setCenter(this.ooAfterDragCenterLat,this.ooAfterDragCenterLon,true);this.cW=0}else{for(var i in this.Clip){if(typeof this.Clip[i]=="object"&&(this.Clip[i]!=null)){this.Clip[i].style.top=(parseInt(this.Clip[i].style.top)+gO)+"px";this.Clip[i].style.left=(parseInt(this.Clip[i].style.left)+gN)+"px"}}this.viewpad_ctrl.style.top=(parseInt(this.viewpad_ctrl.style.top)+gO)+"px";this.viewpad_ctrl.style.left=(parseInt(this.viewpad_ctrl.style.left)+gN)+"px";this.timeoutHandler=getTimeout(this,this.vO,20)}}}};this.Clip=new Array();this.timer=null;this.c4=false;this.cl=false;this.sa=new Array();this.getWidth=function(){if(this.visible&&this.c3){return OVER_WIN_WIDTH}else{return uS}};this.addListener=function(uy){this.sa[uy.id]=uy};this.removeListener=function(uy){this.sa[uy.id]=null};this.uq=function(){for(var pf in this.sa){if(this.sa[pf]&&this.sa[pf].onresize){this.sa[pf].onresize()}}this.maplet.onresize()};this.g1=function(){for(var pf in this.sa){if(this.sa[pf]){this.sa[pf]=null}this.sa=null}this.clearImgs();this.Clip=null;for(var l8 in this.events){try{if(this.events[l8]!=null){MEvent.removeBuiltInListener(this.canvas,l8,this.events[l8]);this.events[l8]=null}}catch(_event){}this.events=null}this.img.overview=null;this.img.onclick=null;this.img.onmousedown=null;this.img.onmouseup=null;this.img.ondblclick=null;this.viewpad_ctrl.mousedown=null;this.viewpad_ctrl.mousemove=null;if(this.panel.parentNode!=null){removeNode(this.panel)}this.maplet=null};this.onresize=function(){this.setPosition();this.uq()};this.close=function(){if(this.cl){return}if(typeof this.img=="undefined"){this.c3=oo=false;return}else{if(this.img.style.display=="none"&&this.c3){this.c3=oo=false}}clearTimer.apply(this);this.cl=true;this.timer=getTimeout(this,closeOverview,10);this.c4=false;this.uq()};this.open=function(){if(typeof this.img=="undefined"){this.c3=oo=true;return}if(this.c4){return}clearTimer.apply(this);this.c4=true;this.timer=getTimeout(this,_eD$,10);this.cl=false};this.qa=function(container){var An=(isIE)?0:2;this.img=document.createElement("div");this.img.unselectable="on";this.img.style.position="absolute";this.img.style.zIndex=1000;this.img.overview=this;this.img.style.cursor=(isIE)?"hand":"pointer";this.img.style.overflow="hidden";this.img.style.display="none";this.$90=document.createElement("img");this.$90.unselectable="on";this.$90.style.position="absolute";this.$90.src=CTLIMG_RESOURCE[0].url;this.$90.style.width=CTLIMG_RESOURCE[0].w+"px";this.$90.style.height=CTLIMG_RESOURCE[0].h+"px";this.$90.ohT15="no";if(isIE){this.img.style.filter="alpha(opacity=0)"}else{this.img.style.opacity="0"}this.img.onmousedown=function(_event){stopEventBubble(_event||window.event)};this.img.onmouseup=function(_event){this.overview.mouseblur(_event);stopEventBubble(_event||window.event)};this.img.ondblclick=function(_event){stopEventBubble(_event||window.event)};this.img.onclick=function(_event){stopEventBubble(_event||window.event);if(this.overview.c3){this.overview.close()}else{this.overview.open()}};container.appendChild(this.img);this.img.appendChild(this.$90);container.appendChild(this.panel);container.appendChild(this.shadow);this.events.mousedown=MEvent.bindDom(this.canvas,"mousedown",this,this.mousedown);this.events.mouseup=MEvent.bindDom(this.canvas,"dblclick",this,_stopEventBubble);this.onresize();if(!this.visible){return}if(oo){this.open()}else{this.close()}};this.clearImgs=function(){for(var i in this.Clip){o13.apply(this,[i])}};var o13=function(id){try{if(this.Clip[id]!=null){removeNode(this.Clip[id]);this.Clip[id].onmousedown=null;this.Clip[id].onerror=null;this.Clip[id].onload=null;this.Clip[id]=null;delete this.Clip[id]}}catch(_event){}};var f6oO=function(){for(var i in this.Clip){if(this.Clip[i]&&!this.Clip[i].isShow){o13.apply(this,[i])}}};this.paint=function(){if(!this.c3||!this.visible){return}this.width=OVER_WIN_WIDTH-10;this.height=OVER_WIN_HEIGHT-10;this.centerLat=this.maplet.centerLat;this.centerLon=this.maplet.centerLon;this.zoomLevel=Math.max(Math.max(0,minZoomLevel-2),uW[this.maplet.zoomLevel]);this.imgWidth=this.maplet.imgWidth;this.imgHeight=this.maplet.imgHeight;this.ext=this.maplet.ext;if(this.mapName!=this.maplet.mapName){this.mapName=this.maplet.mapName;this.clearImgs()}var appName=this.mapName;this.halfNum5clipX=Math.ceil((this.width)/(this.imgWidth)/2);this.halfNum5clipY=Math.ceil((this.height)/(this.imgHeight)/2);this.clipLonRange=cutImgLonRange[this.zoomLevel];this.clipLatRange=cutImgLatRange[this.zoomLevel];this.levelFolder=levelFolder[this.zoomLevel]+"/";this.clipNo5X=Math.floor((this.maplet.centerLon)/this.clipLonRange);this.clipNo5Y=Math.floor((this.maplet.centerLat)/this.clipLatRange);if(this.clipNo5X<0){this.clipNo5X+=1}this.mapX=this.width/2-Math.round(((this.centerLon*multiple)%(this.clipLonRange*multiple))*this.imgWidth/(this.clipLonRange*multiple));if(this.centerLat>=0){this.mapY=this.height/2-this.imgHeight+Math.round(((this.centerLat*multiple)%(this.clipLatRange*multiple))*this.imgHeight/(this.clipLatRange*multiple))}else{this.mapY=this.height/2+Math.round(((this.centerLat*multiple)%(this.clipLatRange*multiple))*this.imgHeight/(this.clipLatRange*multiple))}var _blockSize=blockSize[this.zoomLevel];this.sZ=0;this.s1=0;this.tf1=this.width;this.tg=this.height;this.s2=parseInt(this.clipNo5X);this.s3=parseInt(this.clipNo5Y);this.th=parseInt(this.clipNo5X);this.ti=parseInt(this.clipNo5Y);var clipXNum=(360/cutImgLonRange[this.zoomLevel]);this.rotationCosVal=1;this.rotationSinVal=0;for(var i in this.Clip){if(this.Clip[i]!=null){this.Clip[i].isShow=false}}for(qx=-this.halfNum5clipX-1;qx<=this.halfNum5clipX;qx++){for(qz=-this.halfNum5clipY-1;qz<=this.halfNum5clipY;qz++){try{var _strImgUrl=this.maplet.strImgUrl+"mapbank/"+appName+"/"+this.levelFolder;if(this.zoomLevel>=14){_strImgUrl+=folderX+"/"}var qy=parseInt(this.clipNo5X+qx);var qA=parseInt(this.clipNo5Y+qz);qy=(qy)%clipXNum;if(qy>=(clipXNum/2)){qy-=clipXNum}if(qy<(-clipXNum/2)){qy+=clipXNum}var folderX=parseInt(Math.floor((qy)/_blockSize));var folderY=parseInt(Math.floor((qA)/_blockSize));if(folderX<0){folderX+=1}if(folderY<0){folderY+=1}var fileXNo=(qy)-folderX*_blockSize;var fileYNo=(qA)-folderY*_blockSize;_strImgUrl+=folderX+"_"+folderY+"/";_strImgUrl+=fileXNo+"_"+fileYNo+"."+this.ext;var clipLeft=(qx*this.imgWidth)+parseInt(this.mapX);var p3=(-(qz*this.imgHeight)+parseInt(this.mapY));var p4=p3;if(this.mapName!="aerial"&&this.mapName.indexOf("aerial")<0){p3=p3+w8[this.zoomLevel]}if(clipLeft<-this.imgWidth||clipLeft>this.width||p3>this.height||p3<-this.imgHeight){continue}if(this.sZ<(clipLeft+this.imgWidth)){this.sZ=(clipLeft+this.imgWidth);this.s2=parseInt(this.clipNo5X)+parseInt(qx)}if(this.s1<(p3+this.imgHeight)){this.s1=(p3+this.imgHeight);this.ti=parseInt(this.clipNo5Y)+parseInt(qz)}if(this.tf1>clipLeft){this.tf1=clipLeft;this.th=parseInt(this.clipNo5X)+parseInt(qx)}if(this.tg>p3){this.tg=p3;this.s3=parseInt(this.clipNo5Y)+parseInt(qz)}var clipId="__ov_ctrl_"+((this.zoomLevel).toString(16)+(this.clipNo5X+qx).toString(16)+"l"+(this.clipNo5Y+qz).toString(16)).toLowerCase();if(_strImgUrl&&_strImgUrl.indexOf("NaN")<0){if(this.Clip[clipId]==null){this.Clip[clipId]=new Image();this.Clip[clipId].id=clipId;this.Clip[clipId].name=clipId;this.Clip[clipId].ntry="0";this.Clip[clipId].unselectable="on";this.Clip[clipId].style.position="absolute";this.Clip[clipId].onmousedown=function(){return false};this.Clip[clipId].ohT15="no";this.Clip[clipId].src=_strImgUrl}var p2=(clipLeft+this.imgWidth/2-this.width/2)*this.rotationCosVal-(p3+this.imgHeight/2-this.height/2)*this.rotationSinVal+this.width/2;var p5=(clipLeft+this.imgWidth/2-this.width/2)*this.rotationSinVal+(p3+this.imgHeight/2-this.height/2)*this.rotationCosVal+this.height/2;this.Clip[clipId].style.top=parseInt(p5-this.imgHeight/2)+"px";this.Clip[clipId].style.left=parseInt(p2-this.imgWidth/2)+"px";this.Clip[clipId].isShow=true}_strImgUrl=null;clipId=null}catch(_event){}}}for(var i in this.Clip){var img=this.Clip[i];if(img&&img.isShow&&img.parentNode!=this.OvwImgs){this.OvwImgs.appendChild(img)}}f6oO.apply(this);C38.apply(this);this.OvwImgs.style.top=this.OvwImgs.style.left="0px"};var C38=function(){var Ae=parseInt(this.maplet.width*this.maplet.clipLonRange/this.clipLonRange);var zZ=parseInt(this.maplet.height*this.maplet.clipLatRange/this.clipLatRange);if(Ae>this.width&&zZ>this.height){QlX.apply(this,[false])}else{this.viewport.style.left=parseInt(this.width-Ae)/2+"px";this.viewport.style.top=parseInt(this.height-zZ)/2+"px";this.viewport.style.width=(Ae)+"px";this.viewport.style.height=(zZ)+"px";this.viewframe.style.left=parseInt(this.width-Ae)/2+"px";this.viewframe.style.top=parseInt(this.height-zZ)/2+"px";this.viewframe.style.width=(Ae)+"px";this.viewframe.style.height=(zZ)+"px";this.viewpad_ctrl.style.left=parseInt(this.width-Ae)/2+"px";this.viewpad_ctrl.style.top=parseInt(this.height-zZ)/2+"px";this.viewpad_ctrl.style.width=(Ae)+"px";this.viewpad_ctrl.style.height=(zZ)+"px";QlX.apply(this,[true])}};var QlX=function(visible){this.viewport.style.visibility=visible?"visible":"hidden";this.viewframe.style.visibility=visible?"visible":"hidden";this.viewpad_ctrl.style.visibility=visible?"visible":"hidden"};this.getRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0}};if(typeof this.img!="undefined"){var o5H7u=(this.panel.style.display!="none");var iD$3=(this.img.style.display!="none");if(o5H7u||iD$3){var d=this.c3?this.shadow:this.img;r={min:{x:d.offsetLeft,y:d.offsetTop},max:{x:0,y:0}};r.max.x=r.min.x+d.offsetWidth;r.max.y=r.min.y+d.offsetHeight}}return r};var closeOverview=function(){var o5H7u=(this.panel.style.display!="none");if(this.visible){this.img.style.display=""}this.uq();clearTimer.apply(this);QlX.apply(this,[false]);this.shadow.style.display="none";if(this.visible||o5H7u){with(this.panel.style){if(isIE){filter="alpha(opacity=100)"}else{opacity="1"}}}if(this.visible){with(this.$90.style){left="-26px";top="-124px"}}with(this.img.style){if(isIE){filter="alpha(opacity=0)"}else{opacity="0"}}var yw=0,d=10;var p={b:0,c:1};var xvd3={b:0,c:1};function h8425(){if(yw<d){yw++;if(isIE){this.panel.style.filter="alpha(opacity="+(100-hfIV7(yw,p.b,p.c,d)*100)+")";if(this.visible){this.img.style.filter="alpha(opacity="+hfIV7(yw,xvd3.b,xvd3.c,d)*100+")"}else{this.img.style.filter="alpha(opacity="+(100-hfIV7(yw,xvd3.b,xvd3.c,d)*100)+")"}}else{this.panel.style.opacity=1-hfIV7(yw,p.b,p.c,d);if(this.visible){this.img.style.opacity=hfIV7(yw,xvd3.b,xvd3.c,d)}else{this.img.style.opacity=1-hfIV7(yw,xvd3.b,xvd3.c,d)}}this.timer=getTimeout(this,h8425,100)}else{this.panel.style.display="none";this.img.style.display=this.visible?"":"none";this.cl=false;this.c3=false;this.uq()}}h8425.apply(this)};var _eD$=function(){if(this.panel.style.display!="none"){return}clearTimer.apply(this);QlX.apply(this,[false]);with(this.panel.style){display=this.visible?"":"none";if(isIE){filter="alpha(opacity=0)"}else{opacity="0"}}with(this.img.style){display=this.visible?"":"none";if(isIE){filter="alpha(opacity=0)"}else{opacity="0"}}with(this.$90.style){top="-125px";left="-42px"}var yw=0,d=10;var p={b:0,c:1};var xvd3={b:0,c:1};function h8425(){if(yw<d){yw++;if(isIE){this.panel.style.filter="alpha(opacity="+hfIV7(yw,p.b,p.c,d)*100+")";this.img.style.filter="alpha(opacity="+hfIV7(yw,xvd3.b,xvd3.c,d)*100+")"}else{this.panel.style.opacity=hfIV7(yw,p.b,p.c,d);this.img.style.opacity=hfIV7(yw,xvd3.b,xvd3.c,d)}this.timer=getTimeout(this,h8425,100)}else{if(isIE){this.panel.style.filter=null}else{this.shadow.style.opacity=1}this.shadow.style.display=this.visible?"":"none";this.c4=false;this.c3=true;this.uq();this.paint()}}h8425.apply(this)};var clearTimer=function(){if(this.timer){window.clearTimeout(this.timer);this.timer=null}};var hfIV7=function(yw,b,c,d){if(yw==0){return b}if(yw==d){return b+c}if((yw/=d/2)<1){return c/2*Math.pow(2,10*(yw-1))+b}return c/2*(-Math.pow(2,-10*--yw)+2)+b};this.resetLocation=function(location){location=location||{};if(typeof location.type!="number"&&!(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM||location.type==Maplet.RIGHT_TOP||location.type==Maplet.LEFT_BOTTOM)){location.type=Maplet.RIGHT_BOTTOM}if(typeof location.marginx!="number"){location.marginx=6}if(typeof location.marginy!="number"){location.marginy=6}return location};this.setLocation=function(location){this.location=this.resetLocation(location);this.setPosition()};this.resizeTo=function(w,h){if(typeof w!="number"){w=150}else{if(w<100){w=100}else{if(w>210){w=210}}}if(typeof h!="number"){h=140}else{if(h<100){h=100}else{if(h>210){h=210}}}OVER_WIN_WIDTH=w;OVER_WIN_HEIGHT=h;this.onresize();this.paint()};var A9VR=function(){with(this.location){if(type==Maplet.LEFT_TOP){O7A07=marginx;sC9=marginy;oY67=O7A07+OverView.i8w3+4;H29r=sC9+OverView.cNmc+4}else{if(type==Maplet.LEFT_BOTTOM){O7A07=marginx;sC9=this.maplet.height-OVER_WIN_HEIGHT-marginy;oY67=O7A07+OverView.i8w3+4;H29r=sC9+OVER_WIN_HEIGHT-uS-OverView.cNmc-1}else{if(type==Maplet.RIGHT_TOP){O7A07=this.maplet.width-OVER_WIN_WIDTH-marginx;sC9=marginy;oY67=O7A07+OVER_WIN_WIDTH-uS-OverView.i8w3-2;H29r=sC9+OverView.cNmc+4}else{if(type==Maplet.RIGHT_BOTTOM){O7A07=this.maplet.width-OVER_WIN_WIDTH-marginx;sC9=this.maplet.height-OVER_WIN_HEIGHT-marginy;oY67=O7A07+OVER_WIN_WIDTH-uS-OverView.i8w3-2;H29r=sC9+OVER_WIN_HEIGHT-uS-OverView.cNmc-1}}}}}};this.setPosition=function(){A9VR.apply(this);with(this.panel.style){width=OVER_WIN_WIDTH+"px";height=OVER_WIN_HEIGHT+"px";left=O7A07+"px";top=sC9+"px"}with(this.shadow.style){width=OVER_WIN_WIDTH+OverView.sUp+"px";height=OVER_WIN_HEIGHT+OverView.sUp+"px";left=O7A07-OverView.sUp/2+"px";top=sC9-OverView.sUp/2+"px"}with(this.canvas.style){width=OVER_WIN_WIDTH-OverView.i8w3*2-filter2Num(borderWidth)*2+"px";height=OVER_WIN_HEIGHT-OverView.cNmc*2-filter2Num(borderWidth)*2+"px";left=OverView.i8w3+"px";top=OverView.cNmc+"px"}with(this.OvwImgs.style){width=this.canvas.style.width;height=this.canvas.style.height;top=left="0px"}with(this.img.style){width=uS+"px";height=uS+"px";left=oY67+"px";top=H29r+"px"}with(this.$90.style){if(this.c3){top="-125px";left="-42px"}else{left="-26px";top="-124px"}}this.shadow.innerHTML="";if(isIE6){for(var i=0;i<this.C5Y.length;i++){var N0M=document.createElement("div");N0M.unselectable="on";N0M.style.position="absolute";N0M.style.zIndex=i;N0M.style.backgroundColor="black";N0M.setAttribute(disableMw,true);N0M.style.left=i*2+"px";N0M.style.top=i*2+"px";N0M.style.width=(OVER_WIN_WIDTH+(this.C5Y.length-i)*4+2)+"px";N0M.style.height=(OVER_WIN_HEIGHT+(this.C5Y.length-i)*4+2)+"px";if(isIE){N0M.style.filter="alpha(opacity="+this.C5Y[i]+")"}else{N0M.style.opacity=this.C5Y[i]/100}this.shadow.appendChild(N0M)}}else{var x=OverView.sUp/2-OverView.rVM;var y=x;var w=OverView.a3$;var h=OverView.a3$;var s=['<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-28px;top:-103px;"></div>'];x+=OverView.a3$;w=OVER_WIN_WIDTH-OverView.a3$+1;h=OverView.rVM;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:0px;top:-226px;"></div>');x+=w;w=OverView.a3$;h=w;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-38px;top:-103px;"></div>');x=OVER_WIN_WIDTH+OverView.a3$+OverView.rVM;y+=OverView.a3$;h=OVER_WIN_HEIGHT-OverView.a3$+1;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-81px;top:0px;"></div>');x=x-OverView.rVM-1;y+=h;w=OverView.a3$;h=w;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-38px;top:-113px;"></div>');x=OverView.sUp/2-OverView.rVM+OverView.a3$;y+=OverView.rVM+1;w=OVER_WIN_WIDTH-OverView.a3$+1;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:0px;top:-229px;"></div>');x=OverView.sUp/2-OverView.rVM;y=y-OverView.rVM-1;w=OverView.a3$;h=w;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-28px;top:-113px;"></div>');y=OverView.sUp/2-OverView.rVM+OverView.a3$;h=OVER_WIN_HEIGHT-OverView.a3$+1;w=OverView.rVM;s.push('<div style="position:absolute;left:'+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+'px;overflow:hidden;"><img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-78px;top:0px;"></div>');this.shadow.innerHTML=s.join("")}};var x46B=function(){var rt=yKw0S.apply(this);var vj=0,vk=0;if(rt.min.x<0){vj=5}if(rt.min.y<0){vk=5}if(rt.max.x>filter2Num(this.canvas.style.width)){vj=-5}if(rt.max.y>filter2Num(this.canvas.style.height)){vk=-5}if((vj!=0||vk!=0)){this.panTo(vj,vk)}};var yKw0S=function(){var r={min:{x:this.viewpad_ctrl.offsetLeft,y:this.viewpad_ctrl.offsetTop},max:{x:0,y:0}};r.max.x=r.min.x+this.viewpad_ctrl.offsetWidth;r.max.y=r.min.y+this.viewpad_ctrl.offsetHeight;return r};this.panTo=function(x,y){this.OvwImgs.style.top=filter2Num(this.OvwImgs.style.top)+y+"px";this.OvwImgs.style.left=filter2Num(this.OvwImgs.style.left)+x+"px"};var monitor=function(){if(this.fs||this.c0){return}var sP=parseInt(this.OvwImgs.style.left);var sQ=parseInt(this.OvwImgs.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0||(sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){this.fs=true;zA.apply(this)}};var zA=function(){if(this.fs==false){return}var sP=parseInt(this.OvwImgs.style.left);var sQ=parseInt(this.OvwImgs.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0){if(this.c0==true){return}this.c0=true;var qy=0;var p1=0;if((sP+this.tf1)>=0){this.th--;this.tf1-=parseInt(this.imgWidth);qy=this.th;p1=this.tf1}if((sP+this.sZ-this.width)<=0){this.s2++;p1=this.sZ;this.sZ+=parseInt(this.imgWidth);qy=this.s2}var qx=qy;var _blockSize=blockSize[this.zoomLevel];var clipXNum=parseInt(360/cutImgLonRange[this.zoomLevel]);qy=(qy)%clipXNum;if(qy>=(clipXNum/2)){qy-=clipXNum}if(qy<(-clipXNum/2)){qy+=clipXNum}var appName=this.mapName;for(var qz=this.ti;qz<=this.s3;qz++){var qA=qz;var p3=(-(qz-this.ti+1)*this.imgHeight)+this.s1;aA.apply(this,[p1,p3,qy,qA,qx,qz,appName])}this.c0=false}if((sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){if(this.c0==true){return}this.c0=true;var qA=0;var p3=0;if((sQ+this.tg)>=0){this.s3++;this.tg-=parseInt(this.imgHeight);qA=this.s3;p3=this.tg}if((sQ+this.s1-this.height)<=0){this.ti--;p3=this.s1;this.s1+=parseInt(this.imgHeight);qA=this.ti}var qz=qA;var _blockSize=blockSize[this.zoomLevel];var clipXNum=parseInt(360/cutImgLonRange[this.zoomLevel]);var appName=this.mapName;for(var qx=this.th;qx<=this.s2;qx++){var qy=qx;qy=(qy)%clipXNum;if(qy>=(clipXNum/2)){qy-=clipXNum}if(qy<(-clipXNum/2)){qy+=clipXNum}var p1=((qx-this.th)*this.imgWidth)+this.tf1;aA.apply(this,[p1,p3,qy,qA,qx,qz,appName])}this.c0=false}this.fs=false};var aA=function(p1,p3,qy,qA,qx,qz,appName){var _blockSize=blockSize[this.zoomLevel];var folderX=parseInt(Math.floor((qy)/_blockSize));var folderY=parseInt(Math.floor((qA)/_blockSize));if(folderX<0){folderX+=1}if(folderY<0){folderY+=1}var fileXNo=(qy)-folderX*_blockSize;var fileYNo=(qA)-folderY*_blockSize;var _strImgUrl=this.maplet.strImgUrl.replace("img","img"+this.maplet.getImgServerId(fileXNo,fileYNo))+"mapbank/"+appName+"/"+this.levelFolder;if(this.zoomLevel>=14){_strImgUrl+=folderX+"/"}var clipId="__ov_ctrl_"+((this.zoomLevel).toString(16)+qx.toString(16)+"l"+qz.toString(16)).toLowerCase();_strImgUrl+=folderX+"_"+folderY+"/";_strImgUrl+=fileXNo+"_"+fileYNo+"."+this.ext;if(_strImgUrl&&_strImgUrl.indexOf("NaN")<0){if(this.Clip[clipId]==null){this.Clip[clipId]=new Image();this.Clip[clipId].id=clipId;this.Clip[clipId].name=clipId;this.Clip[clipId].ntry="0";this.Clip[clipId].unselectable="on";this.Clip[clipId].style.position="absolute";this.Clip[clipId].onmousedown=function(){return false};this.Clip[clipId].ohT15="no";this.Clip[clipId].src=_strImgUrl}var p2=(p1+this.imgWidth/2-this.width/2)*this.rotationCosVal-(p3+this.imgHeight/2-this.height/2)*this.rotationSinVal+this.width/2;var p5=(p1+this.imgWidth/2-this.width/2)*this.rotationSinVal+(p3+this.imgHeight/2-this.height/2)*this.rotationCosVal+this.height/2;this.Clip[clipId].style.top=parseInt(p5-this.imgHeight/2)+"px";this.Clip[clipId].style.left=parseInt(p2-this.imgWidth/2)+"px";this.Clip[clipId].isShow=true;this.OvwImgs.div.appendChild(this.Clip[clipId]);clipId=null}_strImgUrl=null};this.location=this.resetLocation(OVER_LOCATION)}OverView.i8w3=2;OverView.cNmc=2;OverView.rVM=3;OverView.sUp=16;OverView.a3$=7;function MStandardControl(c,b,a,d){this.x6=(typeof c=="undefined")?"mapbar":c;this.left=(typeof b=="undefined")?0:parseInt(b);this.top=(typeof a=="undefined")?0:parseInt(a);this.fi=(typeof d=="undefined")?0:parseInt(d);this.id=new Date().getTime()+parseInt(Math.random()*1000);this.nR=null;this.initialize=function(e){this.maplet=e;if(this.maplet.gc[this.id]==null){if(!this.fi&&this.maplet.height<300){if(bsc){this.fi=1}}this.maplet.gc[this.id]=this;this.nR=new MControl(typeof this.x6!="object"?null:this.x6);this.nR.initialize(this.maplet);if(this.maplet.controlCanvas==null){this.maplet.controlCanvas=this.nR}}};this.remove=function(){this.maplet=null;if(this.nR){if(this.nR==this.maplet.controlCanvas){this.maplet.controlCanvas=null}this.nR.g1();this.nR=null}};this.toString=function(){return"com.mapbar.maplet.MStandardControl"}}function MLookupControl(c,b,a){this.title=(typeof c=="undefined")?getAscii("%u62CD%uCB0F%uD02B%uF3C7"):c;this.left=(typeof b=="undefined")?0:parseInt(b);this.top=(typeof a=="undefined")?0:parseInt(a);this.id=new Date().getTime()+parseInt(Math.random()*1000);this.onresize=function(d){if(this.maplet.overview.nF()<=37){this.tY.style.left=(this.maplet.width-132+this.left-this.maplet.overview.getWidth())+"px"}else{this.tY.style.left=(this.maplet.width-132+this.left)+"px"}};this.initialize=function(d){this.maplet=d;if(this.maplet.gc[this.id]==null){this.maplet.gc[this.id]=this;this.tY=document.createElement("div");this.tY.style.position="absolute";this.onresize(this.maplet);this.tY.style.top=(10+this.top)+"px";this.tY.style.zIndex=10;this.tY.style.visibility="visible";this.tU=document.createElement("img");this.tU.unselectable="on";this.tU.src=strImgsvrUrl+"images/lookup.png";this.tU.alt=this.title;this.tU.style.cursor="hand";this.tU.style.cursor="pointer";this.tU.panel=this;this.tU.maplet=this.maplet;this.tU.onclick=function(){this.maplet.setMode("lookup");MEvent.trigger(this.panel,"onclick")};this.tY.appendChild(this.tU);this.maplet.panel.appendChild(this.tY)}};this.remove=function(){this.maplet=null;if(this.tY!=null&&this.tY.parentNode!=null){this.tY.parentNode.removeChild(this.tY);this.tY=null;this.tU.maplet=null;this.tU.onclick=null;this.tU=null}};this.toString=function(){return"com.mapbar.maplet.MLookupControl"}}var MContextMenuItem=function(title,callback){this.events=[];this.title=title;this.callback=(typeof callback=="undefined")?null:callback;this.t6=document.createElement("tr");this.tW=document.createElement("td");this.tW.className="contextmenuitem";this.tW.innerHTML="&nbsp;"+title;this.t6.appendChild(this.tW);this.uK=function(_event){this.panel.hide();if(typeof this.callback=="function"&&this.callback){this.callback.apply(null,[this,this.panel,this.panel.overlay])}else{if(typeof this.callback=="string"&&this.callback){eval(this.callback)}else{MEvent.trigger(this,"select",this,this.panel,this.panel.overlay)}}};this.uG=function(_event){this.t6.style.backgroundColor="#d2e1ff"};this.uJ=function(_event){this.t6.style.backgroundColor="#FFFFFF"};this.paint=function(panel){this.panel=panel;this.panel.t8.appendChild(this.t6)};this.toString=function(){return"com.mapbar.maplet.MContextMenuItem"};this.events.click=MEvent.bindDom(this.t6,"click",this,this.uK);this.events.mouseover=MEvent.bindDom(this.t6,"mouseover",this,this.uG);this.events.mouseout=MEvent.bindDom(this.t6,"mouseout",this,this.uJ);this.remove=function(){if(this.panel){this.panel=null}for(var l8 in this.events){MEvent.removeBuiltInListener(this.t6,l8,this.events[l8]);delete this.events[l8]}this.events=null;if(this.t6){if(this.t6.parentNode){removeNode(this.t6)}this.t6=null}if(typeof this.callback=="function"&&this.callback){this.callback=null}}};var MContextMenu=function(){this.overlay=null;this.overLay={};this.f43c9="";this.qt=new Array();this.id=new Date().getTime()+parseInt(Math.random()*1000);this.tY=document.createElement("div");this.tY.className="mapcontextmenu";this.t7=document.createElement("table");this.t7.className="contextmenutable";this.t8=document.createElement("tbody");this.t7.appendChild(this.t8);this.tY.appendChild(this.t7);this.initialize=function(a){this.maplet=a;this.maplet.mapContainer.appendChild(this.tY)};this._0n=function(a){this.f43c9=a};this.X1xA=function(a){this.overlay=a};this.addOverlay=function(a){this.overLay[a.id]=a};this.removeOverlay=function(a){if(this.overLay[a.id]){if(this.overlay==this.overLay[a.id]){this.hide()}this.overLay[a.id]=null;delete this.overLay[a.id]}};this.getOverlaySize=function(){var b=0;for(var a in this.overLay){b++}return b};this.containsOverlay=function(a){return typeof this.overLay[a.id]!="undefined"&&this.overLay[a.id]};this.update=function(){for(var b in this.t8.childNodes){if(typeof this.t8.childNodes[b]=="object"){if(this.t8.childNodes[b].panel!=null){this.t8.childNodes[b].panel=null}this.t8.removeChild(this.t8.childNodes[b])}}for(var a=0;a<this.qt.length;a++){this.qt[a].paint(this)}};this.addItem=function(b,a){if(typeof a=="undefined"){this.qt[this.qt.length]=b}else{a=parseInt(a);this.qt.splice(a,0,b)}this.update()};this.finalize=function(){this.remove(true)};this.remove=function(b){if(this.getOverlaySize()>0){for(var a in this.overLay){this.overLay[a].removeContextMenu()}}if(typeof this.maplet=="object"&&this.maplet){if(this==this.maplet.stdContextMenu){this.maplet.stdContextMenu=null}this.maplet=null}if(typeof b!="boolean"){b=false}if(b){this.clear();removeNode(this.tY);this.tY=null;this.qt=null}};this.removeItem=function(a){if(a<this.qt.length){this.qt[a].remove()}this.qt.splice(a,1);this.update()};this.clear=function(){for(var a=0;a<this.qt.length;a++){this.qt[a].remove()}this.qt=new Array();this.update()};this.show=function(a,b){this.tY.style.left=parseInt(a)+"px";this.tY.style.top=parseInt(b)+"px";this.tY.style.visibility="visible"};this.hide=function(){this.tY.style.visibility="hidden"};this.toString=function(){return"com.mapbar.maplet.MContextMenu"}};var MSnapshotBox=function(a611,style){if(!(a611 instanceof Maplet)&&!a611){throw new Error("parameter para_maplet is invalid Maplet object.")}var x6=(typeof style!="string"||!style)?"":style+"/";var MJhR=SNAPSHOT_SERVER;var QAE7=SNAPSHOT_SERVER+"get";var maplet=a611;var wAWE=new Date().getTime();var ao=[];var w91oR="MSnapshotSizeTip"+wAWE;var OfWGp=w91oR+"_td";var Wcf='<table cellpadding="2" cellspacing="0" style="background-color:#0E347F;color:#ff0;font-size:14px;font-family:Arial;-moz-user-select:none;-khtml-user-select:none;user-select:none;" onselectstart="return false;"><tr><td id="'+OfWGp+'"></td></tr></table>';var Owx05=new MDiv(w91oR,0,0,0,0,false,24,Wcf,maplet.panel);Owx05.div.style.width="auto";Owx05.div.style.height="auto";var sh3="MSnapshotBox"+wAWE;var q$R1t='<table width="100%" height="100%" style="border:2px solid #0E347F;-moz-user-select:none;-khtml-user-select:none;user-select:none;" onselectstart="return false;" cellpadding="0" cellspacing="0"><tr><td style="background-color:#FFFFFF;filter:alpha(opacity=30);opacity:0.3;"></td></tr></table>';var $X3j=new MDiv(sh3,0,0,0,0,false,24,q$R1t,maplet.panel);$X3j.div.style.overflow="hidden";var Ve8=117;var d7$3=23;var ib_J7="MSnapshotBar"+wAWE;var cIj$9="MSnapshotBtn_preview_"+wAWE;var Lag3e="MSnapshotBtn_download_"+wAWE;var r5$X="MSnapshotBtn_cancel_"+wAWE;var b4w3I="";b4w3I='<font id="'+cIj$9+'" class="snapshotTextBtn">\u9884\u89c8</font><font id="'+Lag3e+'" class="snapshotTextBtn">\u4fdd\u5b58</font><font id="'+r5$X+'" class="snapshotTextBtn" style="border-right: 1px solid #0E347F;">\u53d6\u6d88</font>';var c35=new MDiv(ib_J7,0,0,0,0,false,24,b4w3I,maplet.panel);c35.style.lineHeight=d7$3+"px";var NE2="mapbar_snapshot_iframe";var iframe=null;var _s9t="mapbar_snapshot_frm";var s4723=null;var AbF9T=0;var U26V2={x:0,y:0,width:0,height:0,rect:{min:{x:0,y:0},max:{x:0,y:0}},center:""};this.yG6=false;this.pD7tE=false;this.show=function(){if(ao.length==0){ao.push(MEvent.bindDom(document.getElementById(ib_J7),"mousedown",this,jrDQq));ao.push(MEvent.bindDom(document.getElementById(cIj$9),"click",this,X4PY0));ao.push(MEvent.bindDom(document.getElementById(Lag3e),"click",this,$Ic));ao.push(MEvent.bindDom(document.getElementById(r5$X),"click",this,this.hide))}n7F();this.hide();$X3j.show();Owx05.show()};this.hide=function(){var l8=I6O1(this.hide);if(typeof l8!="undefined"&&l8){if(l8.type=="click"){var target=typeof l8.target!="undefined"?l8.target:l8.srcElement;var id=target.id;if(id==r5$X){MEvent.trigger(maplet,"snapshot_done","cancel")}else{if(id==cIj$9){MEvent.trigger(maplet,"snapshot_done","preview")}else{if(id==Lag3e){MEvent.trigger(maplet,"snapshot_done","download")}}}}}oHTjb();vO4();Q24()};var oHTjb=function(){$X3j.hide();$X3j.resize(0,0)};var vO4=function(){Owx05.hide();Owx05.moveTo(-1000,-1000)};var Q24=function(){c35.hide();c35.resize(0,0)};this.moveTo=function(x,y){$X3j.moveTo(x,y);var w057=y-Owx05.div.firstChild.clientHeight-2;Owx05.moveTo(x,w057);if(y-Owx05.div.offsetHeight<0){Owx05.moveTo(x+3,w057+Owx05.div.offsetHeight+5)}};this.resize=function(w,h){w=w<0?0:w;h=h<0?0:h;$X3j.resize(w,h);this.$8y74(w+" x "+h)};this.$8y74=function(text){document.getElementById(OfWGp).innerHTML=text};this.isVisible=function(){return document.getElementById(sh3).style.visibility!="hidden"?true:false};this.B2$0=function(){this.yG6=true;a27e();var x=U26V2.x+U26V2.width-Ve8-2;var y=U26V2.y+U26V2.height;if(y+d7$3>maplet.height){y-=d7$3+(isIE?4:3)}c35.resize(Ve8,d7$3);c35.moveTo(x,y);c35.show();maplet.setDomCursorStyle("pointer",document.getElementById(cIj$9));maplet.setDomCursorStyle("pointer",document.getElementById(Lag3e));maplet.setDomCursorStyle("pointer",document.getElementById(r5$X));MEvent.trigger(maplet,"snapshot_select",{x:U26V2.x,y:U26V2.y,width:U26V2.width,height:U26V2.height})};this.snapshot=function(options){if(typeof options!="object"){options={}}if(typeof options.mode!="string"||(options.mode!="fullscreen"&&options.mode!="custom")){options.mode=SNAPSHOT_OPTIONS.mode}if(typeof options.x=="undefined"||isNaN(options.x)){options.x=0}if(typeof options.y=="undefined"||isNaN(options.y)){options.y=0}if(typeof options.width=="undefined"||isNaN(options.width)){options.width=maplet.width}if(typeof options.height=="undefined"||isNaN(options.height)){options.height=maplet.height}if(typeof options.zoom=="undefined"||isNaN(options.zoom)){options.zoom=maplet.getZoomLevel()}if(typeof options.format!="string"){options.format=SNAPSHOT_OPTIONS.format}if(typeof options.depth=="undefined"||isNaN(options.depth)){options.depth=SNAPSHOT_OPTIONS.depth}if(options.processMode!="string"&&(options.processMode!="event"&&options.processMode!="download")){options.processMode=SNAPSHOT_OPTIONS.processMode}a27e.apply(this,[options]);CF1.apply(this,[options])};var CF1=function(options){var xf192={};xf192.center=fo8j.apply(this,[U26V2.center]);xf192.point="";xf192._ah0="";xf192.area="";xf192.width=U26V2.width;xf192.height=U26V2.height;xf192.zoom=typeof options.zoom=="undefined"?maplet.getZoomLevel():options.zoom;xf192.format=typeof options.format=="undefined"?SNAPSHOT_OPTIONS.format:options.format;xf192.depth=typeof options.depth=="undefined"?SNAPSHOT_OPTIONS.depth:options.depth;xf192.processMode=typeof options.processMode=="undefined"?SNAPSHOT_OPTIONS.processMode:options.processMode;xf192.vellipse="";xf192.Q02="";xf192.traffic=false;xf192.X475="";xf192.VN6q="";var JKU=getMarkers();if(JKU.length>0){xf192.point=[];for(var i=0;i<JKU.length;i++){var h853B=JKU[i];xf192.point.push(fo8j.apply(this,[h853B.relyMarker.pt.getPid()])+","+h853B.text+","+h853B.P4$0+","+h853B.w666+",,,"+h853B.src+","+h853B.jfS6F+","+h853B.t0aW)}xf192.point=xf192.point.join("|")}var vw=getPolylines();if(vw.length>0){xf192._ah0=[];xf192.area=[];for(var i=0;i<vw.length;i++){var Of5_5=[];var pts=vw[i].pts;for(var P7P9=0;P7P9<pts.length;P7P9++){Of5_5.push(fo8j.apply(this,[pts[P7P9].getPid()]))}var brush=vw[i].brush;if(vw[i].brush.fill){xf192.area.push(Of5_5.join(",")+";"+A21f$(brush.bgcolor)+";"+(parseFloat(brush.bgtransparency)/100)+";"+A21f$(brush.color)+";"+brush.stroke+";"+brush.style+";"+(parseFloat(brush.transparency)/100))}else{xf192._ah0.push(Of5_5.join(",")+";"+A21f$(brush.color)+";"+brush.stroke+";"+brush.style+";"+(parseFloat(brush.transparency)/100))}}if(xf192._ah0.length>0){xf192._ah0=xf192._ah0.join("|")}else{xf192._ah0=""}if(xf192.area.length>0){xf192.area=xf192.area.join("|")}else{xf192.area=""}}var fu878=maplet.getEllipse();if(fu878.length>0){xf192.vellipse=[];for(var i=0;i<fu878.length;i++){var item=fu878[i];var brush=item.brush;xf192.vellipse.push(fo8j.apply(this,[item.gC.getPid()])+","+item.sax+","+filter2Num(item.say,"")+","+A21f$(brush.bgcolor)+","+(parseFloat(brush.bgtransparency)/100)+","+A21f$(brush.color)+","+brush.stroke+","+brush.style+","+(parseFloat(brush.transparency)/100))}if(xf192.vellipse.length>0){xf192.vellipse=xf192.vellipse.join("|")}else{xf192.vellipse=""}}var L30=getRoundRect();if(L30.length>0){xf192.Q02=[];for(var i=0;i<L30.length;i++){var item=L30[i];var brush=item.Q02.brush;xf192.Q02.push(fo8j.apply(this,[item.Q02.minpt.getPid()])+","+fo8j.apply(this,[item.Q02.maxpt.getPid()])+","+item.EpS3+","+item.u1b$5+","+A21f$(brush.bgcolor)+","+(parseFloat(brush.bgtransparency)/100)+","+A21f$(brush.color)+","+brush.stroke+","+brush.style+","+(parseFloat(brush.transparency)/100))}if(xf192.Q02.length>0){xf192.Q02=xf192.Q02.join("|")}else{xf192.Q02=""}}if(maplet.traffic&&maplet.traffic.layer.getImgCount()){xf192.traffic=true;xf192.X475=maplet.traffic.options.city;xf192.VN6q=maplet.traffic.wm27_()}CL0h.apply(this,[xf192])};var fo8j=function(w9L25){return w9L25.indexOf(",")!=-1?w9L25.replace(",","_"):w9L25};var p66=function(){if(AbF9T>=3){return}var taskId=s4723.taskId.value;if(typeof _snapshot_result=="object"&&_snapshot_result){if(_snapshot_result.url!="inexistence"){switch(_snapshot_result.processMode){case"event":case"preview":MEvent.trigger(maplet,"snapshot",_snapshot_result.url);break;default:break}return}}window.setTimeout(function(e5_o){return function(){AbF9T++;new foy21(QAE7+"?taskId="+taskId,function(){p66.apply(e5_o)}).f7c0()}}.apply(this,[this]),1000)};var A21f$=function(color){if(color.substring(0,3).toLowerCase()=="rgb"){return color.replace(new RegExp(",","g"),"@")}return color};var X4PY0=function(){this.hide();var options={};options.processMode="preview";CF1.apply(this,[options])};var $Ic=function(){this.hide();var options={};options.processMode="download";CF1.apply(this,[options])};var jrDQq=function(_event){stopEventBubble(_event)};var getMarkers=function(){var v6=[];var markers=maplet.getMarkers();if(markers.length>0){for(var i=0;i<markers.length;i++){if(!markers[i].icon){continue}if(!markers[i].icon.isVisible()){continue}var X_4=markers[i];var icon=X_4.icon;var dkb=0,_c4k6=0,$06=0,h1R4=0;var Y2y94=0,yf6=0;Y2y94=dkb=parseInt(icon.div.style.left);yf6=_c4k6=parseInt(icon.div.style.top);$06=icon.div.clientWidth;h1R4=icon.div.clientHeight;var O1CG="",L34="",Wi268="";if(markers[i].label){var t626A=X_4.label;O1CG=t626A.getText();L34=parseInt(t626A.div.style.left);Wi268=parseInt(t626A.div.style.top);var dHb5=t626A.div.clientWidth;var i3a=t626A.div.clientHeight;if(L34<dkb){dkb=L34}if(Wi268<_c4k6){_c4k6=Wi268}if((L34+dHb5)>(dkb+$06)){$06=L34+dHb5}if((Wi268+i3a)>(_c4k6+h1R4)){h1R4=Wi268+i3a}}if(_isRectint(U26V2.vroundrect,{min:{x:dkb,y:_c4k6},max:{x:dkb+$06,y:_c4k6+h1R4}})){v6.push({x:Y2y94,y:yf6,jfS6F:markers[i].icon.anchorX,t0aW:markers[i].icon.anchorY,src:icon.getImgUrl(),text:O1CG,P4$0:markers[i].label?markers[i].label.xoffset:0,w666:markers[i].label?markers[i].label.yoffset:0,relyMarker:markers[i]})}}}return v6};var getPolylines=function(){var v6=[];var vw=maplet.getPolylines();if(vw.length>0){for(var i=0;i<vw.length;i++){var pts=vw[i].pts;var SM0h6=false;for(var P7P9=0;P7P9<pts.length;P7P9++){var E1G$x=pts[P7P9].mapX;var E1G$y=pts[P7P9].mapY;if(_isInsideRect({x:E1G$x,y:E1G$y},U26V2.vroundrect)){SM0h6=true;break}if(P7P9>0){var E1G$P3_6=pts[P7P9-1].mapX;var E1G$r4fSS=pts[P7P9-1].mapY;var $FaX_={start:{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.max.y},end:{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.min.y}};var w$i={start:{x:E1G$P3_6,y:E1G$r4fSS},end:{x:E1G$x,y:E1G$y}};if(_IsIntersect($FaX_,w$i)){SM0h6=true;break}$FaX_={start:{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.min.y},end:{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.min.y}};if(_IsIntersect($FaX_,w$i)){SM0h6=true;break}$FaX_={start:{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.min.y},end:{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.max.y}};if(_IsIntersect($FaX_,w$i)){SM0h6=true;break}$FaX_={start:{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.max.y},end:{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.max.y}};if(_IsIntersect($FaX_,w$i)){SM0h6=true;break}}}if(!SM0h6&&vw[i].brush.fill){var vBG=vw[i].pts;var p_E1s=[];for(var P7P9=0;P7P9<vBG.length;P7P9++){p_E1s.push({x:vBG[P7P9].mapX,y:vBG[P7P9].mapY})}var Va58l=[{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.max.y},{x:U26V2.vroundrect.max.x,y:U26V2.vroundrect.min.y},{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.min.y},{x:U26V2.vroundrect.min.x,y:U26V2.vroundrect.max.y}];for(var P7P9=0;P7P9<p_E1s.length;P7P9++){if(_isInsidePolygon(p_E1s[P7P9],Va58l)){SM0h6=true}}if(!SM0h6){for(var P7P9=0;P7P9<Va58l.length;P7P9++){if(_isInsidePolygon(Va58l[P7P9],p_E1s)){SM0h6=true}}}}if(SM0h6){v6.push(vw[i])}}}return v6};var getRoundRect=function(){var v6=[];var L30=maplet.getRoundRect();if(L30.length>0){for(var i=0;i<L30.length;i++){var item=L30[i];var pr59={min:{x:item.minpt.mapX,y:item.minpt.mapY},max:{x:item.maxpt.mapX,y:item.maxpt.mapY}};if(_isRectint(U26V2.vroundrect,pr59)){v6.push({EpS3:parseInt(item.width*item.arcsize)*2,u1b$5:parseInt(item.height*item.arcsize)*2,Q02:item})}}}return v6};var _0YUd=function(I1g){var rt90Y=null;if(isIE){rt90Y=document.createElement("<input name='"+I1g+"'>")}else{rt90Y=document.createElement("input");rt90Y.name=I1g}rt90Y.type="hidden";return rt90Y};var CL0h=function(O$v1){try{AbF9T=0;if(typeof _snapshot_result=="object"&&_snapshot_result){_snapshot_result=null}if(!iframe){if(isIE){iframe=document.createElement("<IFRAME name='"+NE2+"'>")}else{iframe=document.createElement("IFRAME");iframe.name=NE2}iframe.id=NE2;iframe.frameBorder="0";iframe.style.width="0px";iframe.style.height="0px";iframe.style.zIndex=-1;maplet.panel.appendChild(iframe);var aeq=function(e5_o){return function(){$_fhH.apply(e5_o)}};if(isIE){iframe.attachEvent("onreadystatechange",aeq(this))}else{iframe.addEventListener("load",aeq(this),false)}s4723=document.createElement("FORM");s4723.id=_s9t;s4723.method="POST";s4723.target=NE2;s4723.action=MJhR;maplet.panel.appendChild(s4723);s4723.appendChild(_0YUd("center"));s4723.appendChild(_0YUd("customer"));s4723.appendChild(_0YUd("size"));s4723.appendChild(_0YUd("markers"));s4723.appendChild(_0YUd("polylines"));s4723.appendChild(_0YUd("polygons"));s4723.appendChild(_0YUd("format"));s4723.appendChild(_0YUd("depth"));s4723.appendChild(_0YUd("processMode"));s4723.appendChild(_0YUd("taskId"));s4723.appendChild(_0YUd("codeform"));s4723.appendChild(_0YUd("zoom"));s4723.appendChild(_0YUd("ellipse"));s4723.appendChild(_0YUd("roundrect"));s4723.appendChild(_0YUd("traffic"));s4723.appendChild(_0YUd("tcity"));s4723.appendChild(_0YUd("ttime"))}s4723.center.value=O$v1.center;s4723.customer.value=(strLicenseKey=="3409")?0:1;s4723.size.value=O$v1.width+"x"+O$v1.height;s4723.markers.value=O$v1.point;s4723.polylines.value=O$v1._ah0;s4723.polygons.value=O$v1.area;s4723.format.value=O$v1.format;s4723.depth.value=O$v1.depth;s4723.processMode.value=O$v1.processMode;s4723.taskId.value=new Date().getTime();s4723.codeform.value="1";s4723.zoom.value=O$v1.zoom;s4723.ellipse.value=O$v1.vellipse;s4723.roundrect.value=O$v1.Q02;s4723.traffic.value=O$v1.traffic;s4723.tcity.value=O$v1.X475;s4723.ttime.value=O$v1.VN6q;if(!isIE){s4723.target=NE2}s4723.submit()}catch(nc){iframe=null;s4723=null}};var $_fhH=function(){if(isIE&&iframe.readyState!="complete"){return}p66.apply(this)};var a27e=function(options){if(typeof options=="undefined"){with(U26V2){x=parseInt($X3j.div.style.left);y=parseInt($X3j.div.style.top);width=$X3j.div.clientWidth;height=$X3j.div.clientHeight}}else{if(options.mode=="fullscreen"){options.width=maplet.width;options.height=maplet.height}with(U26V2){x=options.x;y=options.y;width=options.width;height=options.height}}with(U26V2){rect={min:{x:x,y:y},max:{x:x+width,y:y+height}};center=maplet.toMapCoordinate(x+width/2,y+height/2)}};var n7F=function(){with(U26V2){x=0;y=0;width=0;height=0;rect=null}};this.finalize=function(){for(var i=0;i<ao.length;i++){MEvent.removeBuiltInListener(ao[i]);ao[i]=null}ao=null;maplet.panel.removeChild(Owx05.div);Owx05=null;maplet.panel.removeChild($X3j.div);$X3j=null;maplet.panel.removeChild(c35.div);c35=null;maplet.panel.removeChild(iframe);iframe=null;maplet.panel.removeChild(s4723);s4723=null;maplet=null};this.toString=function(){return"com.mapbar.maplet.MSnapshotBox"}};var MIconShadow=function(c,d,b,a,e){this.zIndex=0;this.div=document.createElement("div");this.div.unselectable="on";this.div.style.zIndex=this.zIndex;this.div.style.position="absolute";d=(typeof d=="undefined")?16:d;b=(typeof b=="undefined")?16:b;this.img=(isIE6)?document.createElement("v:Image"):new Image();this.img.unselectable="on";this.img.style.MozUserSelect="none";this.img.style.zIndex=this.zIndex;this.img.style.position="absolute";this.img.style.top="0px";this.img.style.left="0px";this.img.setAttribute(_dragmap,"true");this.img.src=(typeof c=="undefined")?strImgsvrUrl+"images/Shadow.png":c;this.div.appendChild(this.img);this.width=(typeof d=="undefined")?parseInt(this.img.width):parseInt(d);this.height=(typeof b=="undefined")?parseInt(this.img.height):parseInt(b);this.img.style.width=this.width+"px";this.img.style.height=this.height+"px";this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.anchorX=this.width/2;this.anchorY=this.height/2;this.anchorX=parseInt((typeof a=="undefined")?this.anchorX-16:this.anchorX+a);this.anchorY=parseInt((typeof e=="undefined")?this.anchorY:this.anchorY+e);this.left=0;this.top=0;this.setOverlayId=function(f){this.div.id="mk_shadow_c_"+f;this.img.id="mk_shadow_"+f};this.initialize=function(f){this.relyMarker=f;if(isIE){this.img.ondragstart=function(){return false}}this.img.onmousedown=function(){return false}};this.update=function(g,k,j){if(this.relyMarker.autoHide&&!this.relyMarker.icon.isVisible()){if(this.div.parentNode){this.div.parentNode.removeChild(this.div);this.fu=false}}else{var f=parseInt(k)-parseInt(this.anchorX);var i=parseInt(j)-parseInt(this.anchorY);if(this.div.parentNode!=g.layerDrawMap.div&&!this.relyMarker.isMousemove){g.layerDrawMap.appendChild(this.div);this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.img.style.width=this.width+"px";this.img.style.height=this.height+"px";this.fu=true}this.div.style.top=i+"px";this.div.style.left=f+"px";this.top=i;this.left=f}};this.isVisible=function(){return(this.fu)};this.getOverlaySomeAttr=function(){return(this.img.src)+","+this.width+","+this.height};this.hilite=function(){if(this.div){if(this.div.style.zIndex<_zIndex){_zIndex++}this.setZIndex(_zIndex)}};this.finalize=function(){this.remove(true)};this.remove=function(f){if(typeof f!="boolean"){f=false}if(this.img){if(isIE){this.img.ondragstart=null}this.img.onmousedown=null}if(this.div){if(!f){if(this.div.parentNode){this.div.parentNode.removeChild(this.div)}}else{removeNode(this.div);this.div=null}}if(f){this.relyMarker=null}};this.setZIndex=function(f){if(this.div&&this.div.parentNode&&f!=this.div.style.zIndex){this.zIndex=this.div.style.zIndex;this.div.style.zIndex=f}};this.resetZIndex=function(){if(!this.div){return}if(this.zIndex!=this.div.style.zIndex){this.setZIndex(this.zIndex)}};this.toString=function(){return"com.mapbar.maplet.MIconShadow"}};window.MVersion={version:"31.2",build:"0910151654"};var Maplet=function(e,m,c,b,l,i,f,j,k){if(isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(d){}}this.downX=0;this.downY=0;this.curX=0;this.curY=0;this.fS=0;this.fT=0;this.offsetX=0;this.offsetY=0;ac=new Date();this.imgWidth=300;this.imgHeight=300;this.clickToCenter=true;this.R03GR={};this.customInfoWindow=false;this.controlCanvas=null;this.mousedownTime=-1;this.mouseupTime=-1;this.qno=200;this.ignoreMoveRange=2;this.isMoved=false;this.sumMoveX=0;this.sumMoveY=0;this.Or5V$=false;this.H6$0=false;this.lastStamp=null;this.deltaX=null;this.deltaY=null;this.timer=null;this.disX=null;this.disY=null;this.disTime=null;this.moved=false;this.O7Qx=[];mapCursorIcons=[];this.v8q8Y="";this.Cj9mE=-1;this.dV55V=-1;this.U9B2="";this.j5x47=null;this.mwIndicator={container:null,Div:[],Timer:null,xd:0.12,I403:4,fB878:1,interval:100,bigSize:{width:85,height:68},smallSize:{width:35,height:27}};this.dragCross={fC:null,width:16,height:16,offsetY:5,X:3,Y:4,overlay:null};this.gwb=-1;this._B3=false;this.oA46=true;this.Q0v=false;this.oA19i=bpp[0];this.traffic=null;this.navLogoIsShow=true;this.Lp0m1=5;this.markerDragAnimation=true;this.qS={};this.layerData={};this.W_7=[];this.logoSize={width:41,height:20};this.navSize={width:0,height:0};this.HF2=null;this.allowDrawingDragMap=true;this.XHl=true;this.y$pP_=false;this.mapMode=mapMode.pan;this.id="mapbar";this.yt=((new Date().getTime())%86400000).toString(36)+(parseInt(Math.random()*1000)).toString(36);if(typeof strRemoteIP!="undefined"&&strRemoteIP){this.yt+="*"+strRemoteIP}document["mapbar-maplet"]=this;this.left=(typeof i=="undefined")?0:parseInt(i);this.top=(typeof f=="undefined")?0:parseInt(f);this.width=(typeof w=="undefined")?600.00001:parseInt(b);this.height=(typeof h=="undefined")?400.00001:parseInt(l);if(isNaN(parseFloat(e))||(typeof e=="string"&&e.length>3&&e.substring(0,3).toLowerCase()=="inf")){this.id=e;this.panel=(typeof e=="object")?e:document.getElementById(e);if(m!=null&&m!="undefined"){var a=cq.Decrypt(m);this.centerLat=Math.min(sy[1],Math.max(sy[0],parseFloat(a[1])));this.centerLon=Math.min(sz[1],Math.max(sz[0],parseFloat(a[0])%360));a=null}if(typeof this.panel!="undefined"&&this.panel!=null){if(!this.panel.style.zIndex){this.panel.style.zIndex=0}this.left=0;this.top=0;if(this.panel.style.left){this.left=parseInt(this.panel.style.left)}if(this.panel.style.top){this.top=parseInt(this.panel.style.top)}if(this.panel.style.width){this.width=parseInt(this.panel.style.width)}if(this.panel.style.height){this.height=parseInt(this.panel.style.height)}}}else{this.centerLon=m;this.centerLat=e}this.strImgUrl=strImgsvrUrl;this.zoomLevel=(typeof c=="undefined")?0:parseInt(c);this.headMode=0;this.py=0;this.rotation=0;this.rotationCosVal=Math.cos(this.rotation/180*Math.PI);this.rotationSinVal=Math.sin(this.rotation/180*Math.PI);this.yv=(j=="undefined")?"":j;this.Clip=new Array();this.qE=new Array();this.mapName=(typeof k=="undefined"||k==null)?mapName:k;this.u2=null;this.u3="";this.ext="png";this.xw=this.mapName;this.yh="";this.x4=this.mapName;this.x3=null;this.uu=null;this.xX=this.mapName;this.pJ=null;this.imgServerId=[["",1],[2,3]];this.bp=true;this.ff=false;this.fe=true;this.sf=null;this.stdControlIsShow=(typeof bDefaultControlOn=="undefined")?true:bDefaultControlOn;this.doPaning=false;this.halfNum5clipX=Math.ceil((this.width)/(this.imgWidth)/2);this.halfNum5clipY=Math.ceil((this.height)/(this.imgHeight)/2);this.aO=new Array();this.aN=new Array();this.yG=new Array();this.contentInfo=null;this.Clip=new Array();this.aE=new Array();this.aF=null;this.aG=null;this.aH=null;this.zy=null;this.tG=null;this.brush=new MBrush("#FF0000",2);this.sv=0;this.fo=false;this.gJ=null;this.gI=new Image();this.bound=new MBound(0,0,0,0);this.cH=false;this.c0=false;this.bounds=new Array();this.cI=true;this.cn=false;this.gc=[];this.overLay=[];this.vA=this.mapMode;this.fs=false;this.c9=false;this.j34=null;this.mouseclickTime=0;this.gM=1;this.stdContextMenu=null;this.mapContextMenu=null;this.overview=new OverView(this);this.ovw=this.overview;this.wK=new Array();if(typeof this.panel=="undefined"||this.panel==null){document.writeln('<div unselectable="on" id="'+this.id+'" style="position:absolute;overflow:hidden; width:'+this.width+"px; height:"+this.height+"px; left:"+this.left+"px; top:"+this.top+'px;"></div>');this.panel=$(this.id)}else{this.panel.style.overflow="hidden"}this.map=this.panel;if(this.map){this.map.setAttribute("align","left");if(this.map.style.position!="absolute"){this.map.style.position="relative"}var g="http://www.mapbar.com/ApiCopyrightLink.html?referrer="+window.location.host;this.logo=document.createElement("div");this.logo.style.width=this.logoSize.width+"px";this.logo.style.height=this.logoSize.height+"px";this.logo.style.overflow="hidden";this.logo.innerHTML="<img src='"+CTLIMG_RESOURCE[0].url+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-25px;top:-158px' />";this.logo.id="ImgCopyright";this.logo.style.position="absolute";this.logo.style.zIndex=3;this.logo.style.top=(this.height-22)+"px";this.logo.setAttribute("whohide","");this.logo.style.cursor="pointer";this.logo.onclick=function(){window.open(g)};this.navLogo=document.createElement("a");this.navLogo.setAttribute("target","_blank");this.navLogo.setAttribute("href","http://www.navinfo.com.cn");this.navLogo.innerHTML="&copy;&nbsp;NavInfo";this.navLogo.style.position="absolute";this.navLogo.style.zIndex=3;this.navLogo.style.fontSize="12px";this.navLogo.style.color="blue";this.navLogo.style.fontFamily="arial";this.navLogo.style.textDecoration="none";this.navLogo.style.top=(this.height-25)+"px";this.navLogo.style.left=(this.width-70)+"px";this.navLogo.style.background="none";this.dOh_8=0;this.map.appendChild(this.logo);this.map.appendChild(this.navLogo);this.navSize.width=this.navLogo.offsetWidth;this.navSize.height=this.navLogo.offsetHeight}setMapLoading2Center(this);this.m0J=false;this.J_883=false;this.uw=0;this.t9=0;this.xe=10;if(bp){this.setOverlay("base")}this.fM=null;this.AY=0.2;this.AS=-1;this.AT=0;this.AZ=null;this.panToStepSize=20;this.timeoutHandler=null;this.Ah=null;this.vc=0;this.vd=0;this.vi=0;this.modeType={zoomin:1,zoomout:2,pan:3,erase:13,edit:23,lookup:5,bookmark:6,drawline:9,drawarea:10,measure:11,measarea:15,snapshot:24}};Maplet.MICON_IMGSRC_FLAG="imgsrc";Maplet.MLABEL_TEXT_FLAG="lbltext";Maplet.LEFT_TOP=1;Maplet.LEFT_BOTTOM=2;Maplet.RIGHT_TOP=3;Maplet.RIGHT_BOTTOM=4;Maplet.prototype={onresize:function(){if(this.controlCanvas&&this.controlCanvas.options.view.ruler){if(this.height>=270){this.controlCanvas.showCtlRuler(true,true,false)}else{this.controlCanvas.showCtlRuler(false,true,false)}}this.setRightBottom();this.VgxX4()},setRightBottom:function(){var dJI9={w:0,h:this.logoSize.height};if(this.logo.style.display!="none"){dJI9.w=dJI9.w+this.logoSize.width+5}if(this.navLogoIsShow){dJI9.w=dJI9.w+this.navSize.width+5}var stdWidth=this.width;if(this.controlCanvas&&this.controlCanvas.options.location.type==Maplet.RIGHT_BOTTOM){stdWidth=stdWidth-this.controlCanvas.getRect().width}if(this.overview.location.type==Maplet.RIGHT_BOTTOM){var ovwRect=this.overview.getRect();if(stdWidth>=ovwRect.min.x&&ovwRect.min.x!=0){stdWidth=ovwRect.min.x;if((this.width-ovwRect.max.x>=dJI9.w)||(this.height-ovwRect.max.y>=dJI9.h)){stdWidth=this.width}}}var navLogoWidth=this.navLogoIsShow?this.navSize.width:0;var mapLogoLeft=this.navLogoIsShow?filter2Num(this.navLogo.style.left):stdWidth;if(this.navLogoIsShow){with(this.navLogo.style){left=stdWidth-navLogoWidth-5+"px";top=(this.height-23)+"px";mapLogoLeft=this.navLogoIsShow?filter2Num(left):stdWidth}}with(this.logo){if(style.display!="none"){style.left=mapLogoLeft-offsetWidth-5+"px";style.top=(this.height-26)+"px"}}},nI:function(){if(!this.ff){return null}if(this.AP==null){this.AP=new AO(this,-1,this.width-16,0,16,this.height,this.ff,this.panel)}return this.AP},mouseContext:function(a){stopEventBubble(a);if(this.isMoved){return false}MEvent.trigger(this,"contextmenu");var c=(isIE)?event.srcElement:a.target;if(this.stdContextMenu){this.stdContextMenu.hide()}var d=null;var b=c.getAttribute("oid");b=typeof this.overLay[b]!="undefined"?this.overLay[b]:null;if(b&&typeof b.getContextMenu=="function"){d=b.getContextMenu(c)}else{if(typeof c.contextmenu!="undefined"&&c.contextmenu){d=c.contextmenu}}if(d){this.stdContextMenu=d;d._0n(typeof c.id=="string"?c.id:"");d.X1xA(b);d.show(this.endX,this.endY)}else{if(this.mapContextMenu!=null){this.stdContextMenu=this.mapContextMenu;this.mapContextMenu.show(this.endX,this.endY)}}},getContextMenu:function(){return this.mapContextMenu},setContextMenu:function(a){if(this.mapContextMenu!=a){this.removeContextMenu()}this.mapContextMenu=a;if(this.mapContextMenu!=null){this.mapContextMenu.initialize(this)}},setStandardContextMenu:function(a){this.stdContextMenu=a},removeContextMenu:function(){if(this.mapContextMenu!=null){if(this.stdContextMenu==this.mapContextMenu){this.stdContextMenu=null}this.mapContainer.div.removeChild(this.mapContextMenu.tY);this.mapContextMenu.maplet=null;this.mapContextMenu=null}},showMap:function(){if(isIE6&&this.width>0){this.panel.style.width=(this.width-1)+"px";this.panel.style.height=(this.height-1)+"px";this.panel.style.width=this.width+"px";this.panel.style.height=this.height+"px"}if(MapBackgroundColor){this.panel.style.backgroundColor=MapBackgroundColor}MEvent.bindDom(this.panel,"contextmenu",this,this.mouseContext);this.mapContainerBg=new MDiv("MapContainerBg",0,0,this.width,this.height,true,0,"",this.panel);this.mapContainer=new MDiv("MapContainer",0,0,this.width,this.height,true,2,"",this.panel);this.toolTip=new MDiv("ToolTip",0,0,0,0,false,24,"",this.mapContainer);this.layerMap=new MDiv("LayerMap",0,0,this.width,this.height,true,2,"",this.mapContainer);this.layerPoiMap=new MDiv("LayerPoiMap",0,0,this.width,this.height,true,3,"",this.mapContainer);this.nI();if(this.stdControlIsShow){var stdControl=new MStandardControl();this.addControl(stdControl);this.controlCanvas=stdControl.nR}this.layerScale=new MDiv("LayerScale",1,this.height-24,70,24,this.fe,3,"",this.panel);var content='<table border="0" width="100%" height="100%" style="border:2px solid #0E347F;"><tr ><td align="center" valign="middle" style="filter:alpha(opacity=30);opacity:0.3;background-color:#FFFFFF;"></td></tr></table>';this.layerBorder=new MDiv("LayerBorder",1,1,1,1,false,6,content,this.panel);this.layerBorder.style.border="1px solid #FFFFFF";this.snapshotBox=new MSnapshotBox(this);content='<div style="position:absolute;border-width:2px 0px 0px 2px;border-style:solid;border-color:red;width:4px;height:4px;left:0px;top:0px;line-height:1px;"></div><div style="position:absolute;border-width:2px 2px 0px 0px;border-style:solid;border-color:red;width:4px;height:4px;left:28px;top:0px;line-height:1px;"></div><div style="position:absolute;border-width:0px 0px 2px 2px;border-style:solid;border-color:red;width:4px;height:4px;left:0px;top:20px;line-height:1px;"></div><div style="position:absolute;border-width:0px 2px 2px 0px;border-style:solid;border-color:red;width:4px;height:4px;left:28px;top:20px;line-height:1px;"></div>';this.mwIndicator.container=new MDiv("_mapbar_mw_indicator",0,0,this.mwIndicator.smallSize.width,this.mwIndicator.smallSize.height,true,100,content,this.panel).div;this.mwIndicator.container.style.display="none";this.mwIndicator.Div=this.mwIndicator.container.getElementsByTagName("div");this.layerDrawMap=new MDiv("LayerDrawMap",0,0,this.width,this.height,true,4,"",this.mapContainer);if(isIE){this.layerDrawMap.style.backgroundImage="url("+imgMaskUrl+")"}if(!isIE){this.layerDrawMap.style.MozUserSelect="none"}this.layerDrawMap.div.setAttribute(_dragmap,"true");this.dragCross.container=new MDiv("_mapbar_drag_cross",0,0,this.dragCross.width,this.dragCross.height,true,2,"",this.panel);with(this.dragCross.container.div){style.width=this.dragCross.width+"px";style.height=this.dragCross.height+"px";style.display="none";style.overflow="hidden"}if(isIE6){this.dragCross.container.div.innerHTML='<v:image  style="position:absolute;width:'+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-49px;top:-108px;\" src='"+CTLIMG_RESOURCE[0].url+"' />"}else{this.dragCross.container.div.innerHTML='<img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;width:'+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;left:-49px;top:-108px;">'}this.overview.qa(this.panel);var rightMargin=15;var ui=0;this.sg=(this.width>360)?150:73;if((this.overview.nF()+this.overview.getHeight())>(this.height-23)){ui+=Math.max(0,this.overview.getWidth()-(this.sg-70))}MEvent.bindDom(this.map,"mousemove",this,this.onMousemove);MEvent.bindDom(this.map,"mousedown",this,this.onMousedown);MEvent.bindDom(this.map,"mouseup",this,this.onMouseup);MEvent.bindDom(this.map,"click",this,this.onClick);MEvent.bindDom(this.map,"dblclick",this,this.onDblclick);MEvent.bindDom(this.map,"mouseout",this,this.onMouseout);MEvent.bindDom(this.map,"drag",this,this.onMousemove);MEvent.bindDom(this.map,"dragstart",this,this.onMousemove);MEvent.bindDom(this.map,"dragend",this,this.onMousemove);MEvent.bindDom(this.map,"mouseover",this,this.setMapOffsetXY);if(MOUSEWHEEL){MEvent.bindDom(this.map,"mousewheel",this,this.onMousewheel);MEvent.bindDom(this.map,"DOMMouseScroll",this,this.onMousewheel)}if(kp){MEvent.bindDom(document,"keydown",this,this.onkeydown)}this.setSomeLayer();this.setZoomLevel(this.zoomLevel);this.setMode(this.mapMode);if(this.monitorTimer==null){this.monitorTimer=setInterval("document['mapbar-maplet'].monitor()",100)}},setSomeLayer:function(){this.layerBorder.hide();this.layerBorder.resize(1,1);this.layerBorder.moveTo(-10,-10);if(document.all){this.layerMap.moveTo(0,0);this.layerMap.show();this.layerPoiMap.moveTo(0,0);this.layerPoiMap.show();this.layerDrawMap.moveTo(0,0);this.layerDrawMap.show()}},setStyle:function(d,b){if(this.mapName!=d){this.mapName=d;if("aerial"==this.mapName||this.mapName.indexOf("aerial")>=0){this.ext="jpg"}else{this.ext="png"}if(typeof b!="undefined"){this.ext=b}if(typeof this.mapContainer!="undefined"){for(var c in this.Clip){try{if(this.Clip[c]!=null&&typeof this.Clip[c]=="object"){if(this.Clip[c].parentNode!=null){this.Clip[c].parentNode.removeChild(this.Clip[c])}this.Clip[c]=null}}catch(a){}}this.refresh();MEvent.trigger(this,"style",d)}}},setRotation:function(a){if(isIE&&rs){this.rotation=a;this.rotationCosVal=Math.cos(this.rotation/180*Math.PI);this.rotationSinVal=Math.sin(this.rotation/180*Math.PI)}},setHeadMode:function(a){this.headMode=a},setOverlay:function(b,a){if(typeof a=="string"){this.u3=a}if(this.u2!=b){this.u2=b}if(typeof this.mapContainer!="undefined"){this.refresh()}},setBoundRange:function(){var a=cutImgLonRange[this.zoomLevel]*this.width/this.imgWidth;this.bound.left=(this.centerLon-a/2);this.bound.right=(this.centerLon+a/2);var b=cutImgLatRange[this.zoomLevel]*this.height/this.imgHeight;this.bound.bottom=(this.centerLat-b/2);this.bound.top=(this.centerLat+b/2)},fI:function(j){if(this.bounds!=null&&this.bounds.length>0){maxZoomLevel=this.bound.maxZoomLevel;minZoomLevel=this.bound.minZoomLevel;var a=cutImgLonRange[j]*this.width/this.imgWidth;var g=(this.centerLon-a/2);var e=(this.centerLon+a/2);var f=cutImgLatRange[j]*this.height/this.imgHeight;var d=(this.centerLat-f/2);var b=(this.centerLat+f/2);for(var c=0;c<this.bounds.length;c++){if(this.bounds[c].isInside(d,g)&&this.bounds[c].isInside(b,e)){maxZoomLevel=this.bounds[c].maxZoomLevel;minZoomLevel=this.bounds[c].minZoomLevel;break}}}},setBound:function(a){this.bound=a},refresh:function(){this.drawMap();this.updateScale()},fL:function(){if(this.fM!=null){clearTimeout(this.fM);this.fM=null}if(this.c0||this.fs||f1.fx.length>0){this.fM=getTimeout(this,this.fL,100);return}this.no()},no:function(){var c=0;for(var b in this.Clip){try{if(this.Clip[b]!=null&&typeof this.Clip[b]=="object"){if(this.Clip[b].isShow==true){}else{if(this.Clip[b].parentNode!=null){removeNode(this.Clip[b])}this.Clip[b].onerror=null;this.Clip[b].onload=null;this.Clip[b]=null;delete this.Clip[b];c++}}}catch(a){}}},monitor:function(){if(this._B3||this.fs||this.c0||(typeof this.Ai!="undefined"&&this.Ai!=0)){return}var a=parseInt(this.mapContainer.style.left);var b=parseInt(this.mapContainer.style.top);if((a+this.tf1)>=0||(a+this.sZ-this.width)<=0||(b+this.tg)>=0||(b+this.s1-this.height)<=0){this.fs=true;this.zA()}},zA:function(){if(this.fs==false){return}var c=parseInt(this.mapContainer.style.left);var e=parseInt(this.mapContainer.style.top);if((c+this.tf1)>=0||(c+this.sZ-this.width)<=0){if(this.c0==true){return}this.c0=true;try{var d=0;var m=0;if((c+this.tf1)>=0){this.th--;this.tf1-=parseInt(this.imgWidth);d=this.th;m=this.tf1}if((c+this.sZ-this.width)<=0){this.s2++;m=this.sZ;this.sZ+=parseInt(this.imgWidth);d=this.s2}var f=d;var g=blockSize[this.zoomLevel];var l=parseInt(360/cutImgLonRange[this.zoomLevel]);d=(d)%l;if(d>=(l/2)){d-=l}if(d<(-l/2)){d+=l}var i=this.mapName;for(var b=this.ti;b<=this.s3;b++){var k=b;var j=(-(b-this.ti+1)*this.imgHeight)+this.s1;this.aA(m,j,d,k,f,b,i)}this.c0=false}catch(a){}}if((e+this.tg)>=0||(e+this.s1-this.height)<=0){if(this.c0==true){return}this.c0=true;try{var k=0;var j=0;if((e+this.tg)>=0){this.s3++;this.tg-=parseInt(this.imgHeight);k=this.s3;j=this.tg}if((e+this.s1-this.height)<=0){this.ti--;j=this.s1;this.s1+=parseInt(this.imgHeight);k=this.ti}var b=k;var g=blockSize[this.zoomLevel];var l=parseInt(360/cutImgLonRange[this.zoomLevel]);var i=this.mapName;for(var f=this.th;f<=this.s2;f++){var d=f;d=(d)%l;if(d>=(l/2)){d-=l}if(d<(-l/2)){d+=l}var m=((f-this.th)*this.imgWidth)+this.tf1;this.aA(m,j,d,k,f,b,i)}this.c0=false}catch(a){}}this.fs=false},aA:function(p,l,f,o,g,e,j){var i=blockSize[this.zoomLevel];var d=parseInt(Math.floor((f)/i));var c=parseInt(Math.floor((o)/i));if(d<0){d+=1}if(c<0){c+=1}var q=(f)-d*i;var a=(o)-c*i;var n=this.strImgUrl.replace("img","img"+this.getImgServerId(q,a))+"mapbank/"+j+"/"+this.levelFolder;if(this.zoomLevel>=14){n+=d+"/"}var b=((this.zoomLevel).toString(16)+g.toString(16)+"l"+e.toString(16)).toLowerCase();n+=d+"_"+c+"/";n+=q+"_"+a+"."+this.ext;if(n&&n.indexOf("NaN")<0){if(this.Clip[b]==null){if(rs==0||!isIE){this.Clip[b]=new Image();this.Clip[b].id=b;this.Clip[b].name=b;this.Clip[b].ntry="0";this.Clip[b].unselectable="on";this.Clip[b].style.position="absolute"}else{this.Clip[b]=document.createElement("v:Image");this.Clip[b].id=b;this.Clip[b].name=b;this.Clip[b].ntry="0";this.Clip[b].unselectable="on";this.Clip[b].style.position="absolute";this.Clip[b].cE="f";this.Clip[b].style.rotation=this.rotation;this.Clip[b].style.width=this.imgWidth+"px";this.Clip[b].style.height=this.imgHeight+"px"}f1.nk(this.Clip[b],n,this.imgWidth,this.imgHeight);this.layerMap.div.appendChild(this.Clip[b])}else{if(isIE&&rs){this.Clip[b].style.rotation=this.rotation}}var m=(p+this.imgWidth/2-this.width/2)*this.rotationCosVal-(l+this.imgHeight/2-this.height/2)*this.rotationSinVal+this.width/2;var k=(p+this.imgWidth/2-this.width/2)*this.rotationSinVal+(l+this.imgHeight/2-this.height/2)*this.rotationCosVal+this.height/2;this.Clip[b].style.top=parseInt(k-this.imgHeight/2)+"px";this.Clip[b].style.left=parseInt(m-this.imgWidth/2)+"px";this.Clip[b].isShow=true;this.Clip[b].setAttribute("origy",parseInt(minZoomLevel-this.imgHeight/2));this.Clip[b].setAttribute("origx",parseInt(m-this.imgWidth/2));b=null}n=null},eiKX:function(){this.no();this.mapContainerBg.div.style.width=this.layerMap.div.style.width;this.mapContainerBg.div.style.height=this.layerMap.div.style.height;this.mapContainerBg.div.style.left=this.layerMap.div.style.left;this.mapContainerBg.div.style.top=this.layerMap.div.style.top;this.mapContainerBg.div.style.visibility="visible";for(var b in this.Clip){var a=this.Clip[b];if(a&&a.parentNode){a.parentNode.removeChild(a);this.mapContainerBg.div.appendChild(a)}}this.W413();this.oA46=false},W413:function(){for(var b in this.Clip){var a=this.Clip[b];if(a&&a.parentNode){a.isShow=false}}},ed58:function(){this.W413();this.no()},updateScale:function(g,f){if(this.fe){var e=(this.clipLonRange*100*60/parseInt(this.imgWidth))*this.gM;var d="#000000";var c=(en)?"km":getAscii("%u516E%uE338");var b=(en)?"mi":getAscii("%u54EA");e=(e<10)?(e).toPrecision(1):parseInt(e);if(this.layerScale.div.innerHTML==""){var a=['<div id="_scaleValue" style="position:absolute;font-family: arial;FONT-SIZE: 12px; color:'+d+';FONT-WEIGHT: bold;left:4px;top:0px;">&nbsp;'+e+" "+c+"</div>"];a.push('<div style="position:absolute;width:69px;height:11px;overflow:hidden;top:8px;">');if(isIE6){a.push('<img src="'+imgMaskUrl+'" style="position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;left:-8px;top:-209px;border:0px;" onmousedown="return false;" unselectable="on" galleryimg="no" />')}else{a.push('<img src="'+CTLIMG_RESOURCE[0].url+'" style="position:absolute;left:-8px;top:-209px;width:'+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+'px;border:0px;" onmousedown="return false;" unselectable="on" galleryimg="no" />')}a.push("</div>");if(en==1){this.layerScale.style.top=filter2Num(this.layerScale.style.top)-10+"px";this.layerScale.style.height=filter2Num(this.layerScale.style.height)+10+"px";a.push('<div id="_scaleValue2" style="position:absolute;font-family: arial;FONT-SIZE: 12px; color:'+d+';FONT-WEIGHT: bold;left:4px;top:19px;">&nbsp;'+e+" "+b+"</div>")}this.layerScale.div.innerHTML=a.join("")}else{if(en==1){getElementById("_scaleValue").innerHTML="&nbsp;"+e+" "+c;if(getElementById("_scaleValue2")){getElementById("_scaleValue2").innerHTML="&nbsp;"+e+" "+b}}else{getElementById("_scaleValue").innerHTML="&nbsp;"+e+" "+c}}this.layerScale.show()}else{this.layerScale.hide()}},VgxX4:function(){if(!this.layerScale){return}if(this.fe){var b=4,a;if(en==1){a=this.height-34}else{a=this.height-24}var d=0,c=0;if(this.controlCanvas&&this.controlCanvas.options.location.type==Maplet.LEFT_BOTTOM){d=this.controlCanvas.getRect().max.x+10}if(this.overview&&this.overview.location.type==Maplet.LEFT_BOTTOM){c=this.overview.getRect().max.x+10}this.layerScale.moveTo(Math.max(b,Math.max(d,c)),a)}},showNavLogo:function(a){if(!a){this.navLogo.style.display="none"}else{this.navLogo.style.display="block"}this.navLogoIsShow=a;this.setRightBottom()},waitPan:function(a,c,b){if(this.Ah){clearTimeout(this.Ah)}this.Ah=null;if(a&&c){if(this.vi==0){this.vi=1;this.vc=a;this.vd=c;this.callback=b;this.Ah=getTimeout(this,this.waitPan,500)}}else{if(this.vi){this.vi=0;this.panTo(this.vc,this.vd,this.callback)}}},doPan:function(){this.doPaning=true;this.Q0v=true;if(!isIE&&ContentInfo&&ContentInfo.isVisible()){ContentInfo.setContentOverflow(true)}if(!this.oA46){this.no();this.oA46=true}if(this.markerDragAnimation){with(this.dragCross){if(overlay!=null&&!overlay.isMousemove){this.setDragCross(false)}}}var tN=parseInt(Math.sqrt(this.mapContainerLeft*this.mapContainerLeft+this.mapContainerTop*this.mapContainerTop));if(this.timeoutHandler){clearTimeout(this.timeoutHandler)}this.timeoutHandler=null;if((this.panToDistance-tN)<=(1.2*this.panToStepSize)){this.mapContainerLeft=this.xoffset;this.mapContainerTop=this.yoffset;this.mapContainer.moveTo(this.mapContainerLeft,this.mapContainerTop);this.timeoutHandler=getTimeout(this,this.finishupPan,10)}else{var lJ=this.xoffset*this.panToStepSize/this.panToDistance;var lL=this.yoffset*this.panToStepSize/this.panToDistance;this.mapContainerLeft+=lJ;this.mapContainerTop+=lL;this.mapContainer.moveTo(this.mapContainerLeft,this.mapContainerTop);this.timeoutHandler=getTimeout(this,this.doPan,10)}},finishupPan:function(){this.doPaning=false;this.Or5V$=true;this.lastStamp=new Date().getTime();this.deltaX=this.mapContainerLeft;this.deltaY=this.mapContainerTop;if(this.timeoutHandler){clearTimeout(this.timeoutHandler)}this.timeoutHandler=null;this.setCenter(this.panCenterLat,this.panCenterLon);this.Or5V$=false;if(this.contentInfo&&this.contentInfo.parentNode!=this.mapContainer.div){this.mapContainer.div.appendChild(this.contentInfo)}else{}if(this.callback!=null&&this.callback!="undefined"){eval(this.callback)}this.Q0v=false},AN:function(AL,x,y){this.layerDrawMap.hide();if(this.layerContainer){this.layerContainer.setVisible(false);MLayer.setTipVisible(false)}for(var i in this.R03GR){var p=this.R03GR[i];if(p.options.zoomhide&&p.isVisible()){p.setVisible(false)}}if(!this.oA46){this.no()}this._B3=true;if(typeof x!="number"){x=0}if(typeof y!="number"){y=0}var AK=Math.pow(2,parseFloat(AL))/Math.pow(2,this.zoomLevel);for(var i in this.Clip){var img=this.Clip[i];if(img.isShow){with(img.style){if(img.getAttribute("done")!="1"){removeNode(img);img=null;delete this.Clip[i]}else{width=(this.imgWidth*AK<10?0:this.imgWidth*AK+1)+"px";height=(this.imgHeight*AK<10?0:this.imgHeight*AK+1)+"px";left=filter2Num(img.getAttribute("origx"))*AK+1+"px";top=filter2Num(img.getAttribute("origy"))*AK+1+"px"}}}}with(this.layerMap.div.style){width=this.width*AK+"px";height=this.height*AK+"px";left=(this.width/2-filter2Num(width)/2+x)+"px";top=(this.height/2-filter2Num(height)/2+y)+"px"}},G94$:function(xFV22){if(filter2Num(this.layerMap.div.style.width)!=this.width){with(this.layerMap.div.style){width=this.width+"px";height=this.height+"px";left="0px";top="0px"}}if(typeof xFV22=="boolean"&&xFV22){for(var i in this.Clip){var img=this.Clip[i];if(typeof img=="object"&&img.isShow){img.style.left=filter2Num(img.getAttribute("origx"),0)+"px";img.style.top=filter2Num(img.getAttribute("origy"),0)+"px";img.style.width=this.imgWidth+"px";img.style.height=this.imgHeight+"px"}}}this._B3=false},vQ:function(a){while(a!=null&&a.length>0){a[a.length-1]=null;a.length--}},vS:function(c,a){if(a>=0&&c.length>a){c[a]=null;for(var b=a;b<c.length-1;b++){c[b]=c[b+1]}c[c.length-1]=null;c.length--}},getElementById:function(c,b){var a=this.p8(c,b);if(a>=0&&c.length>a){return c[a]}return null},p8:function(c,d){var a=-1;for(var b=0;b<c.length;b++){if(c[b].id==d){a=b;break}}return a},removePointAt:function(a){this.vS(this.aO,a)},vX:function(a){this.vS(this.aO,this.p8(this.aO,a))},removeAllPoints:function(){this.vQ(this.aO)},removeLabelAt:function(a){this.vS(this.yG,a)},vV:function(a){this.vS(this.yG,this.p8(this.yG,a))},removeAllLabels:function(){this.vQ(this.yG)},removeLineAt:function(a){this.vS(this.aN,a)},vW:function(a){this.vS(this.aN,this.p8(this.aN,a))},removeAllLines:function(){this.vQ(this.aN)},addHotspot:function(e,c,f,i,b){var a="hotspot"+this.aE.length;if(typeof c=="object"&&c.toString()=="com.mapbar.maplet.MPoint"){e=c.lat;c=c.lon}else{var g=cq.Decrypt(c);e=Math.min(sy[1],Math.max(sy[0],parseFloat(g[1])));c=Math.min(sz[1],Math.max(sz[0],parseFloat(g[0])%360))}var d=new a8(a,"","",parseFloat(e),parseFloat(c),f,"","0");d.fl=false;d.AJ=i;d.AI=b;this.aE[this.aE.length]=d},addPointWithSwapImage:function(d,b,f,a,g,i,c,e){this.aO[this.aO.length]=new a8("point"+this.sv,d,b,parseFloat(f),parseFloat(a),g,i,c,e);this.sv++},addPointWithId:function(g,d,a,e,f,b,c){this.aO[this.aO.length]=new a8(g,pc[g],pb[g],parseFloat(d),parseFloat(a),e,f,b,c)},addIcon:function(b,d,e,f,a,c){var g=cq.Decrypt(d);this.addPoint(b,g[1],g[0],e,f,a,c)},getBound:function(){return this.bound},toMapLonCoordinate:function(a,e){var c=(a-this.width/2);if(this.rotation!=0){var b=(e-this.height/2);c=c*this.rotationCosVal+b*this.rotationSinVal}var d=this.centerLon+c*this.clipLonRange/this.imgWidth;d=Math.min(sz[1],Math.max(sz[0],d%360));return d},toMapLatCoordinate:function(a,e){var b=(e-this.height/2);if(this.rotation!=0){var d=(a-this.width/2);b=-d*this.rotationSinVal+b*this.rotationCosVal}var c=this.centerLat-b*this.clipLatRange/this.imgHeight;c=Math.min(sy[1],Math.max(sy[0],c));return c},toMapXCoordinate:function(d,b){var a=((parseFloat(d)-this.centerLon)%360);if(a>180){a-=360}if(a<-180){a+=360}var e=Math.round(this.width/2+a/cutImgLonRange[this.zoomLevel]*this.imgWidth);if(this.rotation!=0){var c=Math.round(this.height/2-((parseFloat(b)-this.centerLat)%360)/cutImgLatRange[this.zoomLevel]*this.imgHeight);e=(e-this.width/2)*this.rotationCosVal-(c-this.height/2)*this.rotationSinVal+this.width/2}return e},toMapYCoordinate:function(b,d){var c=Math.round(this.height/2-((parseFloat(b)-this.centerLat)%360)/cutImgLatRange[this.zoomLevel]*this.imgHeight);if(this.rotation!=0){var a=((parseFloat(d)-this.centerLon)%360);if(a>180){a-=360}if(a<-180){a+=360}var e=Math.round(this.width/2+a/cutImgLonRange[this.zoomLevel]*this.imgWidth);c=(e-this.width/2)*this.rotationSinVal+(c-this.height/2)*this.rotationCosVal+this.height/2}return c},setMode:function(a,c){a=a.toString().toLowerCase();a=(this.modeType[a])?parseInt(this.modeType[a]):parseInt(a);if((a!=3&&a!=23)&&this.mapMode==a){return null}if(this.mapMode==3||this.mapMode==23){this.vA=this.mapMode}this.mapMode=parseInt(a);this.a9X();var b=null;switch(a){case"zoomin":case"1":case 1:this.cS=true;this.setDomCursorStyle("crosshair",this.map);this.mapMode=1;b="zoomin";break;case"zoomout":case"2":case 2:this.cS=true;this.mapMode=2;this.setDomCursorStyle("crosshair",this.map);b="zoomout";break;case mapMode.pan:case"pan":case 3:this.mapMode=3;b="pan";a=null;case mapMode.l3:case 13:case"erase":if(a){this.mapMode=13;b="erase";a=null}case mapMode.edit:case"edit":case 23:if(a){this.mapMode=23;b="edit";a=null}this.cO=true;this.setDomCursorStyle("default",this.map);break;case mapMode.lookup:case"lookup":case 5:this.cS=true;this.setDomCursorStyle("crosshair",this.map);this.mapMode=5;b="lookup";break;case"6":case 6:case"bookmark":this.setDomCursorStyle("default",this.map);b="bookmark";this.mapMode=6;break;case"7":case 7:this.setDomCursorStyle("default",this.map);break;case"8":case 8:this.setDomCursorStyle("default",this.map);break;case"9":case 9:case"drawline":this.setDomCursorStyle("default",this.map);this.po=-1;this.mapMode=9;b="drawline";if(this.allowDrawingDragMap){this.cO=true}break;case"10":case 10:case"drawarea":this.setDomCursorStyle("default",this.map);this.po=-1;this.mapMode=10;b="drawarea";if(this.allowDrawingDragMap){this.cO=true}break;case"11":case 11:case"measure":this.setDomCursorStyle("default",this.map);b="measure";this.mapMode=11;if(this.allowDrawingDragMap){this.cO=true}break;case"15":case 15:case"measarea":this.setDomCursorStyle("default",this.map);b="measarea";this.mapMode=15;if(this.allowDrawingDragMap){this.cO=true}break;case"24":case 24:case"snapshot":this.cS=true;this.setDomCursorStyle("crosshair",this.map);b="snapshot";this.mapMode=24;break;default:break}var d=null;if(b!=null&&typeof c=="function"){d=MEvent.addListener(this,b,c)}if(b!=null){MEvent.trigger(this,"setmode",b)}return d},setCursorStyle:function(b,a){if(typeof b=="string"&&typeof a=="string"&&b){if("default,pointer,move,crosshair".indexOf(b)!=-1){mapCursorIcons[b]=a}}},setDomCursorStyle:function(d,c){var a=mapCursorIcons[d];var b="";if(typeof a=="string"&&a){b="url('"+a+"'),auto"}else{b=d}if(c.style.cursor!=b){c.style.cursor=b}},wN:function(a,f,d,c,b){if(typeof d=="undefined"||d==null){return}if(iToolTipStyle=="undefined"||iToolTipStyle==1){var e=(typeof d=="object")?d:null;if(e){avBubble.gl(e.title,e.content);b=c}else{avBubble.gl(d,c)}if(e){this.contentInfo=e.onOpenInfoWindow(a,f,true)}else{this.contentInfo=getInfoWindowHtml(d,a,f,c,true)}}else{var e=(typeof d=="object")?d:null;if(e){setToolTipMenu(a,f,e.title,e.content)}else{setToolTipMenu(a,f,d,c)}}},hideBubble:function(){hideBubble(this);if(this.contentInfo){if(this.contentInfo.parentNode){this.contentInfo.parentNode.removeChild(this.contentInfo)}this.contentInfo=null}},isInsideMap:function(){if((this.curX>0)&&(this.curX<this.width)&&(this.curY>0)&&(this.curY<this.height)&&(this.downX>0)&&(this.downX<this.width)&&(this.downY>0)&&(this.downY<this.height)){return true}else{return false}},lu:function(){var b=0,c=0,a=0,d=0;if(this.curX<this.downX&&this.curY<this.downY){b=this.downX-this.curX;c=this.downY-this.curY;a=this.curX;d=this.curY}else{if(this.curX>this.downX&&this.curY<this.downY){b=this.curX-this.downX;c=this.downY-this.curY;a=this.downX;d=this.curY}else{if(this.curX<this.downX&&this.curY>this.downY){b=this.downX-this.curX;c=this.curY-this.downY;a=this.curX;d=this.downY}else{if(this.curX>this.downX&&this.curY>this.downY){b=parseInt(this.curX)-this.downX;c=parseInt(this.curY)-this.downY;a=this.downX;d=this.downY}else{b=this.curX-this.downX;c=this.curY-this.downY;a=this.downX;d=this.downY}}}}if(this.mapMode==mapMode.snapshot){this.snapshotBox.resize(b,c);this.snapshotBox.moveTo(a,d)}else{this.layerBorder.resize(b,c);this.layerBorder.moveTo(a,d)}},a9X:function(){this.drag=false;this.cS=false;this.cO=false;this.cN=false;this.cR=false;if(this.zy){this.zy.remove(true);this.zy=null}if(this.tG){this.tG.remove(true);this.tG=null}if(this.layerBorder.style.visibility=="visible"){this.layerBorder.hide();this.layerBorder.resize(1,1);this.layerBorder.moveTo(-10,-10)}if(this.snapshotBox.isVisible()&&!this.snapshotBox.yG6){this.snapshotBox.hide()}removeMouseTipBox()},addPolyline:function(g,f,c,b,a,e){var d=new a9("pline"+this.sv,g,f,c,b,a,e);d.maplet=this;this.aN[this.aN.length]=d;this.sv++},addPolylineString:function(e,a,c){var d=e.split(",");var b=new a9("pline"+this.sv,null,null,(d.length>2)?d[2]:null,(d.length>0)?parseInt(d[0]):0,(d.length>1)?d[1]:1,c);b.maplet=this;this.sv++;b.Decrypt(a);this.aN[this.aN.length]=b},addLabelString:function(b,a,d){var c=cq.Decrypt(a);this.addLabel((b==null)?"http://map.mapbar.com/maplite/images/marker.gif":b,c[1],c[0],d)},addOrigin:function(b,a){aC.setOrigin(parseFloat(b),parseFloat(a))},addDestination:function(b,a){aC.setDestination(parseFloat(b,a))},clean:function(){this.hideBubble();this.removeAllPoints();this.removeAllLabels();this.removeAllLines();pd=new Array();pa=new Array();this.refresh()},showBasePois:function(a){this.bp=a;this.refresh()},showZoomBar:function(a,b){this.ff=a;if(typeof b!="undefined"&&b!=null){if(this.yh!=b){this.yh=b;this.nI().setStyle(this.yh)}}if(this.ff){this.overview.hide();this.nI().show();this.AP.setZoomLevel(this.getZoomLevel())}else{if(this.AP!=null){this.AP.hide()}}},addControl:function(d,e,b,a){if(typeof d=="string"||(typeof d=="object"&&d.toString().indexOf("MStandardControl")>0)){if(this.controlCanvas){this.controlCanvas.g1();this.controlCanvas=null}var c=null;if(typeof d=="string"){if(b==null||b=="undefined"){b=0}if(a==null||a=="undefined"){a=0}c=new MStandardControl(d,b,a,e)}else{if(typeof d=="object"){c=d}}if(c){c.initialize(this)}}else{if(typeof d=="object"){if(this.gc[d.id]){return}ontrol.initialize(this);this.gc[d.id]=d;this.overview.addListener(this.gc[d.id])}}},removeControl:function(a){if(typeof a=="object"&&this.gc[a.id]){this.gc[a.id].remove();this.gc[a.id]=null}},addBound:function(a){if(typeof a!="undefined"){this.bounds[this.bounds.length]=a}},clearAllBounds:function(){for(var a=0;a<this.bounds.length;a++){this.bounds[a]=null}this.bounds.length=0},setScaleBarValue:function(a){},getCurrentMap:function(){var a=this.width*cutImgLonRange[this.zoomLevel]/this.imgWidth;cq.lf=this.centerLat;cq.li=this.centerLon;var e=cq.zn();var c=(this.aO.length>0)?"&pois="+this.aO.length+",":"";for(var b=0;b<this.aO.length;b++){c+=this.aO[b].zn()+","+this.aO[b].xP+","}var d=(this.aN.length>0)?"&plines="+this.aN.length+",":"";for(var b=0;b<this.aN.length;b++){d+=this.aN[b].zn()+";"}var f="";for(var b in this.overLay){if(typeof this.overLay[b]=="object"&&this.overLay[b]!=null&&this.overLay[b].getOverlaySomeAttr){if(f.length==0){f="&overlays="}f+=this.overLay[b].getOverlaySomeAttr()+";"}}return"&map="+this.zoomLevel+","+e+","+this.width+","+this.height+"&zm="+(Math.round(parseFloat(a)*1000)/10)+"&width="+this.width+"&height="+this.height+"&ctr="+e+c+d+"&client="+strLicenseKey+f},getLastPoint:function(){var a="&poi=";if(this.aO.length>0){a+=this.aO[this.aO.length-1].zn()+","+this.aO[this.aO.length-1].xP}return a},getLastLine:function(){var a="&pline=";if(this.aN.length>0){a+=this.aN[this.aN.length-1].zn()}return a},setCursorIcon:function(a){this.gJ=a;this.gI.src=a;removeMouseTipBox()},v1:function(){this.gJ=null;this.gI.src=null},setBgColor:function(a){this.panel.style.backgroundColor=a},setTransparency:function(a){this.layerMap.div.style.filter="alpha(opacity="+a+");";this.layerMap.div.style.MozOpacity=(a/100);this.layerMap.div.style.opacity=(a/100);this.layerMap.div.style.qK=(a/100)},getFitZoomLevel:function(a,c){var b=1;while(a<=c[b]&&b<(c.length)){b++}return(b-1)},setBrushStyle:function(a,b){this.brush.color=a;this.brush.stroke=b},ql:function(){return this.cI},setActive:function(a){this.cI=a},onkeydown:function(a){var b=(a)?a:(window.event)?window.event:null;if(b){var c=(b.fG)?b.fG:((b.keyCode)?b.keyCode:((b.which)?b.which:0));if(c=="37"||c=="38"||c=="39"||c=="40"){if(this.ql()){if(b.target&&((b.target.nodeName=="INPUT"&&b.target.getAttribute("type").toLowerCase()=="text")||b.target.nodeName=="TEXTAREA")){return}if(b.srcElement&&((b.srcElement.tagName=="INPUT"&&b.srcElement.type=="text")||b.srcElement.tagName=="TEXTAREA")){return}if(b.shiftKey||b.ctrlKey){if(c=="37"){this.setRotation(this.rotation-15);this.refresh()}if(c=="39"){this.setRotation(this.rotation+15);this.refresh()}}else{if(c=="37"){this.panTo(this.width/2,0)}if(c=="38"){this.panTo(0,this.height/2)}if(c=="39"){this.panTo(-this.width/2,0)}if(c=="40"){this.panTo(0,-this.height/2)}}}}}},showDiy:function(k){var c=(typeof k=="undefined")?new Array():sdc(k).split(",");var e=(c.length>0);var i=c[0];x6=c[1];var b=c[2];var f=c[3];var g=c[4];var j=c[5];var l=c[6];var d=c[7];if(e){w8=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0)}else{w8=new Array(0,0,0,0,0,0,0,0,75,0,0,-150,0,0)}if(typeof i=="undefined"){minZoomLevel=0}else{minZoomLevel=parseInt(i)}if(typeof x6=="undefined"){this.setStyle("mapbar")}else{this.setStyle(x6,b)}if(typeof f=="undefined"){this.gM=1}else{this.gM=parseFloat(f)}if(typeof d=="undefined"){if(e){this.strImgUrl="http://diyimg.mapbar.com/maplite/"}else{this.strImgUrl=strImgsvrUrl}}else{this.strImgUrl=d}if(typeof l=="undefined"){sz=new Array(-360,360);sy=new Array(-90,90)}else{var a=cq.Decrypt(g);sz=new Array(a[0]-parseFloat(j)/2,a[0]+parseFloat(j)/2);sy=new Array(a[1]-parseFloat(l)/2,a[1]+parseFloat(l)/2)}if(typeof g!="undefined"){this.centerAndZoom(new MPoint(g),maxZoomLevel-1)}},I$mt:function(){var qx=0;var qz=0;var N33=this.width;var oBsQ5=this.height;var u2r9=this.getOverviewRect();var gS1={tn:u2r9.min.x,s4063:u2r9.max.x,width:u2r9.max.x-u2r9.min.x};var D29i0=this.getControlCanvasRect();var n$I={tn:D29i0.min.x,s4063:D29i0.max.x};with(this.controlCanvas){if(isVisible()){if(options.location.type==Maplet.LEFT_TOP||options.location.type==Maplet.LEFT_BOTTOM){qx=Math.max(qx,D29i0.max.x)}else{N33=Math.min(N33,D29i0.min.x)}}}with(this.overview){if(fg){if(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM){qx=Math.max(qx,u2r9.max.x+location.marginx)}else{N33=Math.min(N33,u2r9.min.x)}}}var w=N33-qx;var h=oBsQ5-qz;if(!isNaN(parseInt(avBubble.$AHEx))&&parseInt(avBubble.$AHEx)<w){w=parseInt(avBubble.$AHEx)}if(!isNaN(parseInt(avBubble.KL9ut))&&parseInt(avBubble.KL9ut)<h){h=parseInt(avBubble.KL9ut)}return{min:{x:qx,y:qz},max:{x:N33,y:oBsQ5},width:w,height:h,f0:n$I,overview:gS1}},vlp7N:function(a){this.J_883=true;new foy21(strImgsvrUrl+"mapbank/base/poireport.txt?"+Math.random(),this._96C2,null,null,this,this._96C2).f7c0()},_96C2:function(){if(typeof basepoilist=="object"&&basepoilist){this.refresh()}this.J_883=false},setTrajectory:function(e,a,c,d){this.ux=(c==null||c=="undefined")?5:parseInt(c);this.pid=e;this.lX=d;var j=a.pts;if(j!=null&&j.length>0){var g=0;this.zf=new Array();this.zg=new Array();this.p9=0;for(var b=0;b<j.length;b++){var f=cq.Decrypt(j[b].getPid());this.zg[g]=parseFloat(f[0]);this.zf[g]=parseFloat(f[1]);g++;f=null}j=null}},rotate:function(a){if(this.uw<=this.t9){this.uw=Math.min(this.t9,this.uw+this.xe)}else{if(this.uw>=this.t9){this.uw=Math.max(this.t9,this.uw-this.xe)}}this.setRotation(this.uw);this.refresh();if(this.uw==this.t9){setTimeout(a,100)}else{setTimeout('maplet.rotate("'+a+'")',100)}},doEmulation:function(){try{if(this.p9==0){this.wY=this.zf[0];this.wZ=this.zg[0];this.py=this.p9;this.p9++}if(this.p9<this.zf.length){this.timeoutHandler=null;if(this.pid.icon.div.parentNode!=this.layerDrawMap){this.layerDrawMap.appendChild(this.pid.icon.div.parentNode);this.pid.icon.div.style.zIndex=200}if(this.headMode==1&&rs&&this.py!=this.p9){this.py=this.p9;if(typeof this.lY=="undefined"||this.lY==null){this.lY=document.createElement("div");this.lY.style.position="absolute";this.lY.style.zIndex=1000;this.lY.style.width=parseFloat(this.pid.icon.div.style.width)+"px";this.lY.style.height=parseFloat(this.pid.icon.div.style.height)+"px";this.lY.style.left=(this.width/2-parseFloat(this.pid.icon.div.style.width)/2)+"px";this.lY.style.top=(this.height/2-parseFloat(this.pid.icon.div.style.height)/2)+"px";this.lY.innerHTML="<img src='"+this.pid.icon.imgUrl+"' width='"+parseFloat(this.pid.icon.div.style.width)+"px' height='"+this.pid.icon.div.style.height+"px'>";this.map.appendChild(this.lY)}var k=-90+parseFloat(180*Math.atan2(this.zf[this.p9]-this.zf[this.p9-1],0.8*(this.zg[this.p9]-this.zg[this.p9-1]))/Math.PI);if(k<0){k+=360}k=k%360;if((Math.abs(k-this.rotation)%360)>180){this.rotation+=360}if(this.rotation-180-360>0){this.rotation=(this.rotation-720)}this.uw=this.rotation;this.t9=k;if(this.p9==1){this.setRotation(k);this.setCenter(this.wY,this.wZ)}else{this.setCenter(this.wY,this.wZ);setTimeout('maplet.rotate("maplet.doEmulation()")',500);return}}var f=this.toMapXCoordinate(this.zg[this.p9-1],this.zf[this.p9-1]);var e=this.toMapYCoordinate(this.zf[this.p9-1],this.zg[this.p9-1]);var b=this.toMapXCoordinate(this.zg[this.p9],this.zf[this.p9]);var a=this.toMapYCoordinate(this.zf[this.p9],this.zg[this.p9]);var j=this.toMapXCoordinate(this.wZ,this.wY);var i=this.toMapYCoordinate(this.wY,this.wZ);var g=parseFloat(Math.sqrt((b-f)*(b-f)+(a-e)*(a-e)));var c=parseFloat(Math.sqrt((j-f)*(j-f)+(i-e)*(i-e)))+this.ux;if(c<=(g-this.ux)){j=f+c*(b-f)/g;i=e+c*(a-e)/g;this.wZ=this.zg[this.p9-1]+c*(this.zg[this.p9]-this.zg[this.p9-1])/g;this.wY=this.zf[this.p9-1]+c*(this.zf[this.p9]-this.zf[this.p9-1])/g}else{j=b;i=a;this.wZ=this.zg[this.p9];this.wY=this.zf[this.p9];this.p9++}if(this.headMode==0){this.pid.icon.div.style.top=(i-parseFloat(this.pid.icon.div.style.height))+"px";this.pid.icon.div.style.left=(j-parseFloat(this.pid.icon.div.style.width)/2)+"px"}if(this.headMode==1&&rs){this.mapContainer.div.style.top=parseFloat(this.mapContainer.div.style.top)+this.ux;this.timeoutHandler=getTimeout(this,this.doEmulation,100)}else{if(j<0){this.panTo(this.width/2,this.height/2-i,"maplet.doEmulation()")}else{if(j>this.width){this.panTo(-this.width/2,this.height/2-i,"maplet.doEmulation()")}else{if(i<0){this.panTo(this.width/2-j,this.height/2,"maplet.doEmulation()")}else{if(i>this.height){this.panTo(this.width/2-j,-this.height/2,"maplet.doEmulation()")}else{this.timeoutHandler=getTimeout(this,this.doEmulation,10)}}}}}}else{this.timeoutHandler=null;this.zf=null;this.zg=null;this.pid.icon.div.style.zIndex=1;if(this.lY){if(this.lY.parentNode){this.lY.parentNode.removeChild(this.lY);this.lY=null}}this.setRotation(0);this.refresh();if(this.lX!=null||this.lX!="undefined"){this.lX()}}}catch(d){}},stopEmulation:function(){if(this.p9&&this.zf){this.p9=this.zf.length}},getMarkersInPolygon:function(c){var a=[];var f=[];for(var b=0;b<c.pts.length;b++){f.push({x:c.pts[b].mapX,y:c.pts[b].mapY})}var e=this.getMarkers();for(var b=0;b<e.length;b++){var d={x:e[b].pt.mapX,y:e[b].pt.mapY};if(_isInsidePolygon(d,f)){a.push(e[b])}}return a},getMarkerPolygons:function(b){var e=this.getPolylines(2);var a=[];if(e.length>0){var g={x:b.pt.mapX,y:b.pt.mapY};for(var d=0;d<e.length;d++){var j=[];var c=e[d];for(var f=0;f<c.pts.length;f++){j.push({x:c.pts[f].mapX,y:c.pts[f].mapY})}if(_isInsidePolygon(g,j)){a.push(c)}}}return a},getImgServerId:function(a,b){return this.imgServerId[(a%2)<0?0:a%2][(b%2)<0?0:b%2]},Vye:function(d){var b=parseInt(this.mwIndicator.Div[0].style.borderTopWidth);if(this.mwIndicator.Timer!=null&&((d<0&&b==0)||(d>0&&b==2))){return}var e={left:this.curX,top:this.curY};var c=null;var a=null;if(d<0){a=this.p5S1A;c=this.mwIndicator.bigSize;this.nmX0(true)}else{a=this.S8$;c=this.mwIndicator.smallSize;this.nmX0(false)}e.left-=c.width/2;e.top-=c.height/2;this.VM3(true,c,e);this.mwIndicator.Timer=getTimeout(this,a,this.mwIndicator.interval)},nmX0:function(a){var b=this.mwIndicator.Div;if(a){b[0].style.borderWidth="0px 2px 2px 0px";b[1].style.borderWidth="0px 0px 2px 2px";b[2].style.borderWidth="2px 2px 0px 0px";b[3].style.borderWidth="2px 0px 0px 2px"}else{b[0].style.borderWidth="2px 0px 0px 2px";b[1].style.borderWidth="2px 2px 0px 0px";b[2].style.borderWidth="0px 0px 2px 2px";b[3].style.borderWidth="0px 2px 2px 0px"}},S8$:function(){this.NGEmd(false)},p5S1A:function(){this.NGEmd(true)},NGEmd:function(a){if(this.mwIndicator.fB878<=this.mwIndicator.I403){var e=this.mwIndicator.container;var d=this.mwIndicator.xd*this.mwIndicator.fB878;var b=e.offsetWidth*d;e.style.left=(a?e.offsetLeft+b/2:e.offsetLeft-b/2)+"px";e.style.width=(a?e.offsetWidth-b:e.offsetWidth+b)+"px";b=e.offsetHeight*d;e.style.top=(a?e.offsetTop+b/2:e.offsetTop-b/2)+"px";e.style.height=(a?e.offsetHeight-b:e.offsetHeight+b)+"px";this.mM6_();this.mwIndicator.fB878++;this.mwIndicator.Timer=getTimeout(this,(a?this.p5S1A:this.S8$),this.mwIndicator.interval-this.mwIndicator.interval*this.mwIndicator.xd)}else{this.VM3(false)}},mM6_:function(){var e=this.mwIndicator.container;var b=4;var a=e.offsetWidth;var d=e.offsetHeight;this.mwIndicator.Div[1].style.left=a-b+"px";this.mwIndicator.Div[2].style.top=d-b+"px";this.mwIndicator.Div[3].style.left=a-b+"px";this.mwIndicator.Div[3].style.top=d-b+"px"},VM3:function(d,a,b){var e=this.mwIndicator.container;e.style.left="100px";e.style.top="100px";if(this.mwIndicator.Timer){window.clearTimeout(this.mwIndicator.Timer);this.mwIndicator.Timer=null}this.mwIndicator.fB878=1;this.mwIndicator.container.style.display=d?"":"none";var e=this.mwIndicator.container;if(typeof b=="object"&&b){e.style.left=b.left+"px";e.style.top=b.top+"px"}if(typeof a=="object"&&a){e.style.width=a.width+"px";e.style.height=a.height+"px";this.mM6_()}},getControlCanvasRect:function(){var r={min:{x:0,y:0},max:{x:0,y:0}};with(this.controlCanvas){var D29i0=getRect();if(isVisible()){r.min=D29i0._min;r.max=D29i0._max}}return r},getOverviewRect:function(){var a={min:{x:0,y:0},max:{x:0,y:0}};if(this.overview){a=this.overview.getRect()}if(a.min.x==0&&a.max.x==0){a={min:{x:this.width,y:this.height},max:{x:this.width,y:this.height}}}return a},P241C:function(b,g,t){if(typeof g!="boolean"){g=true}if(typeof t!="boolean"){t=true}var u=b.RE6;var n=b.I6036;var e=b.Ch9Y4;var d=b.fU4U3;var v=0;var p=0;var q=0;var o=0;var c=this.width;var j=this.height;if(g||t){var i={min:{x:b.RE6,y:b.I6036},max:{x:b.Ch9Y4,y:b.fU4U3},width:b.Ch9Y4-b.RE6,height:b.fU4U3-b.I6036};var z,m,k;if(t&&this.controlCanvas){var a=this.getControlCanvasRect();z=this.controlCanvas.options.location;m=(z.type==Maplet.LEFT_TOP||z.type==Maplet.LEFT_BOTTOM);k=(z.type==Maplet.LEFT_TOP||z.type==Maplet.RIGHT_TOP);if(_isRectint(i,a)){if(m){q=a.max.x}else{c=a.min.x}}else{if(m){if(k&&i.min.x<a.max.x&&(i.min.y<a.max.y||(i.height>this.height-a.max.y))){q=a.max.x}else{if(!k&&i.min.x<a.max.x&&(i.max.y>a.min.y||(i.height>a.min.y))){q=a.max.x}}}else{if(k&&i.max.x>a.min.x&&(i.min.y<a.max.y||(i.height>this.height-a.max.y))){c=a.min.x}else{if(!k&&i.max.x>a.min.x&&(i.max.y>a.min.y||(i.height>a.min.y))){c=a.min.x}}}}}if(g&&this.overview){var f=this.getOverviewRect();z=this.overview.location;m=(z.type==Maplet.LEFT_TOP||z.type==Maplet.LEFT_BOTTOM);k=(z.type==Maplet.LEFT_TOP||z.type==Maplet.RIGHT_TOP);if(_isRectint(i,f)){if(m){q=Math.max(q,f.max.x)}else{c=Math.min(c,f.min.x)}}else{if(m){if(k&&i.min.x<f.max.x&&(i.min.y<f.max.y||(i.height>this.height-f.max.y))){q=Math.max(q,f.max.x)}else{if(!k&&i.min.x<f.max.x&&(i.max.y>f.min.y||(i.height>f.min.y))){q=Math.max(q,f.max.x)}}}else{if(k&&i.max.x>f.min.x&&(i.min.y<f.max.y||(i.height>this.height-f.max.y))){c=Math.min(c,f.min.x)}else{if(!k&&i.max.x>f.min.x&&(i.max.y>f.min.y||(i.height>f.min.y))){c=Math.min(c,f.min.x)}}}}}}if(u<q){v=u-q}if(n<o){p=n-o}if(e>c){if(v==0){v=e-c}else{v=0}}if(d>j){if(p==0){p=d-j}else{p=0}}return{s0_3:v,cnA:p}},OaB:function(d,b){if(typeof b!="object"||!b){b={isVerifyOverviewRectint:true,isVerifyControlRectint:true,rF3:true}}var e=this.P241C(d,b.isVerifyOverviewRectint,b.isVerifyControlRectint,b.rF3);var a=e.s0_3;var c=e.cnA;if(a!=0||c!=0){if(typeof d.jfS6F!="number"){d.jfS6F=0}if(typeof d.t0aW!="number"){d.t0aW=0}if(a!=0){a=(a<0?a-d.jfS6F:a+d.jfS6F)}if(c!=0){c=(c<0?c-d.t0aW:c+d.t0aW)}maplet.panTo(-a,-c)}return e},viewOverlay:function(f,i,c){var p=f.toString();var b=p.indexOf("MMarker")!=-1;var l=p.indexOf("MPolyline")!=-1;var j=p.indexOf("MEllipse")!=-1;var d=p.indexOf("MRoundRect")!=-1;var g=0,e=0,o=0,k=0;if(b&&f.icon){var n=f;g=n.pt.mapX-n.icon.anchorX;e=n.pt.mapY-n.icon.anchorY;o=g+parseInt(n.icon.div.style.width);k=e+parseInt(n.icon.div.style.height)}else{if(l){var a=f.getCenterXY();g=a.x-16;e=a.y-16;o=g+32;k=e+32}else{if(j){g=f.gC.mapX-16;e=f.gC.mapY-16;o=g+32;k=e+32}else{if(d){var m=f.getCenterXY();g=m.x-16;e=m.y-16;o=g+32;k=e+32}}}}return this.OaB({RE6:g,I6036:e,Ch9Y4:o,fU4U3:k,jfS6F:i,t0aW:c})},J6s3H:function(){this.layerContainer=new MDiv("LayerContainer",0,0,this.width,this.height,true,2,"",this.mapContainer)},LAK:function(){for(var a in this.layerData){this.layerData[a]=null;delete this.layerData[a]}},getImgByXY:function(b,f,a){if(typeof a!="boolean"){a=false}var c=this.Clip[((this.zoomLevel).toString(16)+(this.clipNo5X).toString(16)+"l"+(this.clipNo5Y).toString(16)).toLowerCase()];if(typeof c=="object"&&c){var e=Math.floor((b-parseInt(c.style.left))/this.imgWidth);var d=-Math.floor((f-parseInt(c.style.top)+(a?w8[this.zoomLevel]:0))/this.imgHeight);return((this.zoomLevel).toString(16)+(this.clipNo5X+e).toString(16)+"l"+(this.clipNo5Y+d).toString(16)).toLowerCase()}return null},setDragCross:function(visible,left,top){with(this.dragCross){if(typeof left!="undefined"){container.div.style.left=left+"px"}if(typeof top!="undefined"){container.div.style.top=top+"px"}if(container.div.parentNode!=this.panel){this.panel.appendChild(container.div);container.div.style.zIndex=2}if(container.div.style.display!=(visible?"":"none")){container.div.style.display=(visible?"":"none")}if(overlay){overlay.fL5n();overlay=null}}},buildVCanvasDiv:function(){if(!this.HF2){this.HF2=document.createElement("div");this.HF2.id=isIE?"vCanvasVML":"vCanvasSVG";this.HF2.style.position="absolute";this.HF2.unselectable="on";this.HF2.style.zIndex=0;this.HF2.style.MozUserSelect="none";this.layerDrawMap.appendChild(this.HF2);if(!isIE){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("id","LayerDrawSVG");b.setAttribute("version","1.1");b.setAttribute("overflow","visible");b.setAttribute("viewBox","-"+this.width+" -"+this.height+" "+this.width*3+" "+this.height*3);b.setAttribute("style","position: absolute; left: -"+this.width+"px; top: -"+this.height+"px; z-index: 0;");b.setAttribute("height",this.height*3+"px");b.setAttribute("width",this.width*3+"px");b.setAttribute(_dragmap,"true");var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 0 0 L 10 5 L 0 10 L 4 5 z");c.setAttribute("fill",this.brush.color);c.setAttribute("fill-opacity",this.brush.bgtransparency/100+0.3);var a=document.createElementNS("http://www.w3.org/2000/svg","marker");a.setAttribute("id","svgArrow");a.setAttribute("viewBox","0 0 10 10");a.setAttribute("refX","6");a.setAttribute("refY","5");a.setAttribute("markerUnits","strokeWidth");a.setAttribute("orient","auto");a.appendChild(c);b.appendChild(a);this.HF2.appendChild(b)}}return this.HF2},setSumMove:function(a,b){if(this.sumMoveX>this.ignoreMoveRange||this.sumMoveX<-this.ignoreMoveRange){a=Math.abs(a);if(this.sumMoveX<0){this.sumMoveX=Math.abs(this.sumMoveX)}}this.sumMoveX+=a;if(this.sumMoveY>this.ignoreMoveRange||this.sumMoveY<-this.ignoreMoveRange){b=Math.abs(b);if(this.sumMoveY<0){this.sumMoveY=Math.abs(this.sumMoveY)}}this.sumMoveY+=b},autoZoomLogo:function(){}};Maplet.prototype.toString=function(){return"com.mapbar.maplet.Maplet"};Maplet.prototype.setIwStdSize=function(a,b){if(typeof a!="number"){a=260}if(typeof b!="number"){b=240}if(a<avBubble.minWidth){a=avBubble.minWidth}if(b<avBubble.minHeight){b=avBubble.minHeight}avBubble.width=a;avBubble.height=b};Maplet.prototype.setIwZoomInSize=function(a,b){if(typeof a!="number"){a=""}if(typeof b!="number"){b=""}if(a<avBubble.width){a=""}if(b<avBubble.height){b=""}avBubble.$AHEx=a;avBubble.KL9ut=b};Maplet.prototype.addLayer=function(b){if(b&&b instanceof MLayer){if(!this.qS[b.id]){b.initialize(this);this.qS[b.id]=b;var a=b.options.zindex+10;if(typeof this.W_7[a]!="undefined"){this.W_7[a].push(b)}else{this.W_7[a]=[b]}this.refresh()}}else{return false}return true};Maplet.prototype.removeLayer=function(e,f){if(typeof f!="boolean"){f=false}if(e&&e instanceof MLayer&&this.qS[e.id]&&typeof e.remove=="function"){this.qS[e.id].remove(f);this.qS[e.id]=null;delete this.qS[e.id];var c=e.options.zindex+10;if(typeof this.W_7[c]!="undefined"){var b=this.W_7[c];if(b.length==1){this.W_7[c]=undefined}else{for(var d=0;d<b.length;d++){if(b[d]==e){b.splice(d,1)}}}}}};Maplet.prototype.clearLayer=function(b){if(!this.layerContainer){return}for(var a in this.qS){if(this.qS[a].options.creator==MLayer.USER){this.removeLayer(this.qS[a],b)}}if(!this.traffic&&!this.b51x){this.layerContainer.clear();removeNode(this.layerContainer.div);this.layerContainer=null;this.W_7=[]}};Maplet.prototype.getLayers=function(){var b=[];for(var a in this.qS){if(this.qS[a].options.creator==MLayer.USER){b.push(this.qS[a])}}return b};Maplet.prototype.addPanel=function(a){if(a&&a instanceof MPanel){if(this.R03GR[a.id]){return true}a.initialize(this);this.R03GR[a.id]=a}else{return false}};Maplet.prototype.removePanel=function(a,b){if(typeof b!="boolean"){b=false}if(typeof a=="object"){if(this.R03GR[a.id]){a.remove(b);this.R03GR[a.id]=null;delete this.R03GR[a.id]}else{if(typeof a.remove=="function"){a.remove(b)}}}else{if(typeof a=="string"){if(this.R03GR[a]){this.R03GR[a].remove(b);this.R03GR[a]=null;delete this.R03GR[a]}}}};Maplet.prototype.getPanels=function(){var b=[];for(var a in this.R03GR){if(this.R03GR[a].options.creator==MPanel.USER){b.push(this.R03GR[a])}}return b};Maplet.prototype.clearPanels=function(b){for(var a in this.R03GR){if(this.R03GR[a].options.creator==MPanel.USER){this.removePanel(this.R03GR[a],b)}}};Maplet.prototype.addOverlay=function(a){if(typeof a=="object"){if(this.overLay[a.id]){return}a.initialize(this);this.overLay[a.id]=a}};Maplet.prototype.getZoomLevel=function(){return this.zoomLevel};Maplet.prototype.clearOverlays=function(a){if(typeof a!="boolean"){a=false}this.hideBubble(this);for(var b in this.overLay){if(this.overLay[b]&&this.overLay[b].remove){this.overLay[b].remove(a);this.overLay[b]=null;delete this.overLay[b]}}};Maplet.prototype.removeOverlay=function(a,b){if(typeof b!="boolean"){b=false}if(typeof a=="object"){if(this.overLay[a.id]){this.overLay[a.id].remove(b);this.overLay[a.id]=null;delete this.overLay[a.id]}else{if(typeof a.remove=="function"){a.remove(b)}}}else{if(typeof a=="string"){if(this.overLay[a]){this.overLay[a].remove(b);this.overLay[a]=null;delete this.overLay[a]}}}};Maplet.prototype.clearCache=function(){cq.pu=null;cq.pu={}};Maplet.prototype.setAutoZoom=function(b,r,p,o){var c=[];if(this.setAutoZoom.arguments.length==0){for(var l in this.overLay){if(this.overLay[l]&&this.overLay[l].remove){if(this.overLay[l].toString()=="com.mapbar.maplet.MMarker"){c.push(cq.Decrypt(this.overLay[l].pt.getPid()))}else{if(this.overLay[l].toString()=="com.mapbar.maplet.MPolyline"){var a=this.overLay[l].pts;for(var g=0;g<a.length;g++){c.push(cq.Decrypt(a[g].getPid()))}}}}}if(c.length==0){return false}else{b=90;r=180;p=-90;o=-180;for(var n=0;n<c.length;n++){b=Math.min(parseFloat(c[n][1]),b);r=Math.min(parseFloat(c[n][0]),r);p=Math.max(parseFloat(c[n][1]),p);o=Math.max(parseFloat(c[n][0]),o)}}}if(isNaN(parseFloat(b))){var t=cq.Decrypt(b);var q=cq.Decrypt(r);b=t[1];r=t[0];p=q[1];o=q[0]}var m=1.1*(p-b)*this.imgWidth/this.height;var k=1.1*(o-r)*this.imgWidth/this.width;var e=this.getFitZoomLevel(m,cutImgLatRange);var d=this.getFitZoomLevel(k,cutImgLonRange);var f=Math.min(e,d);cq.lf=(p+b)/2;cq.li=(o+r)/2;this.centerAndZoom(new MPoint(cq.zn()),f);return true};Maplet.prototype.setZoomLevel=function(zoomLevel,isReturn,sN5o){this.fI(zoomLevel);zoomLevel=parseInt(zoomLevel);if(zoomLevel<minZoomLevel){zoomLevel=minZoomLevel}if(zoomLevel>maxZoomLevel){zoomLevel=maxZoomLevel}if(isReturn!=undefined&&!isReturn){return zoomLevel}if(this.markerDragAnimation){with(this.dragCross){if(overlay!=null&&!overlay.isMousemove){this.setDragCross(false)}}}if(zoomLevel!=this.zoomLevel){if(typeof sN5o!="boolean"||sN5o){this.eiKX()}if(apiType==1){MEvent.trigger(this,"zoom",zoomLevel)}else{MEvent.trigger(this,"zoom","&act=zoom&zm="+zoomLevel)}for(var i in this.R03GR){var p=this.R03GR[i];if(p.options.zoomhide&&p.isVisible()){p.setVisible(false)}}this.layerDrawMap.hide()}else{this.W413()}if(this.layerContainer){MLayer.setTipVisible(false)}if(iToolTipStyle==0){hideToolTipMenu()}if(this.controlCanvas!=null){this.controlCanvas.update(zoomLevel)}if(this.gc!=null){for(var n8 in this.gc){if(this.gc[n8].nR){this.gc[n8].nR.controlCanvas.div.update(zoomLevel)}}}if(this.ff){this.nI().setZoomLevel(zoomLevel)}if(ContentInfo&&ContentInfo.isVisible()){var centerXY=this.toScreenCoordinate(avBubble._Tov1);if(_isInsideRect({x:centerXY[0],y:centerXY[1]},{min:{x:0,y:0},max:{x:this.width,y:this.height}})){this.v8q8Y="infowindow";this.U9B2=avBubble._Tov1;this.Cj9mE=centerXY[0];this.dV55V=centerXY[1]}}this.gwb=this.zoomLevel;this.zoomLevel=zoomLevel;this.clipLonRange=cutImgLonRange[this.zoomLevel];this.clipLatRange=cutImgLatRange[this.zoomLevel];this.levelFolder=levelFolder[this.zoomLevel]+"/";if(this.U9B2!=""){var g4=this.Cj9mE-this.width/2;var g5=this.dV55V-this.height/2;var centerXY=this.toScreenCoordinate(this.U9B2);var gp3=centerXY[0]-g4;var L14Li=centerXY[1]-g5;this.centerLon=this.toMapLonCoordinate(gp3,L14Li);this.centerLat=this.toMapLatCoordinate(gp3,L14Li);this.Cj9mE=-1;this.dV55V=-1;this.U9B2="";this.v8q8Y=""}this.clipNo5X=Math.floor((this.centerLon)/this.clipLonRange);this.clipNo5Y=Math.floor((this.centerLat)/this.clipLatRange);if(this.clipNo5X<0){this.clipNo5X+=1}this.mapX=this.width/2-Math.round(((this.centerLon*multiple)%(this.clipLonRange*multiple))*this.imgWidth/(this.clipLonRange*multiple));if(this.centerLat>=0){this.mapY=this.height/2-this.imgHeight+Math.round(((this.centerLat*multiple)%(this.clipLatRange*multiple))*this.imgHeight/(this.clipLatRange*multiple))}else{this.mapY=this.height/2+Math.round(((this.centerLat*multiple)%(this.clipLatRange*multiple))*this.imgHeight/(this.clipLatRange*multiple))}this.setBoundRange();this.refresh();this.gwb=this.zoomLevel;this.layerDrawMap.show();if(this.layerContainer){this.layerContainer.setVisible(true)}for(var i in this.R03GR){var p=this.R03GR[i];if(p.options.zoomhide&&!p.isVisible()&&!p.V975J.FTK){p.setVisible(true)}}};Maplet.prototype.setCenter=function(f,e,a,d){if(!this.oA46){this.no();this.oA46=true}var c=f;if(typeof f=="object"){if(!f.encrypt&&!f.maplet){f.initialize(this);c=f.getPid()}else{c=f.pid}}if(isNaN(parseFloat(c))||(typeof c=="string"&&c.indexOf(",")>0)){var b=cq.Decrypt(c);f=b[1];e=b[0]}this.centerLat=Math.min(sy[1],Math.max(sy[0],parseFloat(f)));this.centerLon=Math.min(sz[1],Math.max(sz[0],parseFloat(e)%360));if(typeof basepoilist!="object"&&!this.J_883&&this.m0J){this.m0J=false}if(a==undefined||a){this.setZoomLevel(this.zoomLevel)}if(d==undefined||d){if(apiType==1){MEvent.trigger(this,"pan",new MPoint(this.toMapCoordinate(this.width/2,this.height/2)))}else{MEvent.trigger(this,"pan","&act=pan&ctr="+this.toMapCoordinate(this.width/2,this.height/2))}}};Maplet.prototype.moveTo=function(b,a){this.top=parseInt(a);this.left=parseInt(b);this.panel.style.top=parseInt(a)+"px";this.panel.style.left=parseInt(b)+"px"};Maplet.prototype.getCenter=function(){if(apiType==1){return new MPoint(this.getCurrentMap().split(",").slice(1,3).join(","))}else{return this.getCurrentMap().split(",")[1]}};Maplet.prototype.enableTraffic=function(a){if(typeof a!="object"||!a){a={}}if(!this.traffic){this.traffic=new MTraffic(a);this.traffic.initialize(this)}return this.traffic};Maplet.prototype.disableTraffic=function(){if(this.traffic){this.traffic.remove(true);this.traffic=null}};Maplet.prototype.enablePOILayer=function(a){if(typeof a!="object"||!a){a={}}if(!this.b51x){this.b51x=new MPOILayer(a);this.b51x.initialize(this)}return this.b51x};Maplet.prototype.disablePOILayer=function(){if(this.b51x){this.b51x.remove(true);this.b51x=null}};Maplet.prototype.resize=function(b,d){b=parseInt(b);d=parseInt(d);if(b<0||d<0){return}if(b==this.width&&d==this.height){return}getElementById("myalert").style.visibility="hidden";if(this.snapshotBox.isVisible()){this.snapshotBox.hide()}if(this.stdContextMenu){this.stdContextMenu.hide()}this.hideBubble();this.width=b;this.height=d;setMapLoading2Center(this);this.halfNum5clipX=Math.ceil((this.width)/(this.imgWidth)/2);this.halfNum5clipY=Math.ceil((this.height)/(this.imgHeight)/2);this.panel.style.width=b+"px";this.panel.style.height=d+"px";this.panel.style.clip="rect(0px,"+this.width+"px,"+this.height+"px, 0isIE)";this.mapContainer.resize(b,d);this.layerMap.resize(b,d);this.layerPoiMap.resize(b,d);if(this.layerContainer){this.layerContainer.resize(b,d);for(var c in this.qS){this.qS[c].resize(b,d)}}if(this.ff){this.nI().resize(d);this.nI().moveTo(this.width-16,0)}this.VgxX4();this.onresize();var e=(navigator.appVersion.match(new RegExp("6.","i"))=="6.")?0:2;this.layerDrawMap.resize(b,d);this.setZoomLevel(this.zoomLevel);if(this.layerContainer){for(var c in this.qS){this.qS[c].refreshDataXY()}}for(var a in this.gc){if(this.gc[a]&&this.gc[a].onresize){this.gc[a].onresize(this)}}this.overview.onresize()};Maplet.prototype.zoomIn=function(){if(this.zoomLevel>=maxZoomLevel){return}if(ContentInfo&&ContentInfo.isVisible()){this.setZoomLevel(this.zoomLevel+1)}else{this.zoomTo(Math.min(maxZoomLevel,this.zoomLevel+1))}};Maplet.prototype.zoomOut=function(){if(this.zoomLevel<=minZoomLevel){return}if(ContentInfo&&ContentInfo.isVisible()){this.setZoomLevel(this.zoomLevel-1)}else{this.zoomTo(Math.max(0,this.zoomLevel-1))}};Maplet.prototype.centerAndZoom=function(b,a){this.setCenter(b,"",false);if(typeof this.mapContainer=="undefined"){this.zoomLevel=this.setZoomLevel(a,false);this.showMap()}else{this.setZoomLevel(a)}};Maplet.prototype.zoomTo=function(level,callback,x,y){if(callback){this.callback=callback}if(ZOOM_TRANSITION&&(!ContentInfo||!ContentInfo.isVisible())){if(this.AZ!=null){clearTimeout(this.AZ)}this.AZ=null;if(typeof level!="undefined"){this.AT=parseInt(level);if(typeof x=="undefined"){this.vc=0}else{this.vc=parseInt(x)}if(typeof y=="undefined"){this.vd=0}else{this.vd=parseInt(y)}this.AZ=getTimeout(this,this.zoomTo,200)}else{var vG=new Number();if(this.AT>this.getZoomLevel()){if(this.AS<=(this.AT-this.AY)){if(this.AS==-1){this.AS=this.getZoomLevel()+this.AY}else{this.AS+=this.AY}vG=(this.AS-this.getZoomLevel());this.AN(this.AS,2*this.vc*vG,2*this.vd*vG);this.AZ=getTimeout(this,this.zoomTo,20)}else{this.AS=-1;this.panCenterLat=this.toMapLatCoordinate(-this.vc+this.width/2,-this.vd+this.height/2);this.panCenterLon=this.toMapLonCoordinate(-this.vc+this.width/2,-this.vd+this.height/2);this.setCenter(this.panCenterLat,this.panCenterLon,false,false);this.setZoomLevel(this.AT);if(this.callback){if(ContentInfo&&ContentInfo.isVisible()){ContentInfo.setVisible(avBubble.E85J())}eval(this.callback)}}}else{if(this.AT<this.getZoomLevel()){if(this.AS==-1||this.AS>=(this.AT+this.AY)){if(this.AS==-1){this.AS=this.getZoomLevel()-this.AY}else{this.AS-=this.AY}vG=Math.abs(this.AS-this.getZoomLevel());this.AN(this.AS,2*this.vc*vG,2*this.vd*vG);this.AZ=getTimeout(this,this.zoomTo,20)}else{this.AS=-1;this.panCenterLat=this.toMapLatCoordinate(-this.vc+this.width/2,-this.vd+this.height/2);this.panCenterLon=this.toMapLonCoordinate(-this.vc+this.width/2,-this.vd+this.height/2);this.setCenter(this.panCenterLat,this.panCenterLon,false,false);this.setZoomLevel(this.AT);if(this.callback){if(ContentInfo&&ContentInfo.isVisible()){ContentInfo.setVisible(avBubble.E85J())}eval(this.callback)}}}}}}else{this.setZoomLevel(level)}};Maplet.prototype.panTo=function(a,c,b){if(this.doPaning){return}this.xoffset=parseFloat(a);this.yoffset=parseFloat(c);this.mapContainerLeft=0;this.mapContainerTop=0;this.callback=b;this.panCenterLon=this.toMapLonCoordinate(-this.xoffset+this.width/2,-this.yoffset+this.height/2);this.panCenterLat=this.toMapLatCoordinate(-this.xoffset+this.width/2,-this.yoffset+this.height/2);this.panToDistance=parseInt(Math.sqrt(this.xoffset*this.xoffset+this.yoffset*this.yoffset));this.doPan()};Maplet.prototype.toMapCoordinate=function(a,b){cq.li=this.toMapLonCoordinate(a,b);cq.lf=this.toMapLatCoordinate(a,b);return cq.zn()};Maplet.prototype.toScreenCoordinate=function(c){var d=[null,null];try{var a=cq.Decrypt(c);d[0]=this.toMapXCoordinate(a[0],a[1]);d[1]=this.toMapYCoordinate(a[1],a[0])}catch(b){throw_event}return d};Maplet.prototype.showLogo=function(a){if(a){this.logo.style.display="block"}else{this.logo.style.display="none"}this.setRightBottom()};Maplet.prototype.showScale=function(c,b,d,a){this.fe=c;if(this.fe){this.layerScale.show()}else{if(this.layerScale!=null){this.layerScale.hide()}}};Maplet.prototype.showOverview=function(a,b){if(a){this.overview.show();if(b){this.overview.open()}else{this.overview.close()}}else{this.overview.hide();this.overview.close()}};Maplet.prototype.setOverviewLocation=function(a){this.overview.setLocation(a);this.setRightBottom();this.VgxX4()};Maplet.prototype.resizeOverview=function(a,b){this.overview.resizeTo(a,b);this.setRightBottom();this.VgxX4()};Maplet.prototype.showControl=function(a){this.stdControlIsShow=a;if(this.stdControlIsShow){if(this.controlCanvas){this.controlCanvas.show()}}else{if(this.controlCanvas){this.controlCanvas.hide()}}this.setRightBottom();this.VgxX4()};Maplet.prototype.getViewBound=function(){return{LeftUp:this.toMapCoordinate(0,0),LeftDown:this.toMapCoordinate(0,this.height),RightUp:this.toMapCoordinate(this.width,0),RightDown:this.toMapCoordinate(this.width,this.height)}};Maplet.prototype.calcPointsCt=function(f){var c=Number.MAX_VALUE,e=c,a=-Number.MAX_VALUE,d=a;for(var b=0;b<f.length;b++){if(!f[b].maplet){f[b].initialize(this)}c=Math.min(c,f[b].mapX);e=Math.min(e,f[b].mapY);a=Math.max(a,f[b].mapX);d=Math.max(d,f[b].mapY)}if(c!=Number.MAX_VALUE){return new MPoint(this.toMapCoordinate(c+(a-c)/2,e+(d-e)/2))}else{return null}};Maplet.prototype.drawMap=function(){if(this.c0){return}if(this.fs){return}this.c0=true;this.fs=true;sb=0;if(this.O7Qx.length>0){if(((this.u2!=null&&this.u2=="traffic")||this.zoomLevel!=this.gwb)||bpp[0]!=this.oA19i){for(var W=0;W<this.O7Qx.length;W++){this.O7Qx[W].onmousedown=null;removeNode(this.O7Qx[W])}this.O7Qx=[]}this.oA19i=bpp[0]}this.G94$();var F="";if(this.layerContainer){this.LAK()}var m=0;var C=this.mapName;var aa=(this.u2=="undefined"||this.u2==null)?"poi":this.u2;var d=blockSize[this.zoomLevel];this.sZ=0;this.s1=0;this.tf1=this.width;this.tg=this.height;this.s2=parseInt(this.clipNo5X);this.s3=parseInt(this.clipNo5Y);this.th=parseInt(this.clipNo5X);this.ti=parseInt(this.clipNo5Y);var Z=new Array();var t=new Array();var L=parseInt(new Date().getTime()/60000);var v=(360/cutImgLonRange[this.zoomLevel]);var J=this.getZoomLevel()-1;if(this.zoomLevel==this.gwb){this.layerMap.clean()}else{if(typeof basepoilist!="object"&&!this.J_883&&this.m0J){this.m0J=false}}for(var X=-this.halfNum5clipX-1;X<=this.halfNum5clipX;X++){for(var P=-this.halfNum5clipY-1;P<=this.halfNum5clipY;P++){try{var z=parseInt(this.clipNo5X+X);var u=parseInt(this.clipNo5Y+P);z=(z)%v;if(z>=(v/2)){z-=v}if(z<(-v/2)){z+=v}var o=parseInt(Math.floor((z)/d));var n=parseInt(Math.floor((u)/d));if(o<0){o+=1}if(n<0){n+=1}var B=(z)-o*d;var A=(u)-n*d;var c=this.strImgUrl.replace("img","img"+this.getImgServerId(B,A))+"mapbank/"+C+"/"+this.levelFolder;if(this.zoomLevel>=14){c+=o+"/"}var G=this.strImgUrl+"mapbank/"+aa+"/"+this.levelFolder;var N=this.strImgUrl+"mapbank/base/"+this.levelFolder;G+=o+"_"+n+"/";N+=o+"_"+n+"/";c+=o+"_"+n+"/";G+=B+"_"+A+".png";N+=B+"_"+A+".js";c+=B+"_"+A+"."+this.ext;var E=(X*this.imgWidth)+parseInt(this.mapX);var j=(-(P*this.imgHeight)+parseInt(this.mapY));var af=j;if(this.mapName!="aerial"&&this.mapName.indexOf("aerial")<0){j=j+w8[this.zoomLevel]}var e=false;var H=true;var ak=true;if((E<-this.imgWidth||E>this.width||j>this.height||j<-this.imgHeight)){e=true}if(this.u2!=null&&this.u2=="traffic"&&w8[this.zoomLevel]!=0&&((af<this.height||af<=0))){H=false;if(e){c=null}}if(this.layerContainer&&w8[this.zoomLevel]!=0&&((af<this.height||af<=0))){ak=false;if(e){c=null}}if(e&&H&&ak){continue}if(c){if(this.sZ<(E+this.imgWidth)){this.sZ=(E+this.imgWidth);this.s2=parseInt(this.clipNo5X)+parseInt(X)}if(this.s1<(j+this.imgHeight)){this.s1=(j+this.imgHeight);this.ti=parseInt(this.clipNo5Y)+parseInt(P)}if(this.tf1>E){this.tf1=E;this.th=parseInt(this.clipNo5X)+parseInt(X)}if(this.tg>j){this.tg=j;this.s3=parseInt(this.clipNo5Y)+parseInt(P)}}var U=((this.zoomLevel).toString(16)+(this.clipNo5X+X).toString(16)+"l"+(this.clipNo5Y+P).toString(16)).toLowerCase();if(m==0){m=1}if(c&&c.indexOf("NaN")<0){if(this.Clip[U]==null){if(!rs||!isIE){this.Clip[U]=new Image();this.Clip[U].id=U;this.Clip[U].name=U;this.Clip[U].ntry="0";this.Clip[U].unselectable="on";this.Clip[U].style.position="absolute";this.Clip[U].style.MozUserSelect="none"}else{this.Clip[U]=document.createElement("v:Image");this.Clip[U].id=U;this.Clip[U].name=U;this.Clip[U].ntry="0";this.Clip[U].unselectable="on";this.Clip[U].style.position="absolute";this.Clip[U].cE="f";this.Clip[U].style.rotation=this.rotation;this.Clip[U].style.width=this.imgWidth;this.Clip[U].style.height=this.imgHeight}if(isIE){this.Clip[U].style.filter="alpha(opacity=0);"}else{this.Clip[U].style.opacity="0"}f1.nk(this.Clip[U],c,this.imgWidth,this.imgHeight)}else{if(isIE&&rs){this.Clip[U].style.rotation=this.rotation}}var ai=(E+this.imgWidth/2-this.width/2)*this.rotationCosVal-(j+this.imgHeight/2-this.height/2)*this.rotationSinVal+this.width/2;var ae=(E+this.imgWidth/2-this.width/2)*this.rotationSinVal+(j+this.imgHeight/2-this.height/2)*this.rotationCosVal+this.height/2;this.Clip[U].style.top=parseInt(ae-this.imgHeight/2)+"px";this.Clip[U].style.left=parseInt(ai-this.imgWidth/2)+"px";this.Clip[U].isShow=true;this.Clip[U].setAttribute("origy",parseInt(ae-this.imgHeight/2));this.Clip[U].setAttribute("origx",parseInt(ai-this.imgWidth/2))}if(this.u2!=null&&this.u2=="traffic"){if(!__mapbar_magic_id){__mapbar_magic_id=""}var D=bpp[0]+__mapbar_magic_id+"/"+J+"/o"+U+".png";if(isIE6){var am=document.createElement("v:image");am.setAttribute("unselectable","on");am.id="o"+U;am.setAttribute("name",U);am.setAttribute("traffic","yes");am.style.cssText="position:absolute;top:"+af+"px;left:"+E+"px;width:300px;height:300px";am.src=D;this.O7Qx.push(am)}else{var k=document.createElement("IMG");k.id="o"+U;k.setAttribute("name",U);k.src=D;k.ntry="0";k.unselectable="on";k.onerror=function(){imageTileError(this)};k.onload=function(){imageTileOk(this)};k.onmousedown=function(){return false};k.style.cssText="position:absolute;top:"+af+"px;left:"+E+"px;-moz-user-select: none;";k.setAttribute("traffic","yes");this.O7Qx.push(k)}Z[Z.length]="o"+U;t[t.length]=o+"_"+n+"/"}else{if(this.u2!=null&&this.u2!="undefined"&&G&&G.indexOf("NaN")<0){if(this.Clip[U]){var M="o"+U;var T=o+"_"+n+"/";if((bpp[0]!=mapliteUrl+"mapbank/base/"||(typeof basepoilist=="object"&&basepoilist[levelFolder[this.zoomLevel]+"/"+T+M+".png"]))||DISABLE_OLD_GOLDPOI){var ah=getElementById(M);if(!ah){ah=document.createElement("DIV");ah.setAttribute("unselectable","on");ah.id=M;ah.setAttribute("name",U);ah.style.cssText="position:absolute;width:0px;height:0px;";this.O7Qx.push(ah)}ah.style.left=E+"px";ah.style.top=af+"px";Z[Z.length]=M;t[t.length]=T}}}}if(this.layerContainer){this.layerData[U]={filename:this.levelFolder+o+"_"+n+"/"+B+"_"+A,folderX:o,folderY:n,grid:U,fileXNo:B,fileYNo:A,dirname:o+"_"+n,xyname:B+"_"+A,x:E,y:af}}c=null;G=null}catch(b){throw (b)}}}for(var R in this.Clip){var k=this.Clip[R];if(k!=null&&typeof k=="object"){if((typeof k.isShow=="boolean"&&k.isShow)||k.isShow=="true"){if(k.parentNode!=this.layerMap.div){if(k.parentNode!=null){k.parentNode.removeChild(k)}this.layerMap.div.appendChild(k)}}else{if(k.parentNode!=this.mapContainerBg.div){if(k.parentNode!=null){removeNode(k)}k.onerror=null;k.onload=null;k=null;delete this.Clip[R]}}}}if(!(this.u2!=null&&this.u2=="traffic")&&this.O7Qx.length>0){var S=Z.join(",");for(var Q=this.O7Qx.length-1;Q>=0;Q--){if(S.indexOf(this.O7Qx[Q].id)==-1){if(this.O7Qx[Q].parentNode){removeNode(this.O7Qx[Q])}this.O7Qx.splice(Q,1)}}for(var Q=Z.length-1;Q>=0;Q--){if(getElementById(Z[Q])){Z.splice(Q,1)}}}if(this.O7Qx.length>0){for(var V=0;V<this.O7Qx.length;V++){this.layerDrawMap.div.appendChild(this.O7Qx[V])}}F=null;for(var O in this.R03GR){var W=this.R03GR[O];if(W.paint){W.paint()}}if(this.layerContainer){for(var ab in this.qS){if(this.qS[ab].inZoomRange(this.zoomLevel)){this.qS[ab].update()}else{this.qS[ab].clear()}}}if(this.layerMap.div.parentNode!=this.mapContainer.div){this.mapContainer.div.appendChild(this.layerMap.div)}if(this.layerPoiMap.div.parentNode!=this.mapContainer.div){this.mapContainer.div.appendChild(this.layerPoiMap.div)}if((typeof this.fo=="boolean"&&this.fo)&&document.getElementById("LayerMap")&&document.getElementById("LayerMap").filters&&document.getElementById("LayerMap").filters.length>0){document.getElementById("LayerMap").filters[0].apply();document.getElementById("LayerMap").filters[0].vu()}if(this.aN.length>0){for(var al=0;al<this.aN.length;al++){this.aN[al].paint()}}if(this.zy!=null){this.zy.paint();if(this.tG!=null){this.tG.paint()}}if(this.aO.length>0){for(al=0;al<this.aO.length;al++){this.aO[al].u9(this.layerPoiMap.div);this.aO[al].paint(this.layerDrawMap.div)}}if(this.yG.length>0){if(!isIE){this.yG[this.yG.length-1].label(this.layerDrawMap.graphics)}}else{if(iToolTipStyle==0){hideToolTipMenu()}}if(this.layerDrawMap.div.parentNode!=this.mapContainer.div){this.mapContainer.div.appendChild(this.layerDrawMap.div)}if(this.aE.length>0){this.aG=null;this.aH=null;this.aF=null;for(al=0;al<this.aE.length;al++){if(this.zoomLevel>=this.aE[al].AJ&&this.zoomLevel<=this.aE[al].AI){var K=this.toMapXCoordinate(this.aE[al].li,this.aE[al].lf);var I=this.toMapYCoordinate(this.aE[al].lf,this.aE[al].li);if(K>=0&&K<=this.width&&I>=0&&I<=this.height){if(this.aG==null){this.aG=new Array();this.aH=new Array();this.aF=new Array()}this.aG[this.aG.length]=K;this.aH[this.aH.length]=I;this.aF[this.aF.length]=al}}}}if(!this.cH){this.cH=true}if(this.u2!=null&&this.u2!="undefined"){if(this.u2=="base"){if(this.zoomLevel>=parseInt(bpp[1])&&this.zoomLevel<=parseInt(bpp[2])){if(!this.m0J&&!DISABLE_OLD_GOLDPOI){this.vlp7N();this.m0J=true}var ab=0;for(var Y in Z){try{if(typeof Z[Y]=="string"){if(bpp[0]!=mapliteUrl+"mapbank/base/"||typeof basepoilist=="object"&&basepoilist[levelFolder[this.zoomLevel]+"/"+t[Y]+Z[Y]+".png"]){if(!DISABLE_OLD_GOLDPOI){new foy21(bpp[0]+levelFolder[this.zoomLevel]+"/"+t[Y]+Z[Y]+".png",parseInt,false,true).f7c0()}}ab++}}catch(aj){throw (aj)}Z[Y]=null;t[Y]=null}}else{for(var r in Z){try{if(typeof Z[r]=="string"&&document.getElementById(Z[r])&&document.getElementById(Z[r]).parentNode){if(!DISABLE_OLD_GOLDPOI){removeNode(getElementById(Z[r]))}}}catch(b){throw (b)}Z[r]=null;t[r]=null}}}else{L=parseInt(new Date().getTime()/60000);for(var g in Z){try{if((this.u2!="traffic")&&typeof Z[g]=="string"){XMLHttp.sendReq("GET","maplite/"+this.u2+".jsp?"+this.u3+"&oid="+Z[g]+"&epoch="+L,"",vB,Z[g])}}catch(b){throw (b)}Z[g]=null;t[g]=null}}Z.length=0;Z=null;t.length=0;t=null}this.c0=false;this.fs=false;for(var ab=0;ab<2;ab++){for(var a in this.overLay){if(this.overLay[a]&&this.overLay[a].paint){if(ab==0&&this.overLay[a] instanceof MMarker&&!this.overLay[a].isMousemove){this.overLay[a].paint()}else{if(ab==1&&this.overLay[a].u$2V){this.overLay[a].paint()}}}}}avBubble.followOverlay();if(this.overview){this.overview.paint()}cq.lf=this.centerLat;cq.li=this.centerLon;var f=cq.zn();this.yu=f+"@"+this.zoomLevel;if(ALLOW_MV){try{var ag="@mapbar"+(new Date().getTime()%86400).toString(36);sB.src="http://mv.mapbar.com/?"+this.yu+"@"+this.yt+"@"+this.width.toString(36).toUpperCase()+"@"+this.height.toString(36).toUpperCase()+"@"+this.mapMode.toString(36).toUpperCase()+"@"+c75+"@"+strLicenseKey.toString(36).toUpperCase()+"@"+this.mapName+"@"+((bp)?1:0)+"@"+((this.u2)?this.u2:"")+ag}catch(b){throw (b)}}this.mapContainer.moveTo(0,0);this.layerPoiMap.moveTo(0,0);this.layerDrawMap.moveTo(0,0);MEvent.trigger(this,"update",this.yu)};Maplet.prototype.getEllipse=function(){var b=[];for(var a in this.overLay){if(this.overLay[a] instanceof MEllipse){b.push(this.overLay[a])}}return b};Maplet.prototype.getRoundRect=function(){var b=[];for(var a in this.overLay){if(this.overLay[a] instanceof MRoundRect){b.push(this.overLay[a])}}return b};Maplet.prototype.getMarkers=function(){var b=[];for(var a in this.overLay){if(this.overLay[a] instanceof MMarker){b.push(this.overLay[a])}}return b};Maplet.prototype.getPolylines=function(a){if(typeof a!="number"){a=1}var c=[];for(var b in this.overLay){if(this.overLay[b] instanceof MPolyline){if(a==2&&!this.overLay[b].hHTG3()){continue}else{if(a==3&&this.overLay[b].hHTG3()){continue}}c.push(this.overLay[b])}}return c};Maplet.prototype.equalsLLCoords=function(d,e,b){if(typeof d=="string"&&d&&typeof e=="string"&&e){try{if(d==e){return true}if(typeof b!="number"){b=0}var c=maplet.toScreenCoordinate(d);var a=maplet.toScreenCoordinate(e);if((c[0]==a[0]||Math.abs(c[0]-a[0])<=b)&&(c[1]==a[1]||Math.abs(c[1]-a[1])<=b)){return true}}catch(f){}}return false};Maplet.prototype.measDistance=function(g){try{var d=0;var f=g.length;var e=[],c=0,a=0;for(var b=1;b<f;b++){e.push(cq.Decrypt(g[b-1].getPid()));e.push(cq.Decrypt(g[b].getPid()));c=e[1][1]-e[0][1];a=e[1][0]-e[0][0];d+=Math.sqrt(c*c+a*a*0.64);e.length=0}return parseInt(d*this.gM*111111)}catch(i){return 0}};Maplet.prototype.measArea=function(n){try{var d=0;var f=n.length;var m=2;var k=0;for(var j=1;j<=f;j++){var c=(m%f);var e=(k%f);var b=parseFloat(cq.Decrypt(n[(j%f)].getPid())[0]);var l=parseFloat(cq.Decrypt(n[c].getPid())[1]);var a=parseFloat(cq.Decrypt(n[e].getPid())[1]);d+=b*(l-a);m++;k++}return parseInt(Math.abs(d/2)*this.gM*this.gM*100000*100000)}catch(g){return 0}};Maplet.prototype.decodeLine=function(f,a){var c=[];if(typeof f!="string"||!f||typeof a!="string"||!a){return c}var b=this._0P(f);var d=this.u34t(a);if(b.length==d.length){for(var e=0;e<b.length;e++){c.push(new MPoint(b[e][1],b[e][0],false,d[e]));c[e].initialize(this)}}return c};Maplet.prototype._0P=function(d){var f=d.length;var i=0;var m=[];var j=0;var e=0;while(i<f){var k;var c=0;var g=0;do{k=d.charCodeAt(i++)-63;g|=(k&31)<<c;c+=5}while(k>=32);var l=((g&1)?~(g>>1):(g>>1));j+=l;c=0;g=0;do{k=d.charCodeAt(i++)-63;g|=(k&31)<<c;c+=5}while(k>=32);var a=((g&1)?~(g>>1):(g>>1));e+=a;m.push([j*0.00001,e*0.00001])}return m};Maplet.prototype.u34t=function(d){var a=[];for(var c=0;c<d.length;++c){var b=d.charCodeAt(c)-63;a.push(b)}return a};var w$n={wB:function(a){this.fo=(a)?true:false},addLabel:function(c,e,a,f,g,b,d){if(!g){g=""}this.yG[this.yG.length]=new a8("label"+this.sv,c,c,parseFloat(e),parseFloat(a),f,g,b,d);this.sv++},addPoint:function(c,e,a,f,g,b,d){if(!g){g=""}this.aO[this.aO.length]=new a8("point"+this.sv,c,c,parseFloat(e),parseFloat(a),f,g,b,d);this.sv++},updatePointAt:function(e,c,d,b,a){if(e>=0&&this.aO.length>e){if(!d){d=""}this.aO[e].zM(c,d);if(typeof b!="undefined"){if(typeof a=="undefined"){a=b}this.aO[e].setIcon(b,a)}}},updateLineAt:function(d,b,c,a){if(d>=0&&this.aN.length>d){this.po=d;if(b!="undefined"&&b!=null){this.aN[d].cK=(a=="false"||a=="0")?false:true;this.aN[d].xP=b}if(c!="undefined"&&c!=null){this.aN[d].content=c}if(this.aN[d].cK){this.aN[d].zM(b,c)}}},showTipOf:function(b,a,c){if(c==null||c==false||c=="undefined"||c=="false"){if(b>=0&&this.aO.length>b){if(this.aO[b].pO){this.aO[b].pO.onmouseover();this.aO[b].pO.wR(a)}}}else{if(b>=0&&this.aN.length>b){this.aN[b].wN()}}}};function a8(id,xI,xJ,lf,li,xP,content,cK,vD){this.lf=lf;this.li=li;this.setIcon=function(xI,xJ){if(xI!="undefined"&&xI!=""){this.xI=xI;this.pO.src=xI;this.pO.up=xI}if(xJ!="undefined"&&xJ!=""){this.xJ=xJ;this.pO.n1=xJ}};this.zM=function(title,content){this.xP=title;this.content=content;if(this.id!="undefined"&&this.xP!="undefined"){pe[this.id]=this.xP;pa[this.id]=(this.content==null||this.content=="undefined")?getAscii("%u8BEA%u0AAC%uCEA7%uB050"):this.content}if(this.cK){if(typeof this.n2!="undefined"){var container=this.n2.parentNode;if(container!=null){container.removeChild(this.n2)}var left=parseInt(this.n2.style.left);var top=parseInt(this.n2.style.top);this.n2=gu(this.xP,this.color);this.n2.style.left=left+"px";this.n2.style.top=top+"px";if(container!=null){container.appendChild(this.n2)}}else{this.n2=gu(this.xP,this.color)}}};if(id!="undefined"&&xI!="undefined"){this.id=id;this.color=(vD==null||vD=="undefined")?"#FF0000":vD;this.cK=(cK=="1");this.AJ=0;this.AI=16;this.zM(xP,content);this.pO=new Image();this.pO.unselectable="on";this.pO.id=this.id;this.pO.fl=true;this.pO.cm=false;this.pO.x0=0;this.pO.As=0;this.pO.lI=0;this.pO.lK=0;this.pO.style.position="absolute";this.pO.onerror=function(){this.src=strImgsvrUrl+"images/marker.gif";this.onerror=null};this.pO.onload=function(){this.onerror=null;this.onload=null};this.setIcon(xI,xJ);this.pO.onmouseover=function(){var maplet=document["mapbar-maplet"];if(maplet.mapMode==mapMode.measure||maplet.mapMode==mapMode.ta||maplet.mapMode==mapMode.bookmark){this.style.cursor="default";return}this.style.cursor=(isIE)?"hand":"pointer";if(this.style.zIndex<_zIndex){_zIndex++}this.style.zIndex=_zIndex;if(this.n1!="undefined"&&this.n1!=""){this.src=this.n1}if(this.fl&&iToolTipStyle==0){var x=parseInt(this.style.left)+parseInt(this.width)/2;var y=parseInt(this.style.top)+parseInt(this.height)/2;setToolTipMenu(x,y,pe[this.id],pa[this.id])}};this.pO.onmouseout=function(){if(this.up!="undefined"&&this.up!=""){this.src=this.up}if(document["mapbar-maplet"].mapMode==mapMode.edit){this.uI()}};this.pO.onclick=function(){if(this.fl.toString()=="false"){return}var maplet=document["mapbar-maplet"];if(maplet.mapMode==mapMode.measure||maplet.mapMode==mapMode.ta||maplet.mapMode==mapMode.bookmark||maplet.mapMode==mapMode.ly||maplet.mapMode==mapMode.lz||maplet.mapMode==mapMode.np){return}if(maplet.mapMode==mapMode.l3){var pn=maplet.p8(maplet.aO,this.id);maplet.removePointAt(pn);maplet.refresh();if(callback){callback("&act=del&pid="+pn)}return}if(this.lI==0&&this.lK==0){this.wR()}};this.pO.onmousemove=function(_event){if(document["mapbar-maplet"].mapMode==mapMode.edit&&this.cm){var pageX=parseInt((isIE)?event.clientX:_event.clientX);var pageY=parseInt((isIE)?event.clientY:_event.clientY);this.lK+=(pageY-this.As);this.lI+=(pageX-this.x0);this.style.top=(parseInt(this.style.top)+(pageY-this.As))+"px";this.style.left=(parseInt(this.style.left)+(pageX-this.x0))+"px";this.x0=pageX;this.As=pageY}};this.pO.onmousedown=function(_event){var pageX=parseInt((isIE)?event.clientX:_event.clientX);var pageY=parseInt((isIE)?event.clientY:_event.clientY);this.cm=true;this.x0=pageX;this.As=pageY;this.lI=0;this.lK=0};this.pO.onmouseup=function(_event){if(document["mapbar-maplet"].mapMode==mapMode.edit){this.uI(_event)}};this.pO.uI=function(_event){if(this.cm&&(this.lI!=0||this.lK!=0)){this.cm=false;var maplet=document["mapbar-maplet"];var pt=maplet.getElementById(maplet.aO,this.id);if(pt!=null){pt.lf+=(maplet.toMapLatCoordinate(this.lI+maplet.width/2,this.lK+maplet.height/2)-maplet.centerLat);pt.li+=(maplet.toMapLonCoordinate(this.lI+maplet.width/2,this.lK+maplet.height/2)-maplet.centerLon);cq.lf=pt.lf;cq.li=pt.li;var fQ=cq.zn();var pn=maplet.p8(maplet.aO,this.id);maplet.refresh();if(callback){callback("&act=move&pid="+pn+"&latlon="+fQ)}}this.lI=0;this.lK=0}else{this.cm=false}};this.pO.wR=function(ct){var x=parseInt(this.style.left)+parseInt(this.width)/2;var y=parseInt(this.style.top)+parseInt(this.height)/2;var maplet=document["mapbar-maplet"];if((iToolTipStyle=="undefined"||iToolTipStyle==1)&&(pe[this.id]!=null)&&(pe[this.id].length>0)){avBubble.gl(pe[this.id],pa[this.id]);if(ct.toString()=="true"||((x>avBubble.xoffset)&&(x<(maplet.width-avBubble.width))&&(y>avBubble.height)&&(y<(maplet.height)))){maplet.contentInfo=getInfoWindowHtml(pe[this.id],x,y,pa[this.id]);maplet.mapContainer.div.appendChild(maplet.contentInfo)}else{maplet.contentInfo=getInfoWindowHtml(pe[this.id],maplet.width/2+2,avBubble.height+10,pa[this.id]);var vj=maplet.width/2-x;var vk=avBubble.height+10-y;maplet.panTo(vj,vk)}}else{if(iToolTipStyle==2){var pn=maplet.p8(maplet.aO,this.id);if(callback){callback("&act=click&pid="+pn)}}}}}this.lx=function(g){var maplet=document["mapbar-maplet"];var width=(this.pO!=null)?parseInt(this.pO.width):16;var height=(this.pO!=null)?parseInt(this.pO.height):16;var left=maplet.toMapXCoordinate(this.li,this.lf)-width/2;var top=maplet.toMapYCoordinate(this.lf,this.li)-height;if(this.xP&&this.cK){g.setColor(this.color);g.lC(this.xP,maplet.toMapXCoordinate(this.li,this.lf)+width/2,maplet.toMapYCoordinate(this.lf,this.li)-12)}if(this.xI){g.lB(this.xI,left,top,width,height)}};this.paint=function(container){if(this.xI){var maplet=document["mapbar-maplet"];var width=(this.pO!=null)?parseInt(this.pO.width):16;var height=(this.pO!=null)?parseInt(this.pO.height):16;var left=maplet.toMapXCoordinate(this.li,this.lf)-width/2;var top=maplet.toMapYCoordinate(this.lf,this.li)-height;if(left.toString()==eval("Number.NaN.toString()")||top.toString()==eval("Number.NaN.toString()")){return}this.pO.style.top=top+"px";this.pO.style.left=left+"px";if(top>=0&&left>=0&&top<=maplet.height&&left<=maplet.width){if(this.pO.parentNode!=container){container.appendChild(this.pO)}this.pO.style.visibility="visible"}else{this.pO.style.visibility="hidden";if(this.pO.parentNode==container){container.removeChild(this.pO)}}}};this.u9=function(container){if(this.xP&&this.cK){var maplet=document["mapbar-maplet"];var width=(this.pO!=null)?parseInt(this.pO.width):16;var height=(this.pO!=null)?parseInt(this.pO.height):16;var left=maplet.toMapXCoordinate(this.li,this.lf)-width/2;var top=maplet.toMapYCoordinate(this.lf,this.li)-height;if(left.toString()==eval("Number.NaN.toString()")||top.toString()==eval("Number.NaN.toString()")){return}if(top>=0&&left>=0&&top<=maplet.height&&left<=maplet.width){this.n2.style.left=(left+width)+"px";this.n2.style.top=top+"px";if(this.n2.parentNode!=container){container.appendChild(this.n2)}}}};this.label=function(){if(this.content){}};this.pu={};this.Decrypt=function(li){return this.pu[li]||function(pu,xT){var pk=-1;var fE=0;var ub="";var fH="";if(xT!=null&&parseInt(xT.charAt(0),36)>=33){fH=xT.charAt(0);xT=xT.substring(1)}for(var i=0;i<(xT.length-(c75?1:0));i++){var n8=parseInt(xT.charAt(i),36)-10;if(n8>=17){n8=n8-7}ub+=(n8).toString(36);if(n8>fE){pk=i;fE=n8}}var n9=parseInt(ub.substring(0,pk),16);var n0=parseInt(ub.substring(pk+1),16);if("X"==fH){n9=-n9}if("Y"==fH){n0=-n0}var v6=new Array();v6[0]=(n9+n0-parseInt(strLicenseKey))/2;v6[1]=(n0-v6[0])/100000;v6[0]/=100000;if(v6[0]>180){v6[0]-=360}pu[xT]=v6;return v6}(this.pu,li)};this.zn=function(li,lf){if(typeof li!="undefined"&&typeof lf!="undefined"){this.lf=parseFloat(lf);this.li=parseFloat(li)}var v6="";var uh=parseInt(parseFloat(Math.max(-90,Math.min(90,this.lf)))*100000);var uj=parseInt(parseFloat((this.li<0)?(this.li+360):this.li)*100000);var pl=uj-uh+parseInt(strLicenseKey);var pm=uj+uh;if(pl<0){v6="X";pl=-pl}if(pm<0){v6="Y";pm=-pm}var ph=(pl).toString(16);var pi=(pm).toString(16);for(var i=0;i<ph.length;i++){var qv=parseInt(ph.charAt(i),16);v6+=(((qv>=10)?(qv+7):qv)+10).toString(36)}v6+="z";for(var j=0;j<pi.length;j++){var Jo41=parseInt(pi.charAt(j),16);v6+=(((Jo41>=10)?(Jo41+7):Jo41)+10).toString(36)}if(c75){v6+=v6.charAt(c75)}return v6.toUpperCase()}}function a9(id,aK,aM,xt,qq,qr,cr){this.aK=(aK==null)?new Array():aK;this.aM=(aM==null)?new Array():aM;this.color=(xt==null)?"#FF0000":xt;this.stroke=(qq==0)?1:qq;this.style=qr;this.id=id;this.cr=(cr=="undefined"||cr==null)?"false":cr;this.xP="";this.cK=false;this.content="";this.maplet=null;this.Decrypt=function(xT){var aU=xT.split(",");var qI=0;for(var i=0;i<aU.length;i++){if(aU[i]!=null&&aU[i].length>0){var pt=cq.Decrypt(aU[i]);this.aM[qI]=parseFloat(pt[0]);this.aK[qI]=parseFloat(pt[1]);qI++}}};this.zn=function(){var xU=(this.cr.toString()=="true"||this.cr=="true")?"2":"0";var xT=this.stroke+","+xU+","+this.color+":";for(var i=0;i<this.aK.length;i++){cq.lf=parseFloat(this.aK[i]);cq.li=parseFloat(this.aM[i]);xT+=cq.zn()+","}return xT};this.zM=function(title,content){this.xP=title;this.content=content;if(this.cK){if(typeof this.n2!="undefined"){var container=this.n2.parentNode;if(container!=null){container.removeChild(this.n2)}var left=parseInt(this.n2.style.left);var top=parseInt(this.n2.style.top);this.n2=gu(this.xP,this.color);this.n2.style.left=left+"px";this.n2.style.top=top+"px";if(container!=null){container.appendChild(this.n2)}}else{this.n2=gu(this.xP,this.color)}}};this.lx=function(g){var aP=new Array();var aR=new Array();var pg=0;var us=10;for(var i=0;i<this.aK.length;i++){if(this.aK[i].toString()!=eval("Number.NaN.toString()")){aR[pg]=this.maplet.toMapYCoordinate(this.aK[i],this.aM[i]);if(this.aM[i].toString()!=eval("Number.NaN.toString()")){aP[pg]=this.maplet.toMapXCoordinate(this.aM[i],this.aK[i]);if(pg>0&&(Math.abs(aP[pg]-aP[pg-1])+Math.abs(aR[pg]-aR[pg-1]))>us){pg++}}}if(pg==0){pg++}}if(this.color){g.setColor(this.color)}if(this.stroke){g.setStroke(this.stroke)}g.drawPolyline(aP,aR,this.style);g.paint()};this.paint=function(container){this.vcanvas=document.createElement("div");this.vcanvas.maplet=this.maplet;this.vcanvas.id=this.id;this.vcanvas.unselectable="on";this.vcanvas.style.zIndex=10;this.vcanvas.style.position="absolute";this.z0=document.createElement("v:polyline");this.z0.unselectable="on";this.z0.id=this.id;this.z0.strokecolor=this.color;this.z0.strokeweight=this.stroke+"pt";this.z0.fill=false;this.z0.filled=this.cr;this.z0.style.position="absolute";this.vstroke=document.createElement("v:stroke");this.vstroke.opacity=(transparencyLevel/100);this.vstroke.joinstyle="round";this.vstroke.endcap="round";this.vstroke.fill="false";if(bArrow){this.vstroke.endarrow="classic"}this.vfill=document.createElement("v:fill");this.vfill.opacity=((transparencyLevel/2)/100);this.vfill.color=this.color;this.z0.appendChild(this.vstroke);this.z0.appendChild(this.vfill);this.vcanvas.appendChild(this.z0);this.update();if(this.xP&&this.cK&&this.aK.length>=2){var Ao=0;var Au=0;for(var i=1;i<this.aK.length;i++){if(this.aK[i].toString()!=eval("Number.NaN.toString()")){Au=this.maplet.toMapYCoordinate(this.aK[i],this.aM[i])}if(this.aM[i].toString()!=eval("Number.NaN.toString()")){Ao=this.maplet.toMapXCoordinate(this.aM[i],this.aK[i])}if(Ao>=0&&Au>=0&&Au<=this.maplet.height&&Ao<=this.maplet.width){this.n2.style.left=Ao+"px";this.n2.style.top=Au+"px";if(this.n2.parentNode!=this.vcanvas){this.vcanvas.appendChild(this.n2)}break}}}this.vcanvas.style.visibility="visible";if(container!=null){container.appendChild(this.vcanvas)}this.vcanvas.onmouseover=function(_event){if(this.maplet.mapMode==mapMode.measure||this.maplet.mapMode==mapMode.ta||this.maplet.mapMode==mapMode.bookmark){this.style.cursor="default"}else{this.style.cursor=(isIE)?"hand":"pointer"}};this.vcanvas.onclick=function(_event){var pn=this.maplet.p8(this.maplet.aN,this.id);var pageX;var pageY;if(pn>=0){if(this.maplet.mapMode==mapMode.l3){var gF=this.maplet.aN[pn];var fc=true;var pg=0;if(gF.aK.length>2){fc=false;pageX=parseInt((isIE)?event.clientX:_event.clientX)-this.maplet.left-this.maplet.offsetX;pageY=parseInt((isIE)?event.clientY:_event.clientY)-this.maplet.top-this.maplet.offsetY;var qM=0;var qL=0;var gH=0;var gG=0;for(var i=gF.aK.length-1;i>0;i--){if(gF.aK[i].toString()!=eval("Number.NaN.toString()")){gH=this.maplet.toMapYCoordinate(gF.aK[i],gF.aM[i]);if(gF.aM[i].toString()!=eval("Number.NaN.toString()")){gG=this.maplet.toMapXCoordinate(gF.aM[i],gF.aK[i]);if(pg>0){var lK=gH-qM;var lI=gG-qL;if(Math.abs(lI)>Math.abs(lK)){var Ax=lK/lI*(pageX-qL)+qM;if(Math.abs(Ax-pageY)<16){if(i==0){fc=true}break}}else{if(Math.abs(lK)>0){var Ar=lI/lK*(pageY-qM)+qL;if(Math.abs(Ar-pageX)<16){if(i==0){fc=true}break}}}}qL=gG;qM=gH;pg++}}}}if(fc||(gF.aK.length-pg)<2){this.onclick=null;this.maplet.removeLineAt(pn);this.maplet.refresh();if(callback){callback("&act=del&lid="+pn)}}else{for(var j=0;j<pg;j++){gF.aK[gF.aK.length-j-1]=null;gF.aM[gF.aM.length-j-1]=null}gF.aK.length=gF.aK.length-pg;gF.aM.length=gF.aM.length-pg;this.maplet.refresh();if(callback){callback("&act=update&lid="+pn+"&pline="+gF.zn())}}}else{if(this.maplet.mapMode==mapMode.pan||this.maplet.mapMode==mapMode.edit){if(iToolTipStyle==2){if(callback){callback("&act=click&lid="+pn)}}else{if(this.maplet.aN[pn].xP!=null&&this.maplet.aN[pn].xP.length>0){pageX=parseInt((isIE)?event.clientX:_event.clientX)-this.maplet.left-this.maplet.offsetX;pageY=parseInt((isIE)?event.clientY:_event.clientY)-this.maplet.top-this.maplet.offsetY+8;this.maplet.wN(pageX,pageY,this.maplet.aN[pn].xP,this.maplet.aN[pn].content)}}}else{this.maplet.onClick(_event)}}}}};this.update=function(){var aP=new Array();var aR=new Array();var pg=0;var us=10;if(this.aK==null||this.aK.length<2){return}var cY=false;var tn=this.maplet.width;var to=this.maplet.height;for(var i=0;i<this.aK.length;i+=1){if(this.aK[i].toString()!=eval("Number.NaN.toString()")){aR[pg]=this.maplet.toMapYCoordinate(this.aK[i],this.aM[i]);if(this.aM[i].toString()!=eval("Number.NaN.toString()")){aP[pg]=this.maplet.toMapXCoordinate(this.aM[i],this.aK[i]);if(tn>aP[pg]){tn=aP[pg]}if(to>aR[pg]){to=aR[pg]}if(!cY&&(aR[pg]<0||aR[pg]>this.maplet.height||aP[pg]<0||aP[pg]>this.maplet.width)){cY=true}if(pg>0&&(Math.abs(aP[pg]-aP[pg-1])+Math.abs(aR[pg]-aR[pg-1]))>us){pg++}if(pg==0){pg++}}}}if(cY){var aQ=new Array();var aS=new Array();pg=0;for(var j=1;j<aP.length;j++){if((aR[j]<-this.maplet.height&&aR[j-1]<-this.maplet.height)||(aR[j]>this.maplet.height*2&&aR[j-1]>this.maplet.height*2)||(aP[j]>this.maplet.width*2&&aP[j-1]>this.maplet.width*2)||(aP[j]<-this.maplet.width&&aP[j-1]<-this.maplet.width)){continue}if(aQ.length==0||(aQ[pg]!=aP[j-1]&&aS[pg]!=aR[j-1])){aQ[pg]=aP[j-1];aS[pg]=aR[j-1];pg++}aQ[pg]=aP[j];aS[pg]=aR[j];pg++}aP=aQ;aR=aS;aQ=null;aS=null}var pathdata="";for(var qI=0;qI<aP.length;qI++){if(qI>0){pathdata+=","}pathdata+=(parseInt(aP[qI])+","+parseInt(aR[qI]))}if(bmc){this.z0.style.left=parseInt(tn)+"px";this.z0.style.top=parseInt(to)+"px"}if(this.z0){if(this.z0.points){this.z0.points.value=pathdata}else{this.z0.points=pathdata}}};this.wN=function(){var pn=this.maplet.p8(this.maplet.aN,this.id);if(this.maplet.aN[pn].xP!=null&&this.maplet.aN[pn].xP.length>0&&this.aK.length>=2){var Ao=0;var Au=0;for(var i=1;i<this.aK.length;i++){if(this.aK[i].toString()!=eval("Number.NaN.toString()")){Au=this.maplet.toMapYCoordinate(this.aK[i],this.aM[i])}if(this.aM[i].toString()!=eval("Number.NaN.toString()")){Ao=this.maplet.toMapXCoordinate(this.aM[i],this.aK[i])}if(Ao>=0&&Au>=0&&Au<=this.maplet.height&&Ao<=this.maplet.width){this.maplet.wN(Ao,Au+8,this.maplet.aN[pn].xP,this.maplet.aN[pn].content);break}}}}}Maplet.prototype.onClick=function(k){if(maplet.snapshotBox.yG6){maplet.snapshotBox.yG6=false;return}if(this.stdContextMenu){this.stdContextMenu.hide()}var f=(isIE)?event.srcElement.id:k.target.id;var C=(isIE)?event.srcElement:k.target;var d=parseInt((isIE)?event.clientX:k.clientX)-this.offsetX;var a=parseInt((isIE)?event.clientY:k.clientY)-this.offsetY;this.targetId=f;this.fS=d-this.left;this.fT=a-this.top;if(this.targetId!=null&&this.targetId.indexOf("ctrl")>=0){return false}if(this.ff&&this.nI().isInside(this.fS,this.fT)){this.AP.tC(this.fS,this.fT);return}if(this.isInsideMap()){var B=this.toMapLonCoordinate(this.fS,this.fT);var e=this.toMapLatCoordinate(this.fS,this.fT);if(this.downX==this.endX&&this.downY==this.endY){var m=cq.zn(this.toMapLonCoordinate(this.fS,this.fT),this.toMapLatCoordinate(this.fS,this.fT));if(apiType==1){var q=new MPoint(m);q.initialize(this);MEvent.trigger(this,"click",k,q)}else{MEvent.trigger(this,"click",k,m)}}var z=false;if((this.mapMode==7)){this.addOrigin(e,B)}else{if((this.mapMode==8)){this.addDestination(e,B)}else{if((this.mapMode==6)){cq.lf=e;cq.li=B;var E=cq.zn();removeMouseTipBox();if(apiType==1){MEvent.trigger(this,"bookmark",{action:"add",point:new MPoint(E),zoom:this.zoomLevel})}else{MEvent.trigger(this,"bookmark","&act=add&latlon="+E+"&zm="+this.zoomLevel)}}else{if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){if((new Date().getTime()-this.mouseclickTime)>=500){this.mouseclickTime=new Date().getTime();if(this.cQ){this.cQ=false}else{var A=false;var t=(this.targetId=="LayerMask"||this.targetId=="LayerDrawMap"||this.targetId=="LayerDrawSVG"||(C.parentNode&&C.parentNode.id=="LayerMap")||(C.id&&C.id.indexOf("OverlayBg")>=0)||(C.getAttribute&&C.getAttribute($$0)));if(!this.cn&&t){if(this.Q0v){return}if(iToolTipStyle==0){hideToolTipMenu()}A=true}if(t&&!this.isMoved&&this.layerContainer){var F=null;if(F=this.getImgByXY(this.curX,this.curY,true)){var n=false;for(var u=this.W_7.length-1;u>=0;u--){if(typeof this.W_7[u]!="undefined"){for(var l=this.W_7[u].length-1;l>=0;l--){if(!this.W_7[u][l].inZoomRange(this.zoomLevel)){continue}var o=this.W_7[u][l].click(F,this.curX,this.curY);A=o.PW4t;if(o.data){if(o.VpKa&&MEvent.contains(this,"layer_click")>0){MEvent.trigger(this,"layer_click",{layer:this.W_7[u][l],pid:o.data.p,area:o.data.l,data:o.data.d,name:o.data.n,rect:o.data.vroundrect});A=false}n=true;break}}}if(n){break}}}}if(this.clickToCenter&&A){if(this.contentInfo!=null){this.hideBubble()}this.waitPan(this.width/2-this.fS,-this.fT+this.height/2)}}this.cn=false}else{this.mouseclickTime=new Date().getTime()}}else{if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){if(this.allowDrawingDragMap&&!this.XHl){this.XHl=true;return false}if(this.targetId!=null&&this.targetId.indexOf("ctrl")>=0){return false}if(!this.zy){var j=this.mapMode==mapMode.ly||this.mapMode==mapMode.ta;var p=new MBrush(this.brush.color,this.brush.stroke,this.brush.style,j,this.brush.bgcolor,this.brush.transparency,this.brush.bgtransparency,this.brush.arrow);var v=new MPoint(cq.zn(B,e));this.zy=new MPolyline([v],p,null,null);this.zy.initialize(this);this.sv++;this.tG=new MPolyline([v,v],p,null,null);this.tG.initialize(this);this.sv++}else{var c=new MPoint(cq.zn(B,e));this.zy.pts.push(c);this.zy.update();this.tG.pts[0]=this.tG.pts[1];this.tG.pts[1]=c;this.tG.update()}z=true}}}}}if(f=="LayerDrawMap"&&!z){if(this.aG!=null&&this.aH!=null){for(var g=0;g<this.aG.length;g++){if(Math.abs(this.aG[g]-this.fS)<8&&Math.abs(this.aH[g]-this.fT)<8){var D="";if(apiType==1){D=this.aE[this.aF[g]].xP}else{D="&hotspot="+this.aE[this.aF[g]].xP}this.vi=0;MEvent.trigger(this,"hotspot",D);if(hs){this.setCenter(this.aE[this.aF[g]].lf,this.aE[this.aF[g]].li);this.setZoomLevel(8)}break}}}}}};Maplet.prototype.onDblclick=function(_event){var targetId=(isIE)?event.srcElement.id:_event.target.id;var target=(isIE)?event.srcElement:_event.target;this.targetId=targetId;removeMouseTipBox();if(this.targetId!=null&&this.targetId.toString().indexOf("ctrl")>=0){return false}if(this.isInsideMap()){if(this.mapMode!=mapMode.zoomin&&this.mapMode!=mapMode.zoomout&&this.mapMode!=mapMode.snapshot){this.setDomCursorStyle("default",this.map)}var LF8_f=cq.zn(this.toMapLonCoordinate(this.fS,this.fT),this.toMapLatCoordinate(this.fS,this.fT));if(apiType==1){var pt=new MPoint(LF8_f);pt.initialize(this);MEvent.trigger(this,"dbclick",_event,pt)}else{MEvent.trigger(this,"dbclick",_event,LF8_f)}if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta){var g0=0;var area=0;if(this.zy){var ur=this.zy.pts.length;if(!isIE){ur=ur-1}if(this.mapMode==mapMode.measure){g0=this.measDistance(this.zy.pts)}else{this.zy.pts[ur]=this.zy.pts[0];area=this.measArea(this.zy.pts)}if(this.zy.vcanvas.parentNode==this.layerDrawMap.div){this.zy.remove(true)}}if(this.tG&&this.tG.vcanvas.parentNode==this.layerDrawMap.div){this.tG.remove(true)}this.zy=null;this.tG=null;if(!isIE){this.refresh()}if(g0.toString()==eval("Number.NaN.toString()")){g0=0}if(area.toString()==eval("Number.NaN.toString()")){area=0}if(this.mapMode==mapMode.ta){var xk="";if(area>1000000){area=parseInt(area/10000)/10/10;xk=(en==0)?getAscii("%u603E%uF79D%u1151")+":"+area+getAscii("%u5E77%uC42C%uB725%uE338"):"Total area:"+area+"km2"}else{xk=(en==0)?getAscii("%u603E%uF79D%u1151")+":"+area+getAscii("%u5E76%uC42C%uE22C"):"Total area:"+area+"m2"}if(this.vA!="undefined"){this.setMode(this.vA)}setMyAlert(this.width/2+this.left+this.offsetX,this.height/2+this.top+this.offsetY,xk);if(apiType==1){MEvent.trigger(this,"measarea",(parseInt(area*1000000)/10))}else{MEvent.trigger(this,"measarea","&act=measarea&area="+(parseInt(area*1000000)/10)+getAscii("%u5E77%uC42C%uB725%uE338"))}}else{var xB="";if(g0>=1000){g0=parseInt(g0/100)/10;xB=(en==0)?getAscii("%u603E%uEE18%u0798")+":"+g0+getAscii("%u516E%uE338"):"Total distance:"+g0+"km"}else{xB=(en==0)?getAscii("%u603E%uEE18%u0798")+":"+g0+getAscii("%u7C74"):"Total distance:"+g0+"m"}if(this.vA!="undefined"){this.setMode(this.vA)}setMyAlert(this.width/2+this.left+this.offsetX,this.height/2+this.top+this.offsetY,xB);if(apiType==1){MEvent.trigger(this,"measure",(parseInt(g0*1000)/10))}else{MEvent.trigger(this,"measure","&act=measure&dist="+(parseInt(g0*1000)/10)+getAscii("%u516E%uE338"))}}}else{if(this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){var yg=null;if(this.zy){var wi0OR=this.zy.pts.length;if(!isIE){wi0OR=wi0OR-1}this.zy.pts.length=wi0OR;if(this.zy.vcanvas.parentNode==this.layerDrawMap.div){this.zy.remove(true)}if(apiType==1){yg=this.zy.zn();yg.zoom=this.zoomLevel}else{yg=("&act=add&pline="+this.zy.zn()+"&zm="+this.zoomLevel)}}if(this.tG&&this.tG.vcanvas.parentNode==this.layerDrawMap.div){this.tG.remove(true)}this.zy=null;this.tG=null;if(!isIE){this.refresh()}var nb=(this.mapMode==mapMode.lz)?"drawline":"drawarea";if(this.vA!="undefined"){this.setMode(this.vA)}MEvent.trigger(this,nb,yg)}else{if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){if(this.targetId&&(this.targetId=="LayerMask"||this.targetId=="LayerDrawMap"||this.targetId=="LayerDrawSVG"||target.parentNode.id=="LayerMap"||target.id.indexOf("OverlayBg")>=0||this.targetId.substring(0,"mk_shadow_".length)=="mk_shadow_"||target.getAttribute("traffic")=="yes")||(target.getAttribute($$0))){this.vi=0;if(this.getZoomLevel()<maxZoomLevel){this.zoomTo(this.getZoomLevel()+1,void (0),this.width/2-this.fS,-this.fT+this.height/2)}else{if(this.getZoomLevel()==maxZoomLevel){this.panTo(this.width/2-this.fS,-this.fT+this.height/2)}}}}}}}};Maplet.prototype.onMousedown=function(_event){if(this.mapMode!=mapMode.pan){this.hideBubble()}if(this.markerDragAnimation){this.setDragCross(false)}var pageX=parseInt((isIE)?event.clientX:_event.clientX)-this.offsetX;var pageY=parseInt((isIE)?event.clientY:_event.clientY)-this.offsetY;this.targetId=(isIE)?event.srcElement.id:_event.target.id;if(!isIE&&this.panel.style.position!="absolute"){}this.downX=pageX-this.left;this.downY=pageY-this.top;this.mousedownTime=new Date().getTime();this.sumMoveX=this.sumMoveY=0;this.isMoved=false;if(this.targetId!=null&&this.targetId.indexOf("ctrl")>=0&&this.controlCanvas!=null){this.controlCanvas.onmousedown(_event);return}if(_event.type=="mousedown"){MEvent.trigger(this,"mousedown",_event)}this.tQ="";if(this.ff&&this.nI().isInside(this.downX,this.downY)){this.AP.tE(this.downX,this.downY);return false}else{var target=isIE?event.srcElement:_event.target;this.drag=(target.getAttribute(_dragmap)||target.getAttribute("traffic"))?true:false;if(this.isInsideMap()&&this.cS){if(this.mapMode==mapMode.snapshot&&!this.snapshotBox.pD7tE){this.snapshotBox.show();this.snapshotBox.pD7tE=true}else{this.layerBorder.resize(1,1);this.layerBorder.show()}}else{if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){if(isIE&&(this.targetId.indexOf("MPolyline")==this.targetId.length-9)){this.setDomCursorStyle("move",event.srcElement)}else{eval(document.body.scrollTop);this.setDomCursorStyle("move",this.map)}}}}};Maplet.prototype.setMapOffsetXY=function(a){var b=getMapLeftTop(this.map);this.offsetX=b[0]-getScrollLeft()-this.left;this.offsetY=b[1]-getScrollTop()-this.top};Maplet.prototype.onMouseout=function(a){MEvent.trigger(this,"mouseout",a);this.targetId=(isIE)?event.srcElement.id:a.target.id;if(!isIE||(isIE&&event.clientX!=-1)){var c=parseInt((isIE)?event.clientX:a.clientX)-this.offsetX;var b=parseInt((isIE)?event.clientY:a.clientY)-this.offsetY;if(this.drag){this.setSumMove(c-this.left-(isIE?1:0)-this.curX,b-this.top-(isIE?1:0)-this.curY)}this.curX=c-this.left-(isIE?1:0);this.curY=b-this.top-(isIE?1:0);this.deltaX=this.curX-this.downX;this.deltaY=this.curY-this.downY}this.cI=false;if((isIE&&event.clientX==-1)||!this.isInsideMap()){if(this.controlCanvas!=null){this.controlCanvas.onmouseout(a)}this.onMouseup((isIE)?event:a)}if(isIE){document.onmousewheel=new Function("return true")}};Maplet.prototype.onMousemove=function(g){if(this.drag&&this.stdContextMenu){this.stdContextMenu.hide()}this.cI=true;if(!this.drag){this.setMapOffsetXY(g)}this.targetId=(isIE)?event.srcElement.id:g.target.id;var l=parseInt((isIE)?event.clientX:g.clientX)-this.offsetX;var k=parseInt((isIE)?event.clientY:g.clientY)-this.offsetY;if(this.drag){this.setSumMove((l)-this.left-this.curX,(k)-this.top-this.curY)}this.curX=(l)-this.left;this.curY=(k)-this.top;if(this.controlCanvas!=null){if(this.controlCanvas.onmousemove(g)){return}}if(this.gc!=null){for(var j in this.gc){if(this.gc[j].toString().indexOf("MStandardControl")>0&&this.gc[j].nR&&this.gc[j].nR.onmousemove(g)){return}}}if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){var e=(en)?"Double click to finish":getAscii("%u8BFC%uDFC3%uA5C7%uD0CE%uE632");if(this.mapMode==mapMode.measure){}showMouseTipBox(this.curX,this.curY,e,this.map)}else{if(this.mapMode==mapMode.bookmark){if(this.gJ!=null&&this.gJ!="undefined"&&this.gJ!="null"&&this.gJ!=""){showMouseTipBox(this.curX-this.gI.width/2-10-1,this.curY-this.gI.height-2-18,"<img src='"+this.gI.src+"'>",this.map)}else{removeMouseTipBox()}}else{removeMouseTipBox()}}if(this.ff&&this.nI().tF(this.targetId,this.curX,this.curY)){return}if(this.mapMode==mapMode.pan&&!this.cN){var p=false;if(this.aG!=null&&this.aH!=null){for(var a=0;a<this.aG.length;a++){if(Math.abs(this.aG[a]-this.curX)<8&&Math.abs(this.aH[a]-this.curY)<8){p=true;break}}}if(p){this.setDomCursorStyle("pointer",this.map)}else{if(!this.drag){this.setDomCursorStyle("default",this.map)}}if(this.layerContainer&&(this.targetId=="LayerMask"||this.targetId=="LayerDrawMap"||this.targetId=="LayerDrawSVG"||(g.target.parentNode&&g.target.parentNode.id=="LayerMap")||g.target.id.indexOf("OverlayBg")>=0||g.target.getAttribute($$0))){var n=null;if(n=this.getImgByXY(this.curX,this.curY,true)){var r=false;for(var m=this.W_7.length-1;m>=0;m--){if(typeof this.W_7[m]!="undefined"){for(var t=this.W_7[m].length-1;t>=0;t--){if(!this.W_7[m][t].inZoomRange(this.zoomLevel)){continue}var q=this.W_7[m][t].jct(n,this.curX,this.curY);if(q){if(MEvent.contains(this,"layer_mousemove")>0){MEvent.trigger(this,"layer_mousemove",{layer:this.qS[m],pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}r=true;break}}}if(r){break}}}}}if(this.cO&&this.drag){if(this.Q0v){return}if(!this.oA46){this.no();this.oA46=true}if(isIE){if(!document.getElementById("_map_marker_speeder")){var o=document.createElement("DIV");o.id="_map_marker_speeder";o.style.display="none";document.body.appendChild(o)}document.getElementById("_map_marker_speeder").innerHTML=""}if(iToolTipStyle==0){hideToolTipMenu()}if(iToolTipStyle==0){hideToolTipMenu()}this.deltaX=this.curX-this.downX;this.deltaY=this.curY-this.downY;if(!isIE&&ContentInfo&&ContentInfo.isVisible()){ContentInfo.setContentOverflow(true)}this.mapContainer.moveTo(this.deltaX,this.deltaY);this.cN=true;this.cn=true}else{if(this.cS&&this.drag){if(this.isInsideMap()){this.cR=true;this.lu()}}else{if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){var c=this.toMapLonCoordinate(this.curX,this.curY);var f=this.toMapLatCoordinate(this.curX,this.curY);if(this.zy!=null){this.tG.pts[1]=new MPoint(cq.zn(c,f));this.tG.update()}}else{if(this.targetId=="LayerDrawMap"&&iToolTipStyle==0){hideToolTipMenu()}}}}};Maplet.prototype.onMouseup=function(m,f,d,b){var q=0;var p=0;var n=0;var o=0;this.targetId=(isIE)?event.srcElement.id:m.target.id;this.endX=this.curX;this.endY=this.curY;this.mouseupTime=new Date().getTime();this.drag=false;if(this.targetId.indexOf("MPolyline")!=-1){this.cn=false}if(m.type=="mouseup"){if(this.sumMoveX<-this.ignoreMoveRange||this.sumMoveX>this.ignoreMoveRange||this.sumMoveY<-this.ignoreMoveRange||this.sumMoveY>this.ignoreMoveRange){this.isMoved=true}}else{this.isMoved=true}if(this.targetId!=null){if(this.targetId.indexOf("ctrl")>=0){this.layerBorder.hide()}else{if(m.type=="mouseup"){MEvent.trigger(this,"mouseup",m)}}}if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){this.setDomCursorStyle("default",this.map)}if(this.ff&&this.nI().tJ(this.endX,this.endY)){this.setZoomLevel(parseInt(this.AP.getZoomLevel()));return}if((this.cN||this.cR)&&(this.cS||this.cO)){this.cN=false;this.cR=false;if(this.cO){if(true||this.zoomLevel>0){q=-(this.endX-this.downX);p=(this.endY-this.downY);n=this.toMapLonCoordinate(q+this.width/2,-p+this.height/2);o=this.toMapLatCoordinate(q+this.width/2,-p+this.height/2);this.centerLon=n;this.centerLat=o}var t=(isIE)?event.srcElement:m.target;if(t.getAttribute(_dragmap)){if(t.getAttribute(_overlay)=="polyline"){this.H6$0=true}if(t.getAttribute(_overlay)=="marker"){this.y$pP_=true}}if(typeof basepoilist!="object"&&!this.J_883&&this.m0J){this.m0J=false}this.Or5V$=true;this.lastStamp=new Date().getTime();maplet.setZoomLevel(maplet.zoomLevel);this.Or5V$=false;if(apiType==1){MEvent.trigger(this,"pan",new MPoint(this.toMapCoordinate(this.width/2,this.height/2)))}else{MEvent.trigger(this,"pan","&act=pan&ctr="+this.toMapCoordinate(this.width/2,this.height/2))}if(this.allowDrawingDragMap&&this.isMoved&&((this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly))){this.XHl=false}}else{var i=1;var k=Math.max(1,Math.abs(this.endX-this.downX));if(this.mapMode==1){q=(this.endX+this.downX)/2;p=(this.endY+this.downY)/2;n=this.toMapLonCoordinate(q,p);o=this.toMapLatCoordinate(q,p);this.centerLon=n;this.centerLat=o;if(k<this.imgWidth){i=Math.min(maxZoomLevel-this.zoomLevel,Math.max(1,parseInt(Math.log(this.imgWidth/k)/Math.log(2))))}this.setZoomLevel(this.zoomLevel+i);if(apiType==1){MEvent.trigger(this,"zoomin",this.zoomLevel)}else{MEvent.trigger(this,"zoomin","&act=zoomin&zm="+this.zoomLevel)}}else{if(this.mapMode==2){q=(this.endX+this.downX)/2;p=(this.endY+this.downY)/2;n=this.toMapLonCoordinate(q,p);o=this.toMapLatCoordinate(q,p);this.centerLon=n;this.centerLat=o;if(k<this.imgWidth){i=Math.min(this.zoomLevel,Math.max(1,parseInt(Math.log(this.imgWidth/k)/Math.log(2))))}this.setZoomLevel(this.zoomLevel-i);if(apiType==1){MEvent.trigger(this,"zoomout",this.zoomLevel)}else{MEvent.trigger(this,"zoomout","&act=zoomout&zm="+this.zoomLevel)}}else{if(this.mapMode==mapMode.lookup){var v=this.centerLon+(Math.max(this.endX,this.downX)-this.width/2)*this.clipLonRange/this.imgWidth;var c=this.centerLat-(Math.min(this.endY,this.downY)-this.height/2)*this.clipLatRange/this.imgHeight;cq.li=v;cq.lf=c;var a=cq.zn();var g=this.centerLon+(Math.min(this.endX,this.downX)-this.width/2)*this.clipLonRange/this.imgWidth;var l=this.centerLat-(Math.max(this.endY,this.downY)-this.height/2)*this.clipLatRange/this.imgHeight;cq.li=g;cq.lf=l;var j=cq.zn();cq.li=g;cq.lf=c;var e=cq.zn();cq.li=v;cq.lf=l;var r=cq.zn();var u="&act=lookup&max="+a+"&min="+j+"&mmx="+e+"&mxm="+r;if(this.vA!="undefined"){this.setMode(this.vA)}this.cQ=true;if(apiType==1){MEvent.trigger(this,"lookup",{action:"lookup",max:new MPoint(a),min:new MPoint(j),mmx:new MPoint(e),mxm:new MPoint(r)})}else{MEvent.trigger(this,"lookup",u)}}else{if(this.mapMode==mapMode.snapshot){this.snapshotBox.B2$0();this.snapshotBox.pD7tE=false}}}}this.layerBorder.hide();this.layerBorder.resize(1,1);this.layerBorder.moveTo(-10,-10)}}};Maplet.prototype.onMousewheel=function(a){function e(){if(this.j5x47==null){this.j5x47=this.zoomLevel;e.apply(this)}else{if(this.j5x47!=this.Ai){var k=Math.abs(this.Ai-this.zoomLevel)/10;var m=0.25;k=k<m?m:k;if(this.tK<0){this.j5x47-=k;if(this.j5x47<=this.Ai+0.05){this.j5x47=this.Ai}}else{this.j5x47+=k;if(this.j5x47>=this.Ai-0.1){this.j5x47=this.Ai}}if(this.j5x47!=this.Ai){var l=Math.pow(2,this.j5x47)/Math.pow(2,this.zoomLevel);var j=(this.width/2-this.Cj9mE)*(l-1);var i=(this.height/2-this.dV55V)*(l-1);this.AN(this.j5x47,j,i)}if(this.j5x47==this.Ai){e.apply(this)}else{getTimeout(this,e,0)}}else{this.j5x47=null;this.tK=0;this.setZoomLevel(this.Ai);this.Ai=0}}}var c=a||window.event;if(typeof c=="object"&&c){if(typeof c.wheelDelta=="undefined"){c.wheelDelta=-c.detail}if(typeof c.srcElement=="undefined"){c.srcElement=c.target}if(c.wheelDelta==0||(this.zoomLevel==minZoomLevel&&c.wheelDelta<0)||(this.zoomLevel==maxZoomLevel&&c.wheelDelta>0)){return}if(this.doPaning){return}if(typeof this.tK=="undefined"){this.tK=0}if(typeof this.Ai=="undefined"){this.Ai=0}var d=K_ER(c.srcElement,disableMw);if(!d||d=="false"){stopEventBubble(c);var b=c.wheelDelta<0?-1:1;this.tK+=b<0?Math.floor(b):Math.ceil(b);if(this.tK==0){return}var g=true;if(ContentInfo&&ContentInfo.isVisible()){var f=this.toScreenCoordinate(avBubble._Tov1);if(_isInsideRect({x:f[0],y:f[1]},{min:{x:0,y:0},max:{x:this.width,y:this.height}})){g=false}}if(g){this.v8q8Y="wheel";if(typeof this.targetId=="undefined"){this.onMousemove(c)}this.Cj9mE=this.curX;this.dV55V=this.curY;this.U9B2=this.toMapCoordinate(this.Cj9mE,this.dV55V);this.Vye(c.wheelDelta)}this.Ai=parseInt(this.zoomLevel+this.tK);if(this.Ai<minZoomLevel){this.Ai=minZoomLevel}if(this.Ai>maxZoomLevel){this.Ai=maxZoomLevel}if(ZOOM_TRANSITION&&this.j5x47==null){if(ContentInfo&&ContentInfo.isVisible()){this.j5x47=this.Ai}e.apply(this)}}}};Maplet.prototype.onMousedown=function(_event){if(this.mapMode!=mapMode.pan){this.hideBubble()}if(this.markerDragAnimation){this.setDragCross(false)}var pageX=parseInt((isIE)?event.clientX:_event.clientX)-this.offsetX;var pageY=parseInt((isIE)?event.clientY:_event.clientY)-this.offsetY;this.targetId=(isIE)?event.srcElement.id:_event.target.id;if(!isIE&&this.panel.style.position!="absolute"){}this.downX=pageX-this.left;this.downY=pageY-this.top;this.mousedownTime=new Date().getTime();myAnim&&myAnim.stop();this.timer=this.mousedownTime;this.moved=false;this.sumMoveX=this.sumMoveY=0;this.isMoved=false;if(this.targetId!=null&&this.targetId.indexOf("ctrl")>=0&&this.controlCanvas!=null){this.controlCanvas.onmousedown(_event);return}if(_event.type=="mousedown"){MEvent.trigger(this,"mousedown",_event)}this.tQ="";if(this.ff&&this.nI().isInside(this.downX,this.downY)){this.AP.tE(this.downX,this.downY);return false}else{var target=isIE?event.srcElement:_event.target;this.drag=(target.getAttribute(_dragmap)||target.getAttribute("traffic"))?true:false;if(this.isInsideMap()&&this.cS){if(this.mapMode==mapMode.snapshot&&!this.snapshotBox.pD7tE){this.snapshotBox.show();this.snapshotBox.pD7tE=true}else{this.layerBorder.resize(1,1);this.layerBorder.show()}}else{if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){if(isIE&&(this.targetId.indexOf("MPolyline")==this.targetId.length-9)){this.setDomCursorStyle("move",event.srcElement)}else{eval(document.body.scrollTop);this.setDomCursorStyle("move",this.map)}}}}};Maplet.prototype.onMousemove=function(k){if(this.drag&&this.stdContextMenu){this.stdContextMenu.hide()}this.cI=true;if(!this.drag){this.setMapOffsetXY(k)}this.targetId=(isIE)?event.srcElement.id:k.target.id;var c=parseInt((isIE)?event.clientX:k.clientX)-this.offsetX;var a=parseInt((isIE)?event.clientY:k.clientY)-this.offsetY;var v=(c)-this.left-this.curX;var u=(a)-this.top-this.curY;if(this.drag){this.setSumMove(v,(a)-u)}this.curX=(c)-this.left;this.curY=(a)-this.top;if(this.controlCanvas!=null){if(this.controlCanvas.onmousemove(k)){return}}if(this.gc!=null){for(var g in this.gc){if(this.gc[g].toString().indexOf("MStandardControl")>0&&this.gc[g].nR&&this.gc[g].nR.onmousemove(k)){return}}}if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){var p=(en)?"Double click to finish":getAscii("%u8BFC%uDFC3%uA5C7%uD0CE%uE632");if(this.mapMode==mapMode.measure){}showMouseTipBox(this.curX,this.curY,p,this.map)}else{if(this.mapMode==mapMode.bookmark){if(this.gJ!=null&&this.gJ!="undefined"&&this.gJ!="null"&&this.gJ!=""){showMouseTipBox(this.curX-this.gI.width/2-10-1,this.curY-this.gI.height-2-18,"<img src='"+this.gI.src+"'>",this.map)}else{removeMouseTipBox()}}else{removeMouseTipBox()}}if(this.ff&&this.nI().tF(this.targetId,this.curX,this.curY)){return}if(this.mapMode==mapMode.pan&&!this.cN){var f=false;if(this.aG!=null&&this.aH!=null){for(var e=0;e<this.aG.length;e++){if(Math.abs(this.aG[e]-this.curX)<8&&Math.abs(this.aH[e]-this.curY)<8){f=true;break}}}if(f){this.setDomCursorStyle("pointer",this.map)}else{if(!this.drag){this.setDomCursorStyle("default",this.map)}}if(this.layerContainer&&(this.targetId=="LayerMask"||this.targetId=="LayerDrawMap"||this.targetId=="LayerDrawSVG"||(k.target.parentNode&&k.target.parentNode.id=="LayerMap")||k.target.id.indexOf("OverlayBg")>=0||k.target.getAttribute($$0))){var z=null;if(z=this.getImgByXY(this.curX,this.curY,true)){var t=false;for(var m=this.W_7.length-1;m>=0;m--){if(typeof this.W_7[m]!="undefined"){for(var l=this.W_7[m].length-1;l>=0;l--){if(!this.W_7[m][l].inZoomRange(this.zoomLevel)){continue}var q=this.W_7[m][l].jct(z,this.curX,this.curY);if(q){if(MEvent.contains(this,"layer_mousemove")>0){MEvent.trigger(this,"layer_mousemove",{layer:this.qS[m],pid:data.p,area:data.l,data:data.d,name:data.n,rect:data.vroundrect})}t=true;break}}}if(t){break}}}}}if(this.cO&&this.drag){if(this.Q0v){return}if(!this.oA46){this.no();this.oA46=true}if(isIE){if(!document.getElementById("_map_marker_speeder")){var j=document.createElement("DIV");j.id="_map_marker_speeder";j.style.display="none";document.body.appendChild(j)}document.getElementById("_map_marker_speeder").innerHTML=""}if(iToolTipStyle==0){hideToolTipMenu()}if(iToolTipStyle==0){hideToolTipMenu()}this.moved=true;this.deltaX=this.curX-this.downX;this.deltaY=this.curY-this.downY;if(!isIE&&ContentInfo&&ContentInfo.isVisible()){ContentInfo.setContentOverflow(true)}this.mapContainer.moveTo(this.deltaX,this.deltaY);var r=new Date().getTime();if(r!=null){this.disTime=r-this.timer;this.timer=r;this.disX=v;this.disY=u}this.cN=true;this.cn=true}else{if(this.cS&&this.drag){if(this.isInsideMap()){this.cR=true;this.lu()}}else{if(this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly){var n=this.toMapLonCoordinate(this.curX,this.curY);var o=this.toMapLatCoordinate(this.curX,this.curY);if(this.zy!=null){this.tG.pts[1]=new MPoint(cq.zn(n,o));this.tG.update()}}else{if(this.targetId=="LayerDrawMap"&&iToolTipStyle==0){hideToolTipMenu()}}}}};Maplet.prototype.onMouseup=function(n,f,d,b){var u=0;var r=0;var p=0;var q=0;this.targetId=(isIE)?event.srcElement.id:n.target.id;this.endX=this.curX;this.endY=this.curY;this.mouseupTime=new Date().getTime();if(this.drag===true){this.drag=false;var t=new Date().getTime();var o=t-this.timer;if(o>100){this.disX=0;this.disY=0}this.disTime=o<5?this.disTime:o;if(this.disTime==0&&(this.disX!=0||this.disY!=0)){this.disTime=1}if(this.disTime){var z=-(120/this.disTime)*this.disX;var v=-(120/this.disTime)*this.disY;z>this.width/2&&(z=this.width/2);z<-this.width/2&&(z=-this.width/2);v>this.height/2&&(v=this.height/2);v<-this.height/2&&(v=-this.height/2);var l=[z,v];if(this.moved){startSlideMove(l,this,0.6)}}this.disX=0;this.disY=0;this.disTime=0;this.timer=null}if(this.targetId.indexOf("MPolyline")!=-1){this.cn=false}if(n.type=="mouseup"){if(this.sumMoveX<-this.ignoreMoveRange||this.sumMoveX>this.ignoreMoveRange||this.sumMoveY<-this.ignoreMoveRange||this.sumMoveY>this.ignoreMoveRange){this.isMoved=true}}else{this.isMoved=true}if(this.targetId!=null){if(this.targetId.indexOf("ctrl")>=0){this.layerBorder.hide()}else{if(n.type=="mouseup"){MEvent.trigger(this,"mouseup",n)}}}if(this.mapMode==mapMode.pan||this.mapMode==mapMode.edit||this.mapMode==mapMode.l3){this.setDomCursorStyle("default",this.map)}if(this.ff&&this.nI().tJ(this.endX,this.endY)){this.setZoomLevel(parseInt(this.AP.getZoomLevel()));return}if((this.cN||this.cR)&&(this.cS||this.cO)){this.cN=false;this.cR=false;if(this.cO){if(true||this.zoomLevel>0){u=-(this.endX-this.downX);r=(this.endY-this.downY);p=this.toMapLonCoordinate(u+this.width/2,-r+this.height/2);q=this.toMapLatCoordinate(u+this.width/2,-r+this.height/2);this.centerLon=p;this.centerLat=q}var B=(isIE)?event.srcElement:n.target;if(B.getAttribute(_dragmap)){if(B.getAttribute(_overlay)=="polyline"){this.H6$0=true}if(B.getAttribute(_overlay)=="marker"){this.y$pP_=true}}if(typeof basepoilist!="object"&&!this.J_883&&this.m0J){this.m0J=false}this.Or5V$=true;this.lastStamp=new Date().getTime();maplet.setZoomLevel(maplet.zoomLevel);this.Or5V$=false;if(apiType==1){MEvent.trigger(this,"pan",new MPoint(this.toMapCoordinate(this.width/2,this.height/2)))}else{MEvent.trigger(this,"pan","&act=pan&ctr="+this.toMapCoordinate(this.width/2,this.height/2))}if(this.allowDrawingDragMap&&this.isMoved&&((this.mapMode==mapMode.measure||this.mapMode==mapMode.ta||this.mapMode==mapMode.lz||this.mapMode==mapMode.ly))){this.XHl=false}}else{var i=1;var k=Math.max(1,Math.abs(this.endX-this.downX));if(this.mapMode==1){u=(this.endX+this.downX)/2;r=(this.endY+this.downY)/2;p=this.toMapLonCoordinate(u,r);q=this.toMapLatCoordinate(u,r);this.centerLon=p;this.centerLat=q;if(k<this.imgWidth){i=Math.min(maxZoomLevel-this.zoomLevel,Math.max(1,parseInt(Math.log(this.imgWidth/k)/Math.log(2))))}this.setZoomLevel(this.zoomLevel+i);if(apiType==1){MEvent.trigger(this,"zoomin",this.zoomLevel)}else{MEvent.trigger(this,"zoomin","&act=zoomin&zm="+this.zoomLevel)}}else{if(this.mapMode==2){u=(this.endX+this.downX)/2;r=(this.endY+this.downY)/2;p=this.toMapLonCoordinate(u,r);q=this.toMapLatCoordinate(u,r);this.centerLon=p;this.centerLat=q;if(k<this.imgWidth){i=Math.min(this.zoomLevel,Math.max(1,parseInt(Math.log(this.imgWidth/k)/Math.log(2))))}this.setZoomLevel(this.zoomLevel-i);if(apiType==1){MEvent.trigger(this,"zoomout",this.zoomLevel)}else{MEvent.trigger(this,"zoomout","&act=zoomout&zm="+this.zoomLevel)}}else{if(this.mapMode==mapMode.lookup){var D=this.centerLon+(Math.max(this.endX,this.downX)-this.width/2)*this.clipLonRange/this.imgWidth;var c=this.centerLat-(Math.min(this.endY,this.downY)-this.height/2)*this.clipLatRange/this.imgHeight;cq.li=D;cq.lf=c;var a=cq.zn();var g=this.centerLon+(Math.min(this.endX,this.downX)-this.width/2)*this.clipLonRange/this.imgWidth;var m=this.centerLat-(Math.max(this.endY,this.downY)-this.height/2)*this.clipLatRange/this.imgHeight;cq.li=g;cq.lf=m;var j=cq.zn();cq.li=g;cq.lf=c;var e=cq.zn();cq.li=D;cq.lf=m;var A=cq.zn();var C="&act=lookup&max="+a+"&min="+j+"&mmx="+e+"&mxm="+A;if(this.vA!="undefined"){this.setMode(this.vA)}this.cQ=true;if(apiType==1){MEvent.trigger(this,"lookup",{action:"lookup",max:new MPoint(a),min:new MPoint(j),mmx:new MPoint(e),mxm:new MPoint(A)})}else{MEvent.trigger(this,"lookup",C)}}else{if(this.mapMode==mapMode.snapshot){this.snapshotBox.B2$0();this.snapshotBox.pD7tE=false}}}}this.layerBorder.hide();this.layerBorder.resize(1,1);this.layerBorder.moveTo(-10,-10)}}};var changedStr="_changed";function getAccessors(a){return a.accessors_||(a.accessors_={})}function getBindings(a){return a.bindings_||(a.bindings_={})}function triggerChanged(a,b){var c=b+changedStr;a[c]?a[c]():a.changed(b)}easeOutCubic=function(e,a,g,f){return g*(Math.pow(e/f-1,3)+1)+a};function qAnimationExec(a){return function(){var b=a.get("current");var d=a.get("duration");var c=a.get("fps");b>d&&(b=d);a.frame(b);if(b>=d){a.stop();return}a.set("current",b+1/c)}}function animEffect(a){this.initialize(a)}animEffect.prototype={initialize:function(a){a=a||{};a.duration=a.duration||0;a.fps=a.fps||40;this.setValues(a)},prepare:function(){},start:function(a){this.prepare();this.stop(true);var b=this.get("fps");this.set("current",1/b);this.set("status",1);this.timer_=window.setInterval(qAnimationExec(this),1000/b)},stop:function(a){this.timer_&&window.clearInterval(this.timer_);this.timer_=null;!a&&MEvent.trigger(this,"end");this.set("status",0);this.set("current",-1)},getStatus:function(){return this.get("status")},frame:function(d){var o=this.get("begins");var k=this.get("ends");var a=this.get("method");var e=this.get("duration");var n=[];var j=[];for(var f=0,g=o.length;f<g;++f){var m=k[f]-o[f],l,c;if(e!=0){l=a(d,o[f],m,e);var b=d-1/this.get("fps");b<0&&(b=0);c=l-a(b,o[f],m,e)}else{l=k[f];c=m}n.push(parseInt(l,10));j.push(parseInt(c,10))}this.qFxFrame(n,j)},qFxFrame:function(b,a){var c=this.get("callback");if(c){c(b,a)}},get:function(c){var b=getAccessors(this)[c];if(b){var e=b.target;var a=b.key;var d="get"+_aaf.capitalInitial(a);return e[d]?e[d]():e.get(a)}else{return this[c]}},set:function(e,f){var b=getAccessors(this)[e];if(b){var g=b.target;var a=b.key;var c="set"+_aaf.capitalInitial(a);g[c]?g[c](f):g.set(a,f)}else{this.__checker__=this.__checker__||{};var d=this.__checker__[e];if(d&&(!d(f))){throw Error("Invalid value for property <"+(e+(">: "+f)))}if(this[e]!==f){this[e]=f;triggerChanged(this,e)}}},setValues:function(b){for(var c in b){var d=b[c];var a="set"+getAccessors(c);this[a]?this[a](d):this.set(c,d)}},changed:function(a){}};var myAnim=null;function startSlideMove(d,c,e){var i=[0,0];var j=c.toMapLonCoordinate(-c.deltaX+d[0]+c.width/2,-c.deltaY+d[1]+c.height/2);var b=c.toMapLatCoordinate(-c.deltaX+d[0]+c.width/2,-c.deltaY+d[1]+c.height/2);var g=i[0]-d[0];var f=i[1]-d[1];if(!myAnim){var m={callback:function(n,o){c.mapContainer.moveTo(-n[0],-n[1])}};myAnim=new animEffect(m)}else{MEvent.clearListeners(myAnim,"end");myAnim.stop()}MEvent.addListener(myAnim,"end",function(){c.setCenter(b,j);MEvent.clearListeners(myAnim,"end")});var k=800;var a=Math.sqrt(g*g+f*f)/k;a<0.2&&(a=0.2);a>0.5&&(a=0.5);if(e!=0){e=e||a}var l=easeOutCubic;myAnim.set("begins",i);myAnim.set("ends",d);myAnim.set("duration",e);myAnim.set("method",l);myAnim.set("fps",40);myAnim.start()}var isIE=false;var isIE6=false;var isFirefox=false;var isChrome=false;var isSafari=false;var isOpera=false;var s;var userAgent=navigator.userAgent.toLowerCase();if(s=userAgent.match(new RegExp("msie ([\\d.]+)"))){isIE=true;if(filter2Num(s[1],0)==6){isIE6=true}}else{if(s=userAgent.match(new RegExp("firefox/([\\d.]+)"))){isFirefox=true}else{if(s=userAgent.match(new RegExp("chrome/([\\d.]+)"))){isChrome=true}else{if(s=userAgent.match(new RegExp("opera.([\\d.]+)"))){isOpera=true}else{if(s=userAgent.match(new RegExp("version/([\\d.]+).*safari"))){isSafari=true}}}}}var isCss1Compat=document.compatMode=="CSS1Compat";var ut=document.qS?1:0;var lm=(isIE)?"document.all.":"document.";var yj=(isIE)?".style":"";if(isIE){document.write("<html xmlns:v='urn chemas-microsoft-com:vml'>");document.write("<style>v\\:* {behavior: url( #default#VML )}</style>")}document.write("<style type='text/css'> ");document.write(".ptlabel {  ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 8pt; ");document.write("}  ");document.write("");document.write(".tooltiptitle {");document.write("  color: #CC5522; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-weight: bold; ");document.write("  font-size: 10pt;");document.write("}  ");document.write("");document.write(".tooltipcontent { ");document.write("  color: #000000; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 8pt; ");document.write("}  ");document.write("");document.write(".hotspotlabel {");document.write("  position: absolute;");document.write("  color: #000; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 10pt;");document.write("}  ");document.write("");document.write(".editableimg { ");document.write("  position: absolute;");document.write("  overflow: hidden;  ");document.write("  cursor: pointer;");document.write("  border: 1px solid #fff;  ");document.write("  z-index: 1000;  ");if(isIE){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 0px; ");document.write("  display: block; ");document.write("}  ");document.write("");document.write(".buffering {");document.write("  position: absolute;");document.write("  height: 16px;");document.write("  z-index: 24; ");if(isIE){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 12px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 0px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 0px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write(".tiplabel { ");document.write("  position: absolute;");document.write("  height: 12px;");document.write("  z-index: 0; white-space: nowrap; ");document.write("  display: block; ");document.write("  background-color: #FFFFCC;  ");document.write("  border: 1px solid #f00;  ");document.write("  color: #f00; ");document.write("  font-size: 12px;");document.write("  font-weight: bold; ");document.write("}  ");document.write("");document.write("#ToolTip {  ");document.write("  position: absolute;");if(isIE){document.write("  filter: alpha( opacity = 80 );")}else{document.write("  opacity: 0.8;  ")}document.write("  width: 100px;");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  z-index: 24; ");document.write("  visibility: hidden;");document.write("}  ");document.write("");document.write("#loading {  ");document.write("  position: absolute;");document.write("  z-index: 24; ");if(isIE){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 13px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 0px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 4px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write("#mbglabel { ");document.write("  position: absolute;");document.write("  z-index: 0;  ");document.write("  white-space: nowrap;  ");document.write("  display: block; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mfglabel { ");document.write("  position: absolute;");document.write("  z-index: 0;  ");document.write("  white-space: nowrap;  ");document.write("  display: block; ");document.write("  visibility: visible;  ");document.write("  background-color: #FFFFCC;  ");document.write("}  ");document.write("");document.write("#stylelabel {  ");document.write("  position: absolute;");document.write("  z-index: 24; ");if(isIE){document.write("  filter: alpha( opacity = 80 );")}else{document.write("  opacity: 0.8;  ")}document.write("  font-size: 13px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 1px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 4px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewport {");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 10; ");document.write("  font-size: 0px; ");if(isIE){document.write("  filter: alpha( opacity = 50 );")}else{document.write("  opacity: 0.5;  ")}document.write("  background-color: white;  ");document.write("  border: 2px solid white;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewframe {  ");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 11; ");document.write("  font-size: 0px; ");document.write("  border: 2px solid #D50F1E;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewpad_ctrl { ");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 12; ");document.write("  font-size: 0px; ");document.write("  border: 2px solid #D50F1E;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-bordertop {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-top: 1px solid #949694; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderbtm {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-bottom: 1px solid #949694; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderlft {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-left: 1px solid #949694;");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderrgt {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-right: 1px solid #949694;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write(".contextmenuitem {");document.write("  color: #0E347F; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 9pt; ");document.write("  padding-right: 6px; ");document.write("  width: 100%; ");document.write("}  ");document.write("");document.write(".contextmenutable {  ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("}  ");document.write("");document.write(".mapcontextmenu { ");document.write("  position: absolute;");document.write("  background-color: #FFFFFF; ");document.write("  padding: 1px; ");document.write("  border: 1px outset #cccccc; ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  z-index: 24; ");document.write("  visibility: hidden;");document.write("}  ");document.write("");document.write(".mapCirEdging .borT, ");document.write("  .mapCirEdging .borB { ");document.write("  height: 1px; ");document.write("  margin: 0 1px;  ");document.write("  border-bottom: 1px solid #8F8F8F; ");document.write("  line-height: 1px;  ");document.write("  font-size: 1px; ");document.write("}  ");document.write("");document.write(".mapCirEdging .borB {");document.write("  border: 0;");document.write("  border-top: 1px solid #8F8F8F; ");document.write("}  ");document.write("");document.write(".mapCirEdging .borT2, .mapCirEdging .borB2 { ");document.write("  height: 1px; ");document.write("  border: 1px solid #BCBCBC;  ");document.write("  border-top: 0;  ");document.write("  border-bottom: 0;  ");document.write("  line-height: 1px;  ");document.write("  font-size: 1px; ");document.write("}  ");document.write("");document.write(".mapCirEdging .MPBox2 { ");document.write("  height: auto;");document.write("  border: 1px solid #8F8F8F;  ");document.write("  border-top: 0;  ");document.write("  border-bottom: 0;  ");document.write("  background: #fff;  ");document.write("}  ");document.write("");document.write(".mapCirEdging .MPbox {  ");document.write("  margin: 3px; ");document.write("  font-size: 12px;");document.write("  text-align: left;  ");document.write("}  ");document.write(".snapshotTextBtn {  ");document.write("  padding-top: 3px; ");document.write("  padding-bottom: 3px; ");document.write("  padding-left: 4px; ");document.write("  padding-right: 4px; ");document.write("  margin-left: 2px; ");document.write("  font-family: \u5b8b\u4f53; ");document.write("  font-size: 13px;");document.write("  text-align: center;  ");document.write("  font-weight: normal;  ");document.write("  letter-spacing: 1px;  ");document.write("  background: #0E347F;  ");document.write("  color: white;  ");document.write("}  ");document.write(".pointBox{position:absolute;z-index:100}");document.write(".pointBox .PMain{padding:0 10px;border: 2px solid rgb(14, 52, 127); background:#fff }");document.write(".pointBox .pointer{overflow:hidden;width:15px;height:14px;margin:-4px 0 0;background:url(images/pointBg.png) no-repeat;_background:none}");document.write(".pointBox .pointer img{display:none;_display:block;width:15px;height:14px;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=images/pointBg.png,sizingMethod=image,sizingMethod=scale)}");document.write(".pointBox .BoxBg{position:absolute;z-index:-1;width:100%;margin:auto 0 0 8px;padding-top:5px;background:#666;filter:alpha(opacity=60);opacity:0.6}");document.write(".rightThis .pointer{width:auto;margin:-4px 0 0;background-position:100% -16px!important;_background:none}");document.write(".rightThis .pointer img{_position:absolute;_right:0;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=images/pointBgR.png,sizingMethod=image,sizingMethod=scale)}");document.write(".rightThis .BoxBg{margin:auto 15px 0 0;left:-5px}");document.write("</style>");if(typeof mapliteUrl=="undefined"){var mapliteUrl=strImgsvrUrl}if(typeof mapName=="undefined"){var mapName="mapbar"}if(typeof en=="undefined"){var en=0}if(typeof rs=="undefined"){var rs=0}if(typeof apiType=="undefined"){var apiType=0}if(typeof hs=="undefined"){var hs=false}if(typeof MOUSEWHEEL=="undefined"){var MOUSEWHEEL=true}if(typeof kp=="undefined"){var kp=true}if(typeof bDefaultControlOn=="undefined"){var bDefaultControlOn=false}if(typeof hbo=="undefined"){var hbo=false}if(typeof otp=="undefined"){var otp=false}if(typeof ZOOM_TRANSITION=="undefined"){var ZOOM_TRANSITION=true}if(typeof bsc=="undefined"){var bsc=true}if(typeof __mapbar_magic_id=="undefined"){var __mapbar_magic_id=""}if(typeof REFRESH_MK_INDEX!="boolean"){var REFRESH_MK_INDEX=true}if(typeof SNAPSHOT_SERVER!="string"){var SNAPSHOT_SERVER="http://staticmap.mapbar.com/staticmap/"}if(typeof SNAPSHOT_MAPIMG_URI_PREFIX!="string"){var SNAPSHOT_MAPIMG_URI_PREFIX="http://img[1-9]?.mapbar.com/maplite/"}if(typeof SNAPSHOT_MARKER_URI_PREFIX!="string"){var SNAPSHOT_MARKER_URI_PREFIX="http://img[1-9]?.mapbar.com/maplite/mapbank/ditu/"}var SNAPSHOT_OPTIONS={mode:"fullscreen",format:"png",depth:0,processMode:"event"};if(typeof ALLOW_MV!="boolean"){var ALLOW_MV=true}if(typeof _dragmap!="string"){var _dragmap="_dragmap"}if(typeof _overlay!="string"){var _overlay="_overlay"}if(typeof disableMw!="string"){var disableMw="_disable_mw"}if(typeof $$0!="string"){var $$0="_mlayer"}var c75=2;var ac=null;var ad=true;if(typeof bp=="undefined"){var bp=true}if(typeof oo=="undefined"){var oo=true}if(typeof bmc=="undefined"){var bmc=false}if(typeof OVER_LOCATION!="object"||OVER_LOCATION){var OVER_LOCATION=null}if(typeof STD_BUBBLE_WIDTH=="undefined"){var STD_BUBBLE_WIDTH=217}if(typeof MIN_BUBBLE_HEIGHT=="undefined"){var MIN_BUBBLE_HEIGHT=120}if(typeof OVER_WIN_WIDTH!="number"){OVER_WIN_WIDTH=150}else{if(OVER_WIN_WIDTH<100){OVER_WIN_WIDTH=100}else{if(OVER_WIN_WIDTH>210){OVER_WIN_WIDTH=210}}}if(typeof OVER_WIN_HEIGHT!="number"){OVER_WIN_HEIGHT=120}else{if(OVER_WIN_HEIGHT<100){OVER_WIN_HEIGHT=100}else{if(OVER_WIN_HEIGHT>210){OVER_WIN_HEIGHT=210}}}if(typeof MAX_BUBBLE_HEIGHT=="undefined"){var MAX_BUBBLE_HEIGHT=380}var imgMaskUrl=strImgsvrUrl+"images/mask.gif";var ul=strImgsvrUrl+"images/node.gif";var lV=strImgsvrUrl+"images/wmk.gif";if(typeof LPN_HOVERING_TIME=="undefined"){var LPN_HOVERING_TIME=100}var eventTarget=null;if(typeof gQ=="undefined"){gQ=0}var xz="";var zoomLevel="";Array.prototype.clear=function(){while(this.length>0){this.pop()}};document.write('<img id="sendmapload" style="display:none;visibility:hidden;" />');document.writeln('<div id="myalert" style="position:absolute;z-index:100000;filter:alpha(opacity=85);opacity:0.85;visibility:hidden;background-color:white;padding:1px;"></div>');var sb=0;var sc='<div id="loading" unselectable = "on"><img src="'+strImgsvrUrl+'images/loading.gif"></div>';if(typeof bArrow=="undefined"){var bArrow=0}var sB=new Image();var initialize=0;var xN=(en==0)?new Array(getAscii("%u5415%uDD90%uE7F2%uD86E"),getAscii("%u5415%uA728%uB18A%uD86E"),getAscii("%u5415%uA22D%uAC8F%uD86E"),getAscii("%u5415%uA768%uB1CA%uD86E"),getAscii("%u6D4F%uFF1A%u1FAC%u0798"),getAscii("%u70BF%uC2B4%uE1D6%u1827%u0775%uE467"),getAscii("%u6540%uBE65"),getAscii("%u7F2B%uDB38"),getAscii("%u62D1%uB571%uC179%uC628%uE732%u1827%u0775%uE467")):new Array("Go left","Go up","Go right","Go down","Measure distance","Click to zoom","Zoom In","Zoom Out","Drag to zoom");var lt=(en==0)?"\u62d6\u62fd\u6b64\u70b9":"drag to move this point";var pe=new Array();var pa=new Array();var _zIndex=2;var levelFolder=new Array("W","0","1","2","3","4","5","6","7","8","9","10","11","12","13","16");var cutImgLonRange=new Array(90,40,20,10,5,2,1,0.5,0.2,0.1,0.05,0.02,0.01,0.005,0.002,0.001);var cutImgLatRange=new Array(90*0.8,40*0.8,20*0.8,10*0.8,5*0.8,2*0.8,0.8,0.5*0.8,0.2*0.8,0.1*0.8,0.05*0.8,0.02*0.8,0.01*0.8,0.005*0.8,0.002*0.8,0.001*0.8);var blockSize=new Array(10,10,10,10,10,10,10,10,10,10,50,50,50,50,50,50);var w8=new Array(0,0,0,0,0,0,0,0,75,0,0,-150,0,0,0,0);if(typeof DEFAULT_MAX_ZOOM_LEVEL!="number"){var DEFAULT_MAX_ZOOM_LEVEL=14}if(typeof DEFAULT_MIN_ZOOM_LEVEL!="number"){var DEFAULT_MIN_ZOOM_LEVEL=0}var maxZoomLevel=DEFAULT_MAX_ZOOM_LEVEL;var minZoomLevel=DEFAULT_MIN_ZOOM_LEVEL;var multiple=100000;var sw=105;var sx=35;var sz=new Array(-360,360);var sy=new Array(-90,90);var ooDragType=null;var uU=8;var uS=15;var overCloseImgUrl=strImgsvrUrl+"images/overclose.gif";var overOpenImgUrl=strImgsvrUrl+"images/overopen.gif";if(!otp){overCloseImgUrl=strImgsvrUrl+"images/overclose2.gif";overOpenImgUrl=strImgsvrUrl+"images/overopen2.gif"}var uW=[0,0,0,0,0,1,2,3,4,5,6,7,8,9,10];var bpp=[mapliteUrl+"mapbank/base/",12,13];var vs=strMapsvrUrl+"images/done.gif";var vt=strMapsvrUrl+"images/edit.gif";var v3=strMapsvrUrl+"images/stretch.gif";var at=0;var as=1;var au=2;var av=0;var ar=2;var s9=1001;if(typeof TRAFFIC_REFRESH_INTERVAL!="number"){var TRAFFIC_REFRESH_INTERVAL=5*60}if(typeof TRAFFIC_MIN_LEVEL!="number"){var TRAFFIC_MIN_LEVEL=8}if(typeof TRAFFIC_MAX_LEVEL!="number"){var TRAFFIC_MAX_LEVEL=maxZoomLevel}if(typeof BASEPOI_MIN_LEVEL!="number"){var BASEPOI_MIN_LEVEL=9}if(typeof BASEPOI_MAX_LEVEL!="number"){var BASEPOI_MAX_LEVEL=maxZoomLevel}if(typeof DISABLE_OLD_GOLDPOI!="boolean"){var DISABLE_OLD_GOLDPOI=false};
